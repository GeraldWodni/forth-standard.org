<!DOCTYPE html>
<html>
<head>
  <title>Forth 2012: Rationale</title>
  <meta name="viewport" content="width=device-width" />
  <link rel="stylesheet" type="text/css" href="forth.css" />
  <script type="text/javascript" src="forth.js"></script>
</head><body><div id="body">
<h1>Annex A: Rationale</h1> <!-- A. (informative annex)}}} -->
<a name="annex:rationale"></a>



<h2 id="section.A.1">A.1 Introduction</h2> <!-- A.1 -->
<h3 id="subsection.A.1.1">A.1.1 Purpose</h3> <!-- A.1.1 -->
<h3 id="subsection.A.1.2">A.1.2 Scope</h3> <!-- A.1.2 -->
<a name="rat:scope"></a>
<p />
When judging relative merits of proposed changes to the standard, the
members of the committee were guided by the following goals (listed
in alphabetic order):
<p />
<table>
<tr valign="top"><td>Consistency	</td><td style="width: 37.5em">The standard provides a functionally complete set of words with
minimal functional overlap.
</td></tr>
<tr valign="top"><td>Cost of compliance </td><td style="width: 37.5em">This goal includes such issues as common practice, how much
existing code would be broken by the proposed change, and the
amount of effort required to bring existing applications and
systems into conformity with the standard.
</td></tr>
<tr valign="top"><td>Efficiency </td><td style="width: 37.5em">Execution speed, memory compactness.
</td></tr>
<tr valign="top"><td>Portability	</td><td style="width: 37.5em">Words chosen for inclusion should be free of system-dependent
features.
</td></tr>
<tr valign="top"><td>Readability </td><td style="width: 37.5em">Forth definition names should clearly delineate their behavior.
That behavior should have an apparent simplicity which supports
rapid understanding. Forth should be easily taught and support
readily maintained code.
</td></tr>
<tr valign="top"><td>Utility	</td><td style="width: 37.5em">Be judged to have sufficiently essential functionality and
frequency of use to be deemed suitable for inclusion.
</table>
<p />
<h2 id="section.A.2">A.2 Terms and notation</h2> <!-- A.2 -->
<h3 id="subsection.A.2.1">A.2.1 Definitions of terms</h3> <!-- A.2.1 -->
<dl class="desc">
<dt>aligned</dt><dd> 
Data can only be loaded from and stored to addresses that are aligned
according to the alignment requirements of the accessed type.  Field
offsets that are added to structure addresses also need to be aligned.
<p />
</dd>
<dt>ambiguous condition</dt><dd>  
The response of a Standard System to an ambiguous condition is left
to the discretion of the implementor. A Standard System need not
explicitly detect or report the occurrence of ambiguous conditions.
<p />
</dd>
<dt>cross compiler</dt><dd>  
Cross compilers may be used to prepare a program for execution in an
embedded system, or may be used to generate Forth kernels either for
the same or a different run-time environment.
<p />
</dd>
<dt>data field</dt><dd>  
In earlier standards, data fields were known as &quot;parameter fields&quot;.
<p />
On subroutine threaded Forth systems, everything is object code.
There are no traditional code or data fields. Only a word defined by
<a href="core/CREATE.html">CREATE</a> or by a word that calls <a href="core/CREATE.html">CREATE</a> has a data field.
Only a data field defined via <a href="core/CREATE.html">CREATE</a> can be manipulated portably.
<p />
</dd>
<dt>word set</dt><dd>  
This standard recognizes that some functions, while useful in certain
application areas, are not sufficiently general to justify requiring
them in all Forth systems. Further, it is helpful to group Forth
words according to related functions. These issues are dealt with
using the concept of word sets.
<p />
The &quot;Core&quot; word set contains the essential body of words in a Forth
system. It is the only &quot;required&quot; word set. Other word sets defined
in this standard are optional additions to make it possible to
provide Standard Systems with tailored levels of functionality.
</dd></dl>
<br class="clear" />

<p />
<h3 id="subsection.A.2.2">A.2.2 Notation</h3> <!-- A.2.2 -->

<h4 id="subsubsection.A.2.2.2">A.2.2.2 Stack notation</h4> <!-- A.2.2.2 -->
The use of <em>-sys</em>, <em>orig</em>, and <em>dest</em> data types in
stack effect diagrams conveys two pieces of information. First, it
warns the reader that many implementations use the data stack in
unspecified ways for those purposes, so that items underneath on
either the control-flow or data stacks are unavailable. Second, in
cases where <em>orig</em> and <em>dest</em> are used, explicit pairing
rules are documented on the assumption that all systems will
implement that model so that its results are equivalent to employment
of some stack, and that in fact many implementations do use the data
stack for this purpose. However, nothing in this standard requires
that implementations actually employ the data stack (or any other)
for this purpose so long as the implied behavior of the model is
maintained.
<p />
<h2 id="section.A.3">A.3 Usage requirements</h2> <!-- A.3 -->
Forth systems are unusually simple to develop, in comparison with
compilers for more conventional languages such as C. In addition to
Forth systems supported by vendors, public-domain implementations and
implementation guides have been widely available for nearly twenty
years, and a large number of individuals have developed their own
Forth systems. As a result, a variety of implementation approaches
have developed, each optimized for a particular platform or target
market.
<p />
The committee has endeavored to accommodate this diversity by
constraining implementors as little as possible, consistent with a
goal of defining a standard interface between an underlying Forth
System and an application program being developed on it.
<p />
Similarly, we will not undertake in this section to tell you how to
implement a Forth System, but rather will provide some guidance as
to what the minimum requirements are for systems that can properly
claim compliance with this standard.
<p />
<h3 id="subsection.A.3.1">A.3.1 Data types</h3> <!-- A.3.1 -->
<a name="rat:types"></a>
<p />
Most computers deal with arbitrary bit patterns. There is no way to
determine by inspection whether a cell contains an address or an
unsigned integer. The only meaning a datum possesses is the meaning
assigned by an application.
<p />
When data are operated upon, the meaning of the result depends on
the meaning assigned to the input values. Some combinations of input
values produce meaningless results: for instance, what meaning can
be assigned to the arithmetic sum of the ASCII representation of the
character &quot;A&quot; and a TRUE flag? The answer may be &quot;no meaning&quot;;
or alternatively, that operation might be the first step in
producing a checksum. Context is the determiner.
<p />
The discipline of circumscribing meaning which a program may assign
to various combinations of bit patterns is sometimes called
<em>data typing</em>. Many computer languages impose explicit data
typing and have compilers that prevent ill-defined operations.
<p />
Forth rarely explicitly imposes data-type restrictions. Still, data
types implicitly do exist, and discipline is required, particularly
if portability of programs is a goal. In Forth, it is incumbent upon
the programmer (rather than the compiler) to determine that data are
accurately typed.
<p />
This section attempts to offer guidance regarding <em>de facto</em>
data typing in Forth.
<p />

<h4 id="subsubsection.A.3.1.2">A.3.1.2 Character types</h4> <!-- A.3.1.2 -->
The correct identification and proper manipulation of the character
data type is beyond the purview of Forth's enforcement of data type
by means of stack depth. Characters do not necessarily occupy the
entire width of their single stack entry with meaningful data. While
the distinction between signed and unsigned character is entirely
absent from the formal specification of Forth, the tendency in
practice is to treat characters as short positive integers when
mathematical operations come into play.
<p />
<ol style="list-style-type: lower-alpha">
<li> <strong>Standard Character Set</strong>
<p />
<ol style="list-style-type: decimal">
<li> The storage unit for the character data type
(<a href="core/CFetch.html">C@</a>, <a href="core/CStore.html">C!</a>, <a href="core/FILL.html">FILL</a>, etc.)
must be able to contain unsigned numbers from 0 through 255.
<p />
</li>
<li> An implementation is not required to restrict character
storage to that range, but a Standard Program without
environmental dependencies cannot assume the ability to
store numbers outside that range in a &quot;char&quot; location.
<p />
</li>
<li> The allowed number representations are two's-complement,
one's-complement, and signed-magnitude. Note that all of
these number systems agree on the representation of positive
numbers.
<p />
</li>
<li> Since a &quot;<em>char</em>&quot; can store small positive numbers
and since the character data type is a sub-range of the
unsigned integer data type, <a href="core/CStore.html">C!</a> must store the <em>n</em>
least-significant bits of a cell (<em>8 <= n <=</em> bits/cell).
Given the enumeration of allowed number representations and
their known encodings, &quot;<a href="core/TRUE.html">TRUE</a> <code>xx</code> <a href="core/CStore.html">C!</a>
<code>xx</code> <a href="core/CFetch.html">C@</a>&quot; must leave a stack item with some
number of bits set, which will thus will be accepted as
non-zero by <a href="core/IF.html">IF</a>.
<p />
</li>
<li> For the purposes of input (<a href="core/KEY.html">KEY</a>, <a href="core/ACCEPT.html">ACCEPT</a>, etc.)
and output (<a href="core/EMIT.html">EMIT</a>, <a href="core/TYPE.html">TYPE</a>, etc.), the encoding
between numbers and human-readable symbols is ISO646/IRV
(ASCII) within the range from 32 to 126 (space to ~).
EBCDIC is out (most &quot;EBCDIC&quot; computer systems support ASCII
too). Outside that range, it is up to the implementation. The
obvious implementation choice is to use ASCII control
characters for the range from 0 to 31, at least for the
&quot;displayable&quot; characters in that range (TAB, RETURN, LINEFEED,
FORMFEED). However, this is not as clear-cut as it may seem,
because of the variation between operating systems on the
treatment of those characters. For example, some systems TAB
to 4 character boundaries, others to 8 character boundaries,
and others to preset tab stops. Some systems perform an automatic
linefeed after a carriage return, others perform an automatic
carriage return after a linefeed, and others do neither.
<p />
The codes from 128 to 255 may eventually be standardized,
either formally or informally, for use as international
characters, such as the letters with diacritical marks found
in many European languages. One such encoding is the 8-bit
ISO Latin-1 character set. The computer marketplace at large
will eventually decide which encoding set of those characters
prevails. For Forth implementations running under an
operating system (the majority of those running on standard
platforms these days), most Forth implementors will probably
choose to do whatever the system does, without performing any
remapping within the domain of the Forth system itself.
<p />
</li>
<li> A Standard Program can depend on the ability to receive
any character in the range 32 ... 126 through <a href="core/KEY.html">KEY</a>,
and similarly to display the same set of characters with
<a href="core/EMIT.html">EMIT</a>. If a program must be able to receive or display
any particular character outside that range, it can declare
an environmental dependency on the ability to receive or
display that character.
<p />
</li>
<li> A Standard Program cannot use control characters in
definition names. However, a Standard System is not required
to enforce this prohibition. Thus, existing systems that
currently allow control characters in words names from
<a href="block/BLOCK.html">BLOCK</a> source may continue to allow them, and
programs running on those systems will continue to work. In
text file source, the parsing action with space as a
delimiter (e.g., <a href="core/BL.html">BL</a> <a href="core/WORD.html">WORD</a>) treats control
characters the same as spaces. This effectively implies that
you cannot use control characters in definition names from
text-file source, since the text interpreter will treat the
control characters as delimiters. Note that this
&quot;control-character folding&quot; applies only when space is the
delimiter, thus the phrase &quot;<a href="core/CHAR.html">CHAR</a> <code>)</code> <a href="core/WORD.html">WORD</a>&quot;
may collect a string containing control characters.
</li>
</ol>
<p />
</li>
<li> <strong>Storage and retrieval</strong>
<p />
Characters are transferred from the data stack to memory by
<a href="core/CStore.html">C!</a> and from memory to the data stack by <a href="core/CFetch.html">C@</a>. A
number of lower-significance bits equivalent to the
implementation-dependent width of a <em>character</em> are
transferred from a popped data stack entry to an address by the
action of <a href="core/CStore.html">C!</a> without affecting any bits which may comprise
the higher-significance portion of the cell at the destination
address; however, the action of <a href="core/CFetch.html">C@</a> clears all
higher-significance bits of the data stack entry which it pushes
that are beyond the implementation-dependent width of a character
(which may include implementation-defined display information in
the higher-significance bits). The programmer should keep in mind
that operating upon arbitrary stack entries with words intended
for the character data type may result in truncation of such data.
<p />
</li>
<li> <strong>Manipulation on the stack</strong>
<p />
In addition to <a href="core/CFetch.html">C@</a> and <a href="core/CStore.html">C!</a>, characters are moved to,
from and upon the data stack by the following words:
<div class="quote">
  <div class="tt">
<a href="core/toR.html">&gt;R</a>	<a href="core/qDUP.html">?DUP</a>	<a href="core/DROP.html">DROP</a>	<a href="core/DUP.html">DUP</a>
    <a href="core/OVER.html">OVER</a>	<a href="core/PICK.html">PICK</a>	<a href="core/Rfrom.html">R&gt;</a>	<a href="core/RFetch.html">R@</a>
    <a href="core/ROLL.html">ROLL</a>	<a href="core/ROT.html">ROT</a>	<a href="core/SWAP.html">SWAP</a>
    
    </div>
  </div>
<p />

</li>
<li> <strong>Additional operations</strong>
<p />
The following mathematical operators are valid for character data:
<p />
<div class="quote">
  <div class="tt">
<a href="core/Plus.html">+</a>	<a href="core/Minus.html">-</a>	<a href="core/Times.html">*</a>	<a href="core/Div.html">/</a>
    <a href="core/DivMOD.html">/MOD</a>	<a href="core/MOD.html">MOD</a>
    
    </div>
  </div>
<p />
The following comparison and bitwise operators may be valid for
characters, keeping in mind that display information cached in
the most significant bits of characters in an implementation-defined
fashion may have to be masked or otherwise dealt with:
<p />
<div class="quote">
  <div class="tt">
<a href="core/AND.html">AND</a>		<a href="core/OR.html">OR</a>		<a href="core/more.html">&gt;</a>	<a href="core/less.html">&lt;</a>
    <a href="core/Umore.html">U&gt;</a>	<a href="core/Uless.html">U&lt;</a>	<a href="core/Equal.html">=</a>	<a href="core/ne.html">&lt;&gt;</a>
    <a href="core/ZeroEqual.html">0=</a>		<a href="core/Zerone.html">0&lt;&gt;</a>		<a href="core/MAX.html">MAX</a>	<a href="core/MIN.html">MIN</a>
    <a href="core/LSHIFT.html">LSHIFT</a>	<a href="core/RSHIFT.html">RSHIFT</a>
    
    </div>
  </div>
</li>
</ol>
<p />
<h4 id="subsubsection.A.3.1.3">A.3.1.3 Single-cell types</h4> <!-- A.3.1.3 -->
A single-cell stack entry viewed without regard to typing is the
fundamental data type of Forth. All other data types are actually
represented by one or more single-cell stack entries.
<p />
<ol style="list-style-type: lower-alpha">
<li> <strong>Storage and retrieval</strong>
<p />
Single-cell data are transferred from the stack to memory by
<a href="core/Store.html">!</a>; from memory to the stack by <a href="core/Fetch.html">@</a>. All bits are
transferred in both directions and no type checking of any sort
is performed, nor does the Standard System check that a memory
address used by <a href="core/Store.html">!</a> or <a href="core/Fetch.html">@</a> is properly aligned or
properly sized to hold the datum thus transferred.
<p />
</li>
<li> <strong>Manipulation on the stack</strong>
<p />
Here is a selection of the most important words which move
single-cell data to, from and upon the data stack:
<p />
<div class="quote">
  <div class="tt">
<a href="core/Store.html">!</a>	<a href="core/Fetch.html">@</a>	<a href="core/toR.html">&gt;R</a>	<a href="core/qDUP.html">?DUP</a>
    <a href="core/DROP.html">DROP</a>	<a href="core/DUP.html">DUP</a>	<a href="core/OVER.html">OVER</a>	<a href="core/PICK.html">PICK</a>
    <a href="core/Rfrom.html">R&gt;</a>	<a href="core/RFetch.html">R@</a>	<a href="core/ROLL.html">ROLL</a>	<a href="core/ROT.html">ROT</a>
    <a href="core/SWAP.html">SWAP</a>
    
    </div>
  </div>
<p />
</li>
<li> <strong>Comparison operators</strong>
<p />
The following comparison operators are universally valid for one
or more single cells:
<p />
<div class="quote">
  <div class="tt">
<a href="core/Equal.html">=</a>	<a href="core/ne.html">&lt;&gt;</a>	<a href="core/ZeroEqual.html">0=</a>	<a href="core/Zerone.html">0&lt;&gt;</a>
    
    </div>
  </div>
</li>
</ol>
<p />
<h5 id="paragraph.A.3.1.3.1">A.3.1.3.1 Flags</h5>   <!-- A.3.1.3.1 -->
A <a href="core/FALSE.html">FALSE</a> flag is a single-cell datum with all bits unset, and
a <a href="core/TRUE.html">TRUE</a> flag is a single-cell datum with all bits set. While
Forth words which test flags accept any non-null bit pattern as true,
there exists the concept of the <em>well-formed flag</em>. If an
operation whose result is to be used as a flag may produce any
bit-mask other than <a href="core/TRUE.html">TRUE</a> or <a href="core/FALSE.html">FALSE</a>, the recommended
discipline is to convert the result to a well-formed flag by means
of the Forth word <a href="core/Zerone.html">0&lt;&gt;</a> so that the result of any subsequent
logical operations on the flag will be predictable.
<p />
In addition to the words which move, fetch and store single-cell
items, the following words are valid for operations on one or more
flag data residing on the data stack:
<p />
<div class="quote">
  <div class="tt">
<a href="core/AND.html">AND</a>	<a href="core/OR.html">OR</a>	<a href="core/XOR.html">XOR</a>	<a href="core/INVERT.html">INVERT</a>
    
    </div>
  </div>
<p />
<h5 id="paragraph.A.3.1.3.2">A.3.1.3.2 Integers</h5>   <!-- A.3.1.3.2 -->
A single-cell datum may be treated by a Standard Program as a signed
integer. Moving and storing such data is performed as for any
single-cell data. In addition to the universally-applicable operators
for single-cell data specified above, the following mathematical and
comparison operators are valid for single-cell signed integers:
<p />
<div class="quote">
  <div class="tt">
<a href="core/Times.html">*</a>	<a href="core/TimesDiv.html">*/</a>	<a href="core/TimesDivMOD.html">*/MOD</a>	<a href="core/DivMOD.html">/MOD</a>
    <a href="core/MOD.html">MOD</a>	<a href="core/Plus.html">+</a>	<a href="core/PlusStore.html">+!</a>		<a href="core/Minus.html">-</a>
    <a href="core/Div.html">/</a>	<a href="core/OnePlus.html">1+</a>	<a href="core/OneMinus.html">1-</a>		<a href="core/ABS.html">ABS</a>
    <a href="core/MAX.html">MAX</a>	<a href="core/MIN.html">MIN</a>	<a href="core/NEGATE.html">NEGATE</a>	<a href="core/Zeroless.html">0&lt;</a>
    <a href="core/Zeromore.html">0&gt;</a>	<a href="core/less.html">&lt;</a>	<a href="core/more.html">&gt;</a>
    
    </div>
  </div>
<p />
Given the same number of bits, unsigned integers usually represent
twice the number of absolute values representable by signed integers.
<p />
A single-cell datum may be treated by a Standard Program as an
unsigned integer. Moving and storing such data is performed as for
any single-cell data. In addition, the following mathematical and
comparison operators are valid for single-cell unsigned integers:
<p />
<div class="quote">
  <div class="tt">
<a href="core/UMTimes.html">UM*</a>	<a href="core/UMDivMOD.html">UM/MOD</a>	<a href="core/Plus.html">+</a>	<a href="core/PlusStore.html">+!</a>
    <a href="core/Minus.html">-</a>	<a href="core/OnePlus.html">1+</a>		<a href="core/OneMinus.html">1-</a>	<a href="core/Times.html">*</a>
    <a href="core/Uless.html">U&lt;</a>	<a href="core/Umore.html">U&gt;</a>
    
    </div>
  </div>
<p />
<h5 id="paragraph.A.3.1.3.3">A.3.1.3.3 Addresses</h5>   <!-- A.3.1.3.3 -->
An address is uniquely represented as a single cell unsigned number
and can be treated as such when being moved to, from, or upon the
stack. Conversely, each unsigned number represents a unique address
(which is not necessarily an address of accessible memory). This
one-to-one relationship between addresses and unsigned numbers forces
an equivalence between address arithmetic and the corresponding
operations on unsigned numbers.
<p />
Several operators are provided specifically for address arithmetic:
<p />
<div class="quote">
  <div class="tt">
<a href="core/CHARPlus.html">CHAR+</a>	<a href="core/CHARS.html">CHARS</a>
    <a href="core/CELLPlus.html">CELL+</a>	<a href="core/CELLS.html">CELLS</a>
    
    </div>
  </div>
<p />
and, if the floating-point word set is present:
<p />
<div class="quote">
  <div class="tt">
<a href="floating/FLOATPlus.html">FLOAT+</a>		<a href="floating/FLOATS.html">FLOATS</a>
    <a href="floating/SFLOATPlus.html">SFLOAT+</a>	<a href="floating/SFLOATS.html">SFLOATS</a>
    <a href="floating/DFLOATPlus.html">DFLOAT+</a>	<a href="floating/DFLOATS.html">DFLOATS</a>
    
    </div>
  </div>
<p />
A Standard Program may never assume a particular correspondence
between a Forth address and the physical address to which it is
mapped.
<p />
<h5 id="paragraph.A.3.1.3.4">A.3.1.3.4 Counted strings</h5>   <!-- A.3.1.3.4 -->
<a name="rat:cstring"></a>
<p />
Forth 94 moved toward the consistent use of the &quot;<em>c-addr u</em>&quot;
representation of strings on the stack. The use of the alternate
&quot;address of counted string&quot; stack representation is discouraged.
The traditional Forth words <a href="core/WORD.html">WORD</a> and <a href="core/FIND.html">FIND</a> continue
to use the &quot;address of counted string&quot; representation for historical
reasons. The new word <a href="core/Cq.html">C&quot;</a>, added as a porting aid for existing
programs, also uses the counted string representation.
<p />
Counted strings remain useful as a way to store strings in memory.
This use is not discouraged, but when references to such strings
appear on the stack, it is preferable to use the &quot;<em>c-addr u</em>&quot;
representation.
<p />
<h5 id="paragraph.A.3.1.3.5">A.3.1.3.5 Execution tokens</h5>   <!-- A.3.1.3.5 -->
The association between an execution token and a definition is static.
Once made, it does not change with changes in the search order or
anything else. However it may not be unique, e.g., the phrases
<p />
<div class="quote">
  <div class="tt">
<a href="core/Tick.html">'</a> <a href="core/OnePlus.html">1+</a> and <br />
    <a href="core/Tick.html">'</a> <a href="core/CHARPlus.html">CHAR+</a>
    
    </div>
  </div>
<p />
might return the same value.
<p />
<h5 id="paragraph.A.3.1.3.6">A.3.1.3.6 Error results</h5>   <!-- A.3.1.3.6 -->
<a name="rat:ior"></a>
<p />
The term <em>ior</em> was originally defined to describe the result of
an input/output operation.  This was extended to include other
operations.
<p />
<h4 id="subsubsection.A.3.1.4">A.3.1.4 Cell-pair types</h4> <!-- A.3.1.4 -->
<ol style="list-style-type: lower-alpha">
<li> <strong>Storage and retrieval</strong>
<p />
Two operators are provided to fetch and store cell pairs:
<p />
<div class="quote">
  <div class="tt">
<a href="core/TwoFetch.html">2@</a>	<a href="core/TwoStore.html">2!</a>
    
    </div>
  </div>
<p />
</li>
<li> <strong>Manipulation on the stack</strong>
<p />
Additionally, these operators may be used to move cell pairs
from, to and upon the stack:
<p />
<div class="quote">
  <div class="tt">
<a href="core/TwotoR.html">2&gt;R</a>	<a href="core/TwoDROP.html">2DROP</a>	<a href="core/TwoDUP.html">2DUP</a>	<a href="core/TwoOVER.html">2OVER</a>
    <a href="core/TwoRfrom.html">2R&gt;</a>	<a href="core/TwoSWAP.html">2SWAP</a>	<a href="double/TwoROT.html">2ROT</a>
    
    </div>
  </div>
<p />
</li>
<li> <strong>Comparison</strong>
<p />
The following comparison operations are universally valid for
cell pairs:
<p />
<div class="quote">
  <div class="tt">
<a href="double/DEqual.html">D=</a>	<a href="double/DZeroEqual.html">D0=</a>
    
    </div>
  </div>
</li>
</ol>
<p />
<h5 id="paragraph.A.3.1.4.1">A.3.1.4.1 Double-Cell Integers</h5>   <!-- A.3.1.4.1 -->
If a double-cell integer is to be treated as signed, the following
comparison and mathematical operations are valid:
<p />
<div class="quote">
  <div class="tt">
<a href="double/DPlus.html">D+</a>		<a href="double/DMinus.html">D-</a>		<a href="double/Dless.html">D&lt;</a>
    <a href="double/DZeroless.html">D0&lt;</a>	<a href="double/DABS.html">DABS</a>		<a href="double/DMAX.html">DMAX</a>
    <a href="double/DMIN.html">DMIN</a>		<a href="double/DNEGATE.html">DNEGATE</a>
    <a href="double/MTimesDiv.html">M*/</a>		<a href="double/MPlus.html">M+</a>
    
    </div>
  </div>
<p />
If a double-cell integer is to be treated as unsigned, the following
comparison and mathematical operations are valid:
<p />
<div class="quote">
  <div class="tt">
<a href="double/DPlus.html">D+</a>	<a href="double/DMinus.html">D-</a>
    <a href="core/UMDivMOD.html">UM/MOD</a>		<a href="double/DUless.html">DU&lt;</a>
    
    </div>
  </div>
<p />
<h5 id="paragraph.A.3.1.4.2">A.3.1.4.2 Character strings</h5>   <!-- A.3.1.4.2 -->
See: <strong><a href="rationale.html#rat:cstring">A.3.1.3.4 Counted strings</a></strong>.
<p />
<h3 id="subsection.A.3.2">A.3.2 The Implementation environment</h3> <!-- A.3.2 -->
<h4 id="subsubsection.A.3.2.1">A.3.2.1 Numbers</h4> <!-- A.3.2.1 -->
Traditionally, Forth has been implemented on two's-complement machines
where there is a one-to-one mapping of signed numbers to unsigned
numbers &mdash; any single cell item can be viewed either as a signed or
unsigned number. Indeed, the signed representation of any positive
number is identical to the equivalent unsigned representation. Further,
addresses are treated as unsigned numbers: there is no distinct pointer
type. Arithmetic ordering on two's complement machines allows <a href="core/Plus.html">+</a>
and <a href="core/Minus.html">-</a> to work on both signed and unsigned numbers. This
arithmetic behavior is deeply embedded in common Forth practice.
<p />
As a consequence of these behaviors, the likely ranges of signed and
unsigned numbers for implementations hosted on each of the permissible
arithmetic architectures is:
<p />
<div class="center">

  <table class="center">
  <tr valign="top"><td colspan="8"><hr /></td></tr>
  <tr valign="top"><td class="c"><strong>Arithmetic architecture</strong>
  </td><td colspan="2" class="c"><strong>signed numbers</strong>
  </td><td colspan="3" class="c"><strong>unsigned numbers</strong> </td></tr>
  <tr valign="top"><td colspan="8"><hr /></td></tr>
  <tr valign="top"><td class="c">Two's complement	</td><td class="r"><em>-n-1</em> </td><td> to </td><td><em>n</em>		</td><td></td><td class="r"><em>0</em> </td><td> to </td><td><em>2n+1</em>	</td></tr>
  <tr valign="top"><td class="c">One's complement	</td><td class="r"><em>-n</em> </td><td> to </td><td><em>n</em>		</td><td></td><td class="r"><em>0</em> </td><td> to </td><td><em>n</em>		</td></tr>
  <tr valign="top"><td class="c">Signed magnitude	</td><td class="r"><em>-n</em> </td><td> to </td><td><em>n</em>		</td><td></td><td class="r"><em>0</em> </td><td> to </td><td><em>n</em>		</td></tr>
  <tr valign="top"><td colspan="8"><hr /></td></tr>
  <tr valign="top"><td class="c"></td></tr>
  </table>
  
  </div>
<p />
where <em>n</em> is the largest positive signed number. For all three
architectures, signed numbers in the <em>0</em> to <em>n</em> range are bitwise
identical to the corresponding unsigned number. Note that unsigned
numbers on a signed magnitude machine are equivalent to signed
non-negative numbers as a consequence of the forced correspondence
between addresses and unsigned numbers and of the required behavior
of <a href="core/Plus.html">+</a> and <a href="core/Minus.html">-</a>.
<p />
For reference, these number representations may be defined by the
way that <a href="core/NEGATE.html">NEGATE</a> is implemented:
<p />
<div class="quote">

  <table>
  <tr valign="top"><td>two's complement: </td><td><a href="core/Colon.html">:</a> <a href="core/NEGATE.html">NEGATE</a> <a href="core/INVERT.html">INVERT</a> <a href="core/OnePlus.html">1+</a> <a href="core/Semi.html">;</a> </td></tr>
  <tr valign="top"><td>one's complement: </td><td><a href="core/Colon.html">:</a> <a href="core/NEGATE.html">NEGATE</a> <a href="core/INVERT.html">INVERT</a> <a href="core/Semi.html">;</a> </td></tr>
  <tr valign="top"><td>signed-magnitude: </td><td><a href="core/Colon.html">:</a> <a href="core/NEGATE.html">NEGATE</a> <code>HIGH-BIT</code> <a href="core/XOR.html">XOR</a> <a href="core/Semi.html">;</a>
  </table>
  
  </div>
<p />
where <code>HIGH-BIT</code> is a bit mask with only the most-significant
bit set. Note that all of these number systems agree on the
representation of non-negative numbers.
<p />
Per <strong><a href="usage.html#usage:number">3.2.1.1 Internal number representation</a></strong> and
<a href="core/ZeroEqual.html">6.1.0270 0=</a>, the implementor must ensure that no standard or
supported word return negative zero for any numeric (non-Boolean or
flag) result. Many existing programmer assumptions will be violated
otherwise.
<p />
There is no requirement to implement circular unsigned arithmetic,
nor to set the range of unsigned numbers to the full size of a cell.
There is historical precedent for limiting the range of <em>u</em> to
that of <em>+n</em>, which is permissible when the cell size is greater
than 16 bits.
<p />

<h5 id="paragraph.A.3.2.1.2">A.3.2.1.2 Digit conversion</h5>   <!-- A.3.2.1.2 -->
For example, an implementation might convert the characters &quot;a&quot;
through &quot;z&quot; identically to the characters &quot;A&quot; through &quot;Z&quot;, or
it might treat the characters &quot; [ &quot; through &quot; &quot; as additional
digits with decimal values 36 through 71, respectively.
<p />
<h4 id="subsubsection.A.3.2.2">A.3.2.2 Arithmetic</h4> <!-- A.3.2.2 -->
<h5 id="paragraph.A.3.2.2.1">A.3.2.2.1 Integer division</h5>   <!-- A.3.2.2.1 -->
The Forth-79 Standard specifies that the signed division operators
(<a href="core/Div.html">/</a>, <a href="core/DivMOD.html">/MOD</a>, <a href="core/MOD.html">MOD</a>, <a href="core/TimesDivMOD.html">*/MOD</a>, and <a href="core/TimesDiv.html">*/</a>)
round non-integer quotients towards zero (symmetric division).
Forth 83 changed the semantics of these operators to round towards
negative infinity (floored division). Some in the Forth community
have declined to convert systems and applications from the Forth-79
to the Forth-83 divide.  To resolve this issue, a Forth-2012 system
is permitted to supply either floored or symmetric operators. In
addition, a standard system must provide a floored division primitive
(<a href="core/FMDivMOD.html">FM/MOD</a>), a symmetric division primitive (<a href="core/SMDivREM.html">SM/REM</a>), and
a mixed precision multiplication operator (<a href="core/MTimes.html">M*</a>).
<p />
This compromise protects the investment made in current Forth
applications; Forth-79 and Forth-83 programs are automatically
compliant with Forth 94 with respect to division. In practice, the
rounding direction rarely matters to applications. However, if a
program requires a specific rounding direction, it can use the
floored division primitive <a href="core/FMDivMOD.html">FM/MOD</a> or the symmetric division
primitive <a href="core/SMDivREM.html">SM/REM</a> to construct a division operator of the
desired flavor. This simple technique can be used to convert Forth-79
and Forth-83 programs to Forth 94 without any analysis of the
original programs.
<p />
<h5 id="paragraph.A.3.2.2.2">A.3.2.2.2 Other integer operations</h5>   <!-- A.3.2.2.2 -->
Whether underflow occurs depends on the data-type of the result. For
example, the phrase <code>1 2</code> <a href="core/Minus.html">-</a> underflows if the result is
unsigned and produces the valid signed result -1.
<p />
<h4 id="subsubsection.A.3.2.3">A.3.2.3 Stacks</h4> <!-- A.3.2.3 -->
The only data type in Forth which has concrete rather than abstract
existence is the stack entry. Even this primitive typing Forth only
enforces by the hard reality of stack underflow or overflow. The
programmer must have a clear idea of the number of stack entries to
be consumed by the execution of a word and the number of entries that
will be pushed back to a stack by the execution of a word. The
observation of anomalous occurrences on the data stack is the first
line of defense whereby the programmer may recognize errors in an
application program. It is also worth remembering that multiple stack
errors caused by erroneous application code are frequently of equal
and opposite magnitude, causing complementary (and deceptive) results.
<p />
For these reasons and a host of other reasons, the one unambiguous,
uncontroversial, and indispensable programming discipline observed
since the earliest days of Forth is that of providing a stack diagram
for all additions to the application dictionary with the exception of
static constructs such as <a href="core/VARIABLE.html">VARIABLE</a>s and <a href="core/CONSTANT.html">CONSTANT</a>s.
<p />

<h5 id="paragraph.A.3.2.3.2">A.3.2.3.2 Control-flow stack</h5> <!-- A.3.2.3.2 -->
The simplest use of control-flow words is to implement the basic
control structures shown in figure <strong><a href="rationale.html#fig:basic">A.1</a></strong>.
<p />

<div class="center">

  <div class="fbox">
    <img width="100%" src="basic.png" />
    </div>
  <div class="caption">Figure A.1: The basic control-flow patterns</div>
  <a name="fig:basic"></a>
  
  </div>
<p />
<p />
In control flow every branch, or transfer of control, must terminate
at some destination. A natural implementation uses a stack to
remember the origin of forward branches and the destination of
backward branches. At a minimum, only the location of each origin or
destination must be indicated, although other implementation-dependent
information also may be maintained.
<p />
An origin is the location of the branch itself. A destination is
where control would continue if the branch were taken. A destination
is needed to resolve the branch address for each origin, and conversely,
if every control-flow path is completed no unused destinations can
remain.
<p />
With the addition of just three words (<a href="tools/AHEAD.html">AHEAD</a>,
<a href="tools/CS-ROLL.html">CS-ROLL</a> and <a href="tools/CS-PICK.html">CS-PICK</a>), the basic control-flow
words supply the primitives necessary to compile a variety of transportable
control structures. The abilities required are compilation of forward
and backward conditional and unconditional branches and compile-time
management of branch origins and destinations.
Table <strong><a href="rationale.html#table:control">A.1</a></strong> shows the desired behavior.
<p />

<div class="center">

  <div class="caption">Table A.1: Compilation behavior of control-flow words</div>
  <a name="table:control"></a>
  <table class="center">
  <tr valign="top"><td colspan="4"><hr /></td></tr>
  <tr valign="top"><td colspan="4">at compile-time, </td></tr>
  <tr valign="top"><td>word: </td><td class="c">supplies: </td><td class="c">resolves: </td><td>is used to: </td></tr>
  <tr valign="top"><td colspan="4"><hr /></td></tr>
  <tr valign="top"><td><a href="core/IF.html">IF</a>				</td><td class="c"><em>orig</em>	</td><td class="c"></td><td>mark origin of forward conditional branch </td></tr>
  <tr valign="top"><td><a href="core/THEN.html">THEN</a>			</td><td class="c"></td><td class="c"><em>orig</em>	</td><td>resolve <a href="core/IF.html">IF</a> or <a href="tools/AHEAD.html">AHEAD</a> </td></tr>
  <tr valign="top"><td><a href="core/BEGIN.html">BEGIN</a>			</td><td class="c"><em>dest</em>	</td><td class="c"></td><td>mark backward destination </td></tr>
  <tr valign="top"><td><a href="core/AGAIN.html">AGAIN</a>			</td><td class="c"></td><td class="c"><em>dest</em>	</td><td>resolve with backward unconditional branch </td></tr>
  <tr valign="top"><td><a href="core/UNTIL.html">UNTIL</a>			</td><td class="c"></td><td class="c"><em>dest</em>	</td><td>resolve with backward conditional branch </td></tr>
  <tr valign="top"><td><a href="tools/AHEAD.html">AHEAD</a>		</td><td class="c"><em>orig</em>	</td><td class="c"></td><td>mark origin of forward unconditional branch </td></tr>
  <tr valign="top"><td><a href="tools/CS-PICK.html">CS-PICK</a>	</td><td class="c"></td><td class="c"></td><td>copy item on control-flow stack </td></tr>
  <tr valign="top"><td><a href="tools/CS-ROLL.html">CS-ROLL</a>	</td><td class="c"></td><td class="c"></td><td>reorder items on control-flow stack </td></tr>
  <tr valign="top"><td colspan="4"><hr /></td></tr>
  <tr valign="top"><td></td></tr>
  </table>
  
  </div>
The requirement that control-flow words are properly balanced by other
control-flow words makes reasonable the description of a compile-time
implementation-defined <em>control-flow stack</em>. There is no
prescription as to how the control-flow stack is implemented, e.g.,
data stack, linked list, special array. Each element of the
control-flow stack mentioned above is the same size.
<p />
With these tools, the remaining basic control-structure elements,
shown in figure <strong><a href="rationale.html#fig:additional">A.2</a></strong>, can be defined. The
stack notation used here for immediate words is ( <em>compilation
/ execution</em> ).
<p />
<div class="quote">
  <div class="tt">
<div class="tabbing">
       <a href="core/Colon.html">:</a> <a href="core/WHILE.html">WHILE</a>  <a href="core/p.html">(</a> dest -- orig dest / flag -- ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/bs.html">\</a> conditional exit from loops <br />
      &nbsp;&nbsp;&nbsp;<a href="core/POSTPONE.html">POSTPONE</a> <a href="core/IF.html">IF</a>		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> conditional forward brach <br />
      &nbsp;&nbsp;&nbsp;	1 <a href="tools/CS-ROLL.html">CS-ROLL</a>			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> keep dest on top <br />
      <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a> <br /><br /><br /><br />
      	<a href="core/Colon.html">:</a> <a href="core/REPEAT.html">REPEAT</a>  <a href="core/p.html">(</a> orig dest -- / -- ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/bs.html">\</a> resolve a single WHILE and return to BEGIN <br />
      &nbsp;&nbsp;&nbsp;<a href="core/POSTPONE.html">POSTPONE</a> <a href="core/AGAIN.html">AGAIN</a>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> uncond. backward branch to dest <br />
      &nbsp;&nbsp;&nbsp;	<a href="core/POSTPONE.html">POSTPONE</a> <a href="core/THEN.html">THEN</a>		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> resolve forward branch from orig <br />
      <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a> <br /><br /><br /><br />
       <a href="core/Colon.html">:</a> <a href="core/ELSE.html">ELSE</a>  <a href="core/p.html">(</a> orig1 -- orig2 / -- ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/bs.html">\</a> resolve IF supplying alternate execution <br />
      &nbsp;&nbsp;&nbsp;<a href="core/POSTPONE.html">POSTPONE</a> <a href="tools/AHEAD.html">AHEAD</a>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> unconditional forward branch orig2 <br />
      &nbsp;&nbsp;&nbsp;1 <a href="tools/CS-ROLL.html">CS-ROLL</a>				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> put orig1 back on top <br />
      &nbsp;&nbsp;&nbsp;	<a href="core/POSTPONE.html">POSTPONE</a> <a href="core/THEN.html">THEN</a>			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> resolve forward branch from orig1 <br />
      <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>
      <br />
      
      </div>
    
    </div>
  </div>
<p />

<div class="center">

  <div class="fbox">
    <img width="100%" src="additional.png" />
    </div>
  <div class="caption">Figure A.2: Additional basic control-flow patterns</div>
  <a name="fig:additional"></a>
  
  </div>
<p />
<p />
Forth control flow provides a solution for well-known problems with
strictly structured programming.
<p />
The basic control structures can be supplemented, as shown in the
examples in figure <strong><a href="rationale.html#fig:extended">A.3</a></strong>, with additional
<a href="core/WHILE.html">WHILE</a>s in <a href="core/BEGIN.html">BEGIN</a> ... <a href="core/UNTIL.html">UNTIL</a> and <a href="core/BEGIN.html">BEGIN</a>
... <a href="core/WHILE.html">WHILE</a> ... <a href="core/REPEAT.html">REPEAT</a> structures. However, for
each additional <a href="core/WHILE.html">WHILE</a> there must be a <a href="core/THEN.html">THEN</a> at the end
of the structure. <a href="core/THEN.html">THEN</a> completes the syntax with <a href="core/WHILE.html">WHILE</a>
and indicates where to continue execution when the <a href="core/WHILE.html">WHILE</a>
transfers control. The use of more than one additional <a href="core/WHILE.html">WHILE</a>
is possible but not common. Note that if the user finds this use of
<a href="core/THEN.html">THEN</a> undesirable, an alias with a more likable name could be
defined.
<p />
Additional actions may be performed between the control flow word (the
<a href="core/REPEAT.html">REPEAT</a> or <a href="core/UNTIL.html">UNTIL</a>) and the <a href="core/THEN.html">THEN</a> that matches the
additional <a href="core/WHILE.html">WHILE</a>. Further, if additional actions are desired
for normal termination and early termination, the alternative actions
may be separated by the ordinary Forth <a href="core/ELSE.html">ELSE</a>. The termination
actions are all specified after the body of the loop.
<p />

<div class="center">

  <div class="fbox">
    <img width="100%" src="extended.png" />
    </div>
  <div class="caption">Figure A.3: Extended control-flow patterns</div>
  <a name="fig:extended"></a>
  
  </div>
<p />
<p />
Note that <a href="core/REPEAT.html">REPEAT</a> creates an anomaly when matching the
<a href="core/WHILE.html">WHILE</a> with <a href="core/ELSE.html">ELSE</a> or <a href="core/THEN.html">THEN</a>, most notably when
compared with the <a href="core/BEGIN.html">BEGIN</a>...<a href="core/UNTIL.html">UNTIL</a> case. That is,
there will be one less <a href="core/ELSE.html">ELSE</a> or <a href="core/THEN.html">THEN</a> than there are
<code>WHILE</code>s because <a href="core/REPEAT.html">REPEAT</a> resolves one <a href="core/THEN.html">THEN</a>. As
above, if the user finds this count mismatch undesirable, <a href="core/REPEAT.html">REPEAT</a>
could be replaced in-line by its own definition.
<p />
Other loop-exit control-flow words, and even other loops, can be
defined. The only requirements are that the control-flow stack is
properly maintained and manipulated.
<p />
The simple implementation of the <a href="core/CASE.html">CASE</a> structure
below is an example of control structure extension. Note the
maintenance of the data stack to prevent interference with the
possible control-flow stack usage.
<p />
<div class="quote">
  <div class="tt">
<div class="tabbing">
      0 <a href="core/CONSTANT.html">CONSTANT</a> <a href="core/CASE.html">CASE</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>  <a href="core/p.html">(</a> init count of OFs ) <br /><br /><br /><br />
       <a href="core/Colon.html">:</a> <a href="core/OF.html">OF</a>  <a href="core/p.html">(</a> #of -- orig #of+1 / x -- ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/OnePlus.html">1+</a>					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> count OFs ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/toR.html">&gt;R</a>					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> move off the stack in case the control-flow ) <br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> stack is the data stack. ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/POSTPONE.html">POSTPONE</a> <a href="core/OVER.html">OVER</a>  <a href="core/POSTPONE.html">POSTPONE</a> <a href="core/Equal.html">=</a> 
      <a href="core/p.html">(</a> copy and test case value) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/POSTPONE.html">POSTPONE</a> <a href="core/IF.html">IF</a>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> add orig to control flow stack ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/POSTPONE.html">POSTPONE</a> <a href="core/DROP.html">DROP</a>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> discards case value if = ) <br />
      &nbsp;&nbsp;&nbsp;	<a href="core/Rfrom.html">R&gt;</a>				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> we can bring count back now ) <br />
      <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a> <br /><br /><br /><br />
       <a href="core/Colon.html">:</a> <a href="core/ENDOF.html">ENDOF</a>  <a href="core/p.html">(</a> orig1 #of -- orig2 #of ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/toR.html">&gt;R</a>					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> move off the stack in case the control-flow ) <br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> stack is the data stack. ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/POSTPONE.html">POSTPONE</a> <a href="core/ELSE.html">ELSE</a> <br />
      &nbsp;&nbsp;&nbsp;	<a href="core/Rfrom.html">R&gt;</a>				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> we can bring count back now ) <br />
      <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a> <br /><br /><br /><br />
       <a href="core/Colon.html">:</a> <a href="core/ENDCASE.html">ENDCASE</a>  <a href="core/p.html">(</a> orig1..orign #of -- ) <br />
      &nbsp;&nbsp;&nbsp;<a href="core/POSTPONE.html">POSTPONE</a> <a href="core/DROP.html">DROP</a>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> discard case value ) <br />
      &nbsp;&nbsp;&nbsp;0 <a href="core/qDO.html">?DO</a> <br />
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/POSTPONE.html">POSTPONE</a> <a href="core/THEN.html">THEN</a> <br />
      &nbsp;&nbsp;&nbsp; <a href="core/LOOP.html">LOOP</a> <br />
      <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>
      <br />
      
      </div>
    
    </div>
  </div>
<p />
<h5 id="paragraph.A.3.2.3.3">A.3.2.3.3 Return stack</h5>   <!-- A.3.2.3.3 -->
The restrictions in section <strong><a href="usage.html#usage:returnstack">3.2.3.3 Return stack</a></strong>
are necessary if implementations are to be allowed to place loop
parameters on the return stack.
<p />

<h4 id="subsubsection.A.3.2.6">A.3.2.6 Environmental queries</h4> <!-- A.3.2.6 -->
The size in address units of various data types may be determined by
phrases such as <code>1</code> <a href="core/CHARS.html">CHARS</a>. Similarly, alignment may be
determined by phrases such as <code>1</code> <a href="core/ALIGNED.html">ALIGNED</a>.
<p />
The environmental queries are divided into two groups: those that
always produce the same value and those that might not. The former
groups include entries such as <code>MAX-N</code>. This information is
fixed by the hardware or by the design of the Forth system; a user
is guaranteed that asking the question once is sufficient.
<p />
The other, now obsolescent, group of queries are for things that may
legitimately change over time. For example an application might test
for the presence of the Double Number word set using an environment
query.  If it is missing, the system could invoke a system-dependent
process to load the word set. The system is permitted to change
<a href="core/ENVIRONMENTq.html">ENVIRONMENT?</a>'s database so that subsequent queries about
it indicate that it is present.
<p />
Note that a query that returns an &quot;unknown&quot; response could produce
a &quot;known&quot; result on a subsequent query.
<p />
<h4 id="subsubsection.A.3.2.7">A.3.2.7 Obsolescent Environmental Queries</h4> <!-- A.3.2.7 -->
<a name="rat:obsolete"></a>
<p />
When reviewing the Forth 94 Standard, the question of adapting the
word set queries had to be addressed.  Despite the recommendation
in Forth 94, word set queries have not been
supported in a meaningful way by many systems.  Consequently, these
queries are not used by many programmers.  The committee was unwilling
to exacerbate the problem by introducing additional queries for the
revised word sets.  The committee has therefore declared the word set
environment queries (see table <a href="usage.html#table:obsolete">3.5</a>) as obsolescent
with the intention of removing them altogether in the next revision.
They are retained in this standard to support existing Forth 94
programs.  New programs should not use them.
<p />
<h4 id="subsubsection.A.3.2.8">A.3.2.8 Extension queries</h4> <!-- A.3.2.8 -->
<h3 id="subsection.A.3.3">A.3.3 The Forth dictionary</h3> <!-- A.3.3 -->
A Standard Program may redefine a standard word with a non-standard
definition. The program is still standard (since it can be built on
any Standard System), but the effect is to make the combined entity
(Standard System plus Standard Program) a non-standard system.
<p />
<h4 id="subsubsection.A.3.3.1">A.3.3.1 Name space</h4> <!-- A.3.3.1 -->

<h5 id="paragraph.A.3.3.1.2">A.3.3.1.2 Definition names</h5>   <!-- A.3.3.1.2 -->
The language in this section is there to ensure the portability of
Standard Programs. If a program uses something outside the Standard
that it does not provide itself, there is no guarantee that another
implementation will have what the program needs to run. There is no
intent whatsoever to imply that all Forth programs will be somehow
lacking or inferior because they are not standard; some of the finest
jewels of the programmer's art will be non-standard. At the same time,
the committee is trying to ensure that a program labeled &quot;Standard&quot;
will meet certain expectations, particularly with regard to portability.
<p />
In many system environments the input source is unable to supply
certain non-graphic characters due to external factors, such as the
use of those characters for flow control or editing. In addition,
when interpreting from a text file, the parsing function specifically
treats non-graphic characters like spaces; thus words received by the
text interpreter will not contain embedded non-graphic characters. To
allow implementations in such environments to call themselves standard,
this minor restriction on Standard Programs is necessary.
<p />
A Standard System is allowed to permit the creation of definition
names containing non-graphic characters. Historically, such names
were used for keyboard editing functions and &quot;invisible&quot; words.
<p />
<h4 id="subsubsection.A.3.3.2">A.3.3.2 Code space</h4> <!-- A.3.3.2 -->
<h4 id="subsubsection.A.3.3.3">A.3.3.3 Data space</h4> <!-- A.3.3.3 -->
<a name="rat:dataspace"></a>
<p />
The words <a href="core/toIN.html">&gt;IN</a>, <a href="core/BASE.html">BASE</a>, <a href="block/BLK.html">BLK</a>, <a href="block/SCR.html">SCR</a>,
<a href="core/SOURCE.html">SOURCE</a>, <a href="core/SOURCE-ID.html">SOURCE-ID</a>, <a href="core/STATE.html">STATE</a>  contain information
used by the Forth system in its operation and may be of use to the
application. Any assumption made by the application about data
available in the Forth system it did not store other than the data
just listed is an environmental dependency.
<p />
There is no point in specifying (in the Standard) both what is and
what is not addressable. A Standard Program may NOT address:
<p />
<ul>
<li> Directly into the data or return stacks;
</li>
<li> Into a definition's data field if not stored by the application.
</li>
</ul>
<p />
The read-only restrictions arise because some Forth systems run from
ROM and some share I/O buffers with other users or systems. Portable
programs cannot know which areas are affected, hence the general
restrictions.
<p />
<h5 id="paragraph.A.3.3.3.1">A.3.3.3.1 Address alignment</h5>   <!-- A.3.3.3.1 -->
<a name="rat:aaddr"></a>
<p />
Some processors have restrictions on the addresses that can be used
by memory access instructions. For example, some architectures require
16-bit data to be loaded or stored only at even addresses and 32-bit
data only at addresses that are multiples of four.
<p />
An implementor can handle these alignment restrictions in one of two
ways. Forth's memory access words (<a href="core/Fetch.html">@</a>, <a href="core/Store.html">!</a>, <a href="core/PlusStore.html">+!</a>,
etc.) could be implemented in terms of smaller-width access instructions,
which have no alignment restrictions.  For example, on a system with
16-bit cells, <a href="core/Fetch.html">@</a> could be implemented with two byte-fetch
instructions and a reassembly of the bytes into a 16-bit cell.  Although
this conceals hardware restrictions from the programmer, it is inefficient,
and may have unintended side effects in some hardware environments.
An alternate implementation could define each memory-access word
using the native instructions that most closely match the word's function.
The 16-bit cell system could implement <a href="core/Fetch.html">@</a> using the processor's
16-bit fetch instruction, in this case, the responsibility for giving
<a href="core/Fetch.html">@</a> a correctly-aligned address falls on the programmer.  A
portable program must assume that alignment may be required and
follow the requirements of this section.
<p />

<h5 id="paragraph.A.3.3.3.2">A.3.3.3.2 Contiguous regions</h5>   <!-- A.3.3.3.2 -->
<a name="rat:regions"></a>
<p />
The data space of a Forth system comes in discontiguous regions. The
location of some regions is provided by the system, some by the
program. Data space is contiguous within regions, allowing address
arithmetic to generate valid addresses only within a single region.
A Standard Program cannot make any assumptions about the relative
placement of multiple regions in memory.
<p />
Section <a href="usage.html#usage:contiguous">3.3.3.2</a> does prescribe conditions under which
contiguous regions of data space may be obtained. For example:
<p />
<div class="quote">
  <div class="tt">
<a href="core/CREATE.html">CREATE</a> TABLE &nbsp;&nbsp;
    1 <a href="core/CComma.html">C,</a> 2 <a href="core/CComma.html">C,</a> <a href="core/ALIGN.html">ALIGN</a> 1000 <a href="core/Comma.html">,</a> 2000 <a href="core/Comma.html">,</a>
    
    </div>
  </div>
<p />
makes a table whose address is returned by <code>TABLE</code>. In
accessing this table,
<p />
<div class="quote">

  <table>
  <tr valign="top"><td><code>TABLE</code> <a href="core/CFetch.html">C@</a>					</td><td>will return 1 </td></tr>
  <tr valign="top"><td><code>TABLE</code> <a href="core/CHARPlus.html">CHAR+</a> <a href="core/CFetch.html">C@</a>		</td><td>will return 2 </td></tr>
  <tr valign="top"><td><code>TABLE</code> <code>2</code> <a href="core/CHARS.html">CHARS</a> <a href="core/Plus.html">+</a>
  <a href="core/ALIGNED.html">ALIGNED</a> <a href="core/Fetch.html">@</a>					</td><td>will return 1000 </td></tr>
  <tr valign="top"><td><code>TABLE</code> <code>2</code> <a href="core/CHARS.html">CHARS</a> <a href="core/Plus.html">+</a>
  <a href="core/ALIGNED.html">ALIGNED</a> <a href="core/CELLPlus.html">CELL+</a> <a href="core/Fetch.html">@</a>	</td><td>will return 2000. </td></tr>
  <tr valign="top"><td></td></tr>
  </table>
  
  </div>
<p />
Similarly,
<p />
<div class="quote">
  <div class="tt">
<a href="core/CREATE.html">CREATE</a> DATA &nbsp;&nbsp; 1000 <a href="core/ALLOT.html">ALLOT</a>
    
    </div>
  </div>
<p />
makes an array 1000 address units in size. A more portable strategy
would define the array in application units, such as:
<p />
<div class="quote">
  <div class="tt">
500 <a href="core/CONSTANT.html">CONSTANT</a> NCELLS <br />
    <a href="core/CREATE.html">CREATE</a> CELL-DATA NCELLS <a href="core/CELLS.html">CELLS</a> <a href="core/ALLOT.html">ALLOT</a>
    
    </div>
  </div>
<p />
This array can be indexed like this:
<p />
<div class="quote">
  <div class="tt">
<a href="core/Colon.html">:</a> LOOK &nbsp;&nbsp;
    NCELLS 0 <a href="core/DO.html">DO</a>
    CELL-DATA <a href="core/I.html">I</a> <a href="core/CELLS.html">CELLS</a> <a href="core/Plus.html">+</a> <a href="tools/q.html">?</a>
    <a href="core/LOOP.html">LOOP</a>
    <a href="core/Semi.html">;</a>
    
    </div>
  </div>
<p />

<h5 id="paragraph.A.3.3.3.6">A.3.3.3.6 Other transient regions</h5>   <!-- A.3.3.3.6 -->
In many existing Forth systems, these areas are at <a href="core/HERE.html">HERE</a> or
just beyond it, hence the many restrictions.
<p />
<em>(2*n)+2</em> is the size of a character string containing the
unpunctuated binary representation of the maximum double number with
a leading minus sign and a trailing space.
<p />
Implementation note: Since the minimum value of <em>n</em> is 16, the
absolute minimum size of the pictured numeric output string is 34
characters. But if your implementation has a larger <em>n</em>, you must
also increase the size of the pictured numeric output string.
<p />
<h3 id="subsection.A.3.4">A.3.4 The Forth text interpreter</h3> <!-- A.3.4 -->

<h4 id="subsubsection.A.3.4.3">A.3.4.3 Semantics</h4> <!-- A.3.4.3 -->
The &quot;initiation semantics&quot; correspond to the code that is executed
upon entering a definition, analogous to the code executed by
<a href="core/EXIT.html">EXIT</a> upon leaving a definition. The &quot;run-time semantics&quot;
correspond to code fragments, such as literals or branches, that are
compiled inside colon definitions by words with explicit compilation
semantics.
<p />
In a Forth cross compiler, the execution semantics may be specified
to occur in the host system only, the target system only, or in both
systems. For example, it may be appropriate for words such as
<a href="core/CELLS.html">CELLS</a> to execute on the host system returning a value describing
the target, for colon definitions to execute only on the target, and
for <a href="core/CONSTANT.html">CONSTANT</a> and <a href="core/VARIABLE.html">VARIABLE</a> to have execution behaviors on
both systems. Details of cross compiler behavior are beyond the scope
of this standard.
<p />

<h5 id="paragraph.A.3.4.3.2">A.3.4.3.2 Interpretation semantics</h5>   <!-- A.3.4.3.2 -->
<a name="rat:interpret"></a>
<p />
For a variety of reasons, this standard does not define interpretation
semantics for every word. Examples of these words are <a href="core/toR.html">&gt;R</a>,
<a href="core/Dotq.html">.&quot;</a>, <a href="core/DO.html">DO</a>, and <a href="core/IF.html">IF</a>. Nothing in this Standard precludes
an implementation from providing interpretation semantics for these
words, such as interactive control-flow words. However, a Standard
Program may not use them in interpretation state.
<p />

<h4 id="subsubsection.A.3.4.5">A.3.4.5 Compilation</h4> <!-- A.3.4.5 -->
Compiler recursion at the definition level consumes excessive
resources, especially to support locals. The committee does not
believe that the benefits justify the costs. Nesting definitions
is also not common practice and won't work on many systems.
<p />
<h2 id="section.A.4">A.4 Documentation requirements</h2> <!-- A.4 ========================== -->
<h3 id="subsection.A.4.1">A.4.1 System documentation</h3> <!-- A.4.1 -->
<h3 id="subsection.A.4.2">A.4.2 Program documentation</h3> <!-- A.4.2 -->
<h2 id="section.A.5">A.5 Compliance and labeling</h2> <!-- A.5 ============================= -->
<h3 id="subsection.A.5.1">A.5.1 Forth-2012 systms</h3> <!-- A.5.1 -->
Section <a href="label.html#label:label">5.1</a> defines the criteria that a system must
meet in order to justify the label &quot;Forth-2012 System&quot;. Briefly,
the minimum requirement is that the system must &quot;implement&quot; the
Core word set. There are several ways in which this requirement may
be met. The most obvious is that all Core words may be in a pre-compiled
kernel. This is not the only way of satisfying the requirement,
however. For example, some words may be provided in source blocks or
files with instructions explaining how to add them to the system if
they are needed. So long as the words are provided in such a way that
the user can obtain access to them with a clear and straightforward
procedure, they may be considered to be present.
<p />
A Forth cross compiler has many characteristics in common with a standard
system, in that both use similar compiling tools to process a program.
However, in order to fully specify a Forth-2012 standard
cross compiler it would be necessary to address complex issues dealing with
compilation
and execution semantics in both host and target environments as well as
ROMability issues. The level of effort to do this properly has proved to
be impractical at this time. As a result, although it may be possible
for a Forth cross compiler to correctly prepare a Forth-2012
standard program for execution in a target environment, it is inappropriate
for a cross compiler to be labeled a Forth-2012 standard system.
<p />
<h3 id="subsection.A.5.2">A.5.2 Forth-2012 programs</h3> <!-- A.5.2 -->

<h4 id="subsubsection.A.5.2.2">A.5.2.2 Program labeling</h4> <!-- A.5.2.2 -->
Declaring an environmental dependency should not be considered
undesirable, merely an acknowledgment that the author has taken
advantage of some assumed architecture. For example, most computers
in common use are based on two's complement binary arithmetic. By
acknowledging an environmental dependency on this architecture,
a programmer becomes entitled to use the number <code>-1</code> to
represent all bits set without significantly restricting the
portability of the program.
<p />
Because all programs require space for data and instructions, and
time to execute those instructions, they depend on the presence of
an environment providing those resources. It is impossible to predict
how little of some of these resources (e.g. stack space) might be
necessary to perform some task, so this standard does not do so.
<p />
On the other hand, as a program requires increasing levels of
resources, there will probably be sucessively fewer systems on
which it will execute sucessfully. An algorithm requiring an array
of <em>10<sup>9</sup></em> cells might run on fewer computers than one requiring
only <em>10<sup>3</sup></em>.
<p />
Since there is also no way of knowing what minimum level of resources
will be implemented in a system useful for at least some tasks, any
program performing real work labeled simply
a &quot;Standard Forth-2012 Program&quot; is unlikely to be labeled
correctly.
<p />
<h2 id="section.A.6">A.6 Glossary</h2> <!-- A.6 ============================================ -->
In this and following sections we present rationales for the handling
of specific words: why we included them, why we placed them in certain
word sets, or why we specified their names or meaning as we did.
<p />
Words in this section are organized by word set, retaining their index
numbers for easy cross-referencing to the glossary.
<p />
Historically, many Forth systems have been written in Forth. Many of
the words in Forth originally had as their primary purpose support of
the Forth system itself. For example, <a href="core/WORD.html">WORD</a> and <a href="core/FIND.html">FIND</a> are
often used as the principle instruments of the Forth text interpreter,
and <a href="core/CREATE.html">CREATE</a> in many systems is the primitive for building
dictionary entries. In defining words such as these in a standard way,
we have endeavored not to do so in such a way as to preclude their use
by implementors. One of the features of Forth that has endeared it to
its users is that the same tools that are used to implement the system
are available to the application programmer &mdash; a result of this
approach is the compactness and efficiency that characterizes most
Forth implementations.
<p />

<div class="wordHead" id="rat:core:'">
  <div class="wordNumber">A.6.1.0070</div>
  <div class="wordName">'</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use: ... <strong>'</strong> <em>name</em>.
    <p />
    Many Forth systems use a state-smart tick. Many do not.
    Forth-2012 follows the usage of Forth 94.
    <p />
    
    </div>
  </div>
<div class="secdef">

  <div class="secname">See:</div>
  <div class="sec">

 <strong><a href="rationale.html#rat:interpret">A.3.4.3.2 Interpretation semantics</a></strong>,
    <a href="rationale.html#rat:core:FIND">A.6.1.1550 FIND</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:p">
  <div class="wordNumber">A.6.1.0080</div>
  <div class="wordName">(</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use: ... <strong>(</strong> <em>ccc</em><code>)</code> ...
    
    </div>
  </div>

<div class="wordHead" id="rat:core:+LOOP">
  <div class="wordNumber">A.6.1.0140</div>
  <div class="wordName">+LOOP</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code>  ... limit first <a href="core/DO.html">DO</a>
    ... step <strong>+LOOP</strong>
    <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:,">
  <div class="wordNumber">A.6.1.0150</div>
  <div class="wordName">,</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The use of <strong>,</strong> (comma) for compiling execution tokens is
    not portable.
    <p />
    See: <a href="core/COMPILEComma.html">6.2.0945 COMPILE,</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:.q">
  <div class="wordNumber">A.6.1.0190</div>
  <div class="wordName">.&quot;</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <strong>.&quot;</strong> <em>ccc</em><code>&quot;</code> ...
    <a href="core/Semi.html">;</a>
    <p />
    An implementation may define interpretation semantics for
    <strong>.&quot;</strong> if desired. In one plausible implementation,
    interpreting <strong>.&quot;</strong> would display the delimited message.
    In another plausible implementation, interpreting <strong>.&quot;</strong>
    would compile code to display the message later. In still
    another plausible implementation, interpreting <strong>.&quot;</strong> would
    be treated as an exception. Given this variation a Standard
    Program may not use <strong>.&quot;</strong> while interpreting. Similarly,
    a Standard Program may not compile <a href="core/POSTPONE.html">POSTPONE</a> <strong>.&quot;</strong>
    inside a new word, and then use that word while interpreting.
    
    </div>
  </div>

<div class="wordHead" id="rat:core::">
  <div class="wordNumber">A.6.1.0450</div>
  <div class="wordName">:</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <strong>:</strong> <em>name</em> ... <a href="core/Semi.html">;</a>
    <p />
    In Forth 83, this word was specified to alter the search order.
    This specification is explicitly removed in this standard. We
    believe that in most cases this has no effect; however, systems
    that allow many search orders found the Forth-83 behavior of
    colon very undesirable.
    <p />
    Note that colon does not itself invoke the compiler. Colon sets
    compilation state so that later words in the parse area are
    compiled.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:;">
  <div class="wordNumber">A.6.1.0460</div>
  <div class="wordName">;</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <em>name</em> ... <strong>;</strong>
    <p />
    One function performed by both <strong>;</strong> and <a href="tools/SemiCODE.html">;CODE</a>
    is to allow the current definition to be found in the
    dictionary. If the current definition was created by
    <a href="core/ColonNONAME.html">:NONAME</a> the current definition has no definition name
    and thus cannot be found in the dictionary. If <a href="core/ColonNONAME.html">:NONAME</a>
    is implemented the Forth compiler must maintain enough
    information about the current definition to allow <strong>;</strong> and
    <a href="tools/SemiCODE.html">;CODE</a> to determine whether or not any action must
    be taken to allow it to be found.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:toBODY">
  <div class="wordNumber">A.6.1.0550</div>
  <div class="wordName">&gt;BODY</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <em>a-addr</em> is the address that <a href="core/HERE.html">HERE</a> would have
    returned had it been executed immediately after the execution
    of the <a href="core/CREATE.html">CREATE</a> that defined <em>xt</em>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:ABORTq">
  <div class="wordNumber">A.6.1.0680</div>
  <div class="wordName">ABORT&quot;</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>test</em> <strong>ABORT&quot;</strong> <em>ccc</em><code>&quot;</code>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:ACCEPT">
  <div class="wordNumber">A.6.1.0695</div>
  <div class="wordName">ACCEPT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Specification of a non-zero, positive integer count (<em>+n<sub>1</sub></em>)
    for <strong>ACCEPT</strong> allows some implementors to continue their
    practice of using a zero or negative value as a flag to trigger
    special behavior. Insofar as such behavior is outside the
    standard, Standard Programs cannot depend upon it, but the
    committee doesn't wish to preclude it unnecessarily.
    Because actual values are almost always small integers, no
    functionality is impaired by this restriction.
    <p />
    It is recommended that all non-graphic characters be reserved
    for editing or control functions and not be stored in the input
    string.
    <p />
    Because external system hardware and software may perform the
    <strong>ACCEPT</strong> function, when a line terminator is received the
    action of the cursor, and therefore the display, is
    implementation-defined. It is recommended that the cursor remain
    immediately following the entered text after a line terminator
    is received.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:ALIGN">
  <div class="wordNumber">A.6.1.0705</div>
  <div class="wordName">ALIGN</div>
</div>
<div class="wordBody">
  <div class="rationale">

    In this standard we have attempted to provide transportability
    across various CPU architectures. One of the frequent causes
    of transportability problems is the requirement of cell-aligned
    addresses on some CPUs. On these systems, <strong>ALIGN</strong> and
    <a href="core/ALIGNED.html">ALIGNED</a> may be required to build and traverse data
    structures built with <a href="core/CComma.html">C,</a>. Implementors may define these
    words as no-ops on systems for which they aren't functional.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:BEGIN">
  <div class="wordNumber">A.6.1.0760</div>
  <div class="wordName">BEGIN</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <strong>BEGIN</strong> ... <em>test</em> <a href="core/UNTIL.html">UNTIL</a>
    <a href="core/Semi.html">;</a>
    <p />
    or
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <strong>BEGIN</strong> ...
    <em>test</em> <a href="core/WHILE.html">WHILE</a> ...
    <a href="core/REPEAT.html">REPEAT</a>
    <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:BL">
  <div class="wordNumber">A.6.1.0770</div>
  <div class="wordName">BL</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Because space is used throughout Forth as the standard
    delimiter, this word is the only way a program has to find and
    use the system value of &quot;space&quot;. The value of a space
    character can not be obtained with <a href="core/CHAR.html">CHAR</a>, for instance.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:CELL+">
  <div class="wordNumber">A.6.1.0880</div>
  <div class="wordName">CELL+</div>
</div>
<div class="wordBody">
  <div class="rationale">

    As with <a href="core/ALIGN.html">ALIGN</a> and <a href="core/ALIGNED.html">ALIGNED</a>, the words <a href="core/CELLS.html">CELLS</a>
    and <strong>CELL+</strong> were added to aid in transportability across
    systems with different cell sizes. They are intended to be used
    in manipulating indexes and addresses in integral numbers of
    cell-widths. Example:
        <div class="quote">
      <div class="tt">
<a href="double/TwoVARIABLE.html">2VARIABLE</a> DATA
        <p />
        0 100 DATA <a href="core/TwoStore.html">2!</a>
        <p />
        DATA <a href="core/Fetch.html">@</a> <a href="core/d.html">.</a> 100
        <p />
        DATA <strong>CELL+</strong> <a href="core/Fetch.html">@</a> <a href="core/d.html">.</a> 0
        
        </div>
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:CELLS">
  <div class="wordNumber">A.6.1.0890</div>
  <div class="wordName">CELLS</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Example:
        <div class="quote">

      <a href="core/CREATE.html">CREATE</a> <code>NUMBERS</code>  
      <code>100</code> <strong>CELLS</strong> <a href="core/ALLOT.html">ALLOT</a>
      
      </div>
    Allots space in the array <code>NUMBERS</code> for 100 cells
    of data.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:CHAR">
  <div class="wordNumber">A.6.1.0895</div>
  <div class="wordName">CHAR</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use: ...
    <strong>CHAR</strong> <code>A</code> <a href="core/CONSTANT.html">CONSTANT</a> <code>&quot;A&quot;</code> ...
    
    </div>
  </div>

<div class="wordHead" id="rat:core:CONSTANT">
  <div class="wordNumber">A.6.1.0950</div>
  <div class="wordName">CONSTANT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use: ...
    <a href="core/DECIMAL.html">DECIMAL</a> <code>10</code> <strong>CONSTANT</strong> <code>TEN</code>
    ...
    
    </div>
  </div>

<div class="wordHead" id="rat:core:CREATE">
  <div class="wordNumber">A.6.1.1000</div>
  <div class="wordName">CREATE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The data-field address of a word defined by <strong>CREATE</strong> is
    given by the data-space pointer immediately following the
    execution of <strong>CREATE</strong>.
    <p />
    Reservation of data field space is typically done with
    <a href="core/ALLOT.html">ALLOT</a>.
    <p />
    Typical use: ...
    <strong>CREATE</strong> <code>SOMETHING</code> ...
    
    </div>
  </div>

<div class="wordHead" id="rat:core:DO">
  <div class="wordNumber">A.6.1.1240</div>
  <div class="wordName">DO</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>limit</em> <em>first</em> <strong>DO</strong>
    ...
    <a href="core/LOOP.html">LOOP</a>
    <a href="core/Semi.html">;</a>
    <p />
    or
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>limit</em> <em>first</em> <strong>DO</strong>
    ...
    <em>step</em> <a href="core/PlusLOOP.html">+LOOP</a>
    <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:DOES">
  <div class="wordNumber">A.6.1.1250</div>
  <div class="wordName">DOES&gt;</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ... <strong>DOES&gt;</strong> ... <a href="core/Semi.html">;</a>
    <p />
    Following <strong>DOES&gt;</strong>, a Standard Program may not make any
    assumptions regarding the ability to find either the name of
    the definition containing the <strong>DOES&gt;</strong> or any previous
    definition whose name may be concealed by it. <strong>DOES&gt;</strong>
    effectively ends one definition and begins another as far as
    local variables and control-flow structures are concerned.
    The compilation behavior makes it clear that the user is not
    entitled to place <strong>DOES&gt;</strong> inside any control-flow
    structures.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:ELSE">
  <div class="wordNumber">A.6.1.1310</div>
  <div class="wordName">ELSE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>test</em> <a href="core/IF.html">IF</a> ...
    <strong>ELSE</strong> ... <a href="core/THEN.html">THEN</a>
    <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:ENVIRONMENTq">
  <div class="wordNumber">A.6.1.1345</div>
  <div class="wordName">ENVIRONMENT?</div>
</div>
<div class="wordBody">
  <div class="rationale">

    In a Standard System that contains only the Core word set,
    effective use of <strong>ENVIRONMENT?</strong> requires either its use
    within a definition, or the use of user-supplied auxiliary
    definitions. The Core word set lacks both a direct method for
    collecting a string in interpretation state (<a href="file/Sq.html">11.6.1.2165 S&quot;</a>
    is in an optional word set) and also a means to test the
    returned flag in interpretation state (e.g. the optional
    <a href="tools/BracketIF.html">15.6.2.2532 [IF]</a>).
    
    </div>
  </div>

<div class="wordHead" id="rat:core:EXIT">
  <div class="wordNumber">A.6.1.1380</div>
  <div class="wordName">EXIT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>test</em> <a href="core/IF.html">IF</a>
    ... <strong>EXIT</strong> <a href="core/THEN.html">THEN</a>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:FIND">
  <div class="wordNumber">A.6.1.1550</div>
  <div class="wordName">FIND</div>
</div>
<div class="wordBody">
  <div class="rationale">

    One of the more difficult issues which the committee took on
    was the problem of divorcing the specification of
    implementation mechanisms from the specification of the
    Forth language. Three basic implementation approaches can be
    quickly enumerated:
    <p />
    <ol style="list-style-type: decimal">
    <li> Threaded code mechanisms.
    These are the traditional approaches to implementing Forth,
    but other techniques may be used.
    <p />
    </li>
    <li> Subroutine threading with &quot;macro-expansion&quot; (code
    copying). Short routines, like the code for <a href="core/DUP.html">DUP</a>,
    are copied into a definition rather than compiling a
    <code>JSR</code> reference.
    <p />
    </li>
    <li> Native coding with optimization.
    This may include stack optimization (replacing such phrases
    as <a href="core/SWAP.html">SWAP</a> <a href="core/ROT.html">ROT</a> <a href="core/Plus.html">+</a> with one or two machine
    instructions, for example), parallelization (the trend in
    the newer RISC chips is to have several functional subunits
    which can execute in parallel), and so on.
    </li>
</ol>
    <p />
    The initial requirement (inherited from Forth 83) that
    compilation addresses be compiled into the dictionary
    disallowed type 2 and type 3 implementations.
    <p />
    Type 3 mechanisms and optimizations of type 2 implementations
    were hampered by the explicit specification of immediacy or
    non-immediacy of all standard words. <a href="core/POSTPONE.html">POSTPONE</a> allowed
    de-specification of immediacy or non-immediacy for all but a
    few Forth words whose behavior must be <a href="core/STATE.html">STATE</a>-independent.
    <p />
    One type 3 implementation, Charles Moore's cmForth, has both
    compiling and interpreting versions of many Forth words. At the
    present, this appears to be a common approach for type 3
    implementations. The committee felt that this implementation
    approach must be allowed. Consequently, it is possible that
    words without interpretation semantics can be found only during
    compilation, and other words may exist in two versions: a
    compiling version and an interpreting version. Hence the values
    returned by <strong>FIND</strong> may depend on <a href="core/STATE.html">STATE</a>, and <a href="core/Tick.html">'</a>
    and <a href="core/BracketTick.html">[']</a> may be unable to find words without
    interpretation semantics.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:FM/MOD">
  <div class="wordNumber">A.6.1.1561</div>
  <div class="wordName">FM/MOD</div>
</div>
<div class="wordBody">
  <div class="rationale">

    By introducing the requirement for &quot;floored&quot; division,
    Forth 83 produced much controversy and concern on the part of
    those who preferred the more common practice followed in other
    languages of implementing division according to the behavior
    of the host CPU, which is most often symmetric (rounded toward
    zero). In attempting to find a compromise position, this
    standard provides primitives for both common varieties, floored
    and symmetric (see <a href="core/SMDivREM.html">SM/REM</a>). <strong>FM/MOD</strong> is the floored
    version.
    <p />
    The committee considered providing two complete sets
    of explicitly named division operators, and declined to do so
    on the grounds that this would unduly enlarge and complicate
    the standard. Instead, implementors may define the normal
    division words in terms of either <strong>FM/MOD</strong> or
    <a href="core/SMDivREM.html">SM/REM</a> providing they document their choice. People
    wishing to have explicitly named sets of operators are
    encouraged to do so. <strong>FM/MOD</strong> may be used, for example,
    to define:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> /_MOD <a href="core/p.html">(</a> n1 n2 -- n3 n4)
        <a href="core/toR.html">&gt;R</a> <a href="core/StoD.html">S&gt;D</a> <a href="core/Rfrom.html">R&gt;</a> <strong>FM/MOD</strong>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> /_ <a href="core/p.html">(</a> n1 n2 -- n3)
        /_MOD <a href="core/SWAP.html">SWAP</a> <a href="core/DROP.html">DROP</a>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> _MOD <a href="core/p.html">(</a> n1 n2 -- n3)
        /_MOD <a href="core/DROP.html">DROP</a>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> */_MOD <a href="core/p.html">(</a> n1 n2 n3 -- n4 n5)
        <a href="core/toR.html">&gt;R</a> <a href="core/MTimes.html">M*</a> <a href="core/Rfrom.html">R&gt;</a> <strong>FM/MOD</strong>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> */_ <a href="core/p.html">(</a> n1 n2 n3 -- n4 )
        */_MOD <a href="core/SWAP.html">SWAP</a> <a href="core/DROP.html">DROP</a>
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:IF">
  <div class="wordNumber">A.6.1.1700</div>
  <div class="wordName">IF</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>test</em> <strong>IF</strong> ... <a href="core/THEN.html">THEN</a>
    ... <a href="core/Semi.html">;</a>
    <p />
    or
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>test</em> <strong>IF</strong>
    ... <a href="core/ELSE.html">ELSE</a> ... <a href="core/THEN.html">THEN</a>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:IMMEDIATE">
  <div class="wordNumber">A.6.1.1710</div>
  <div class="wordName">IMMEDIATE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code>
    ... <a href="core/Semi.html">;</a> <strong>IMMEDIATE</strong>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:INVERT">
  <div class="wordNumber">A.6.1.1720</div>
  <div class="wordName">INVERT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The word <code>NOT</code> was originally provided in Forth as a
    flag operator to make control structures readable. Under its
    intended usage the following two definitions would produce
    identical results:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> ONE <a href="core/p.html">(</a> flag -- ) <br />
        &nbsp;&nbsp; <a href="core/IF.html">IF</a>
        <a href="core/Dotq.html">.&quot;</a> true&quot;
        <a href="core/ELSE.html">ELSE</a>
        <a href="core/Dotq.html">.&quot;</a> false&quot;
        <a href="core/THEN.html">THEN</a>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> TWO <a href="core/p.html">(</a> flag -- ) <br />
        &nbsp;&nbsp; NOT <a href="core/IF.html">IF</a>
        <a href="core/Dotq.html">.&quot;</a> false&quot;
        <a href="core/ELSE.html">ELSE</a>
        <a href="core/Dotq.html">.&quot;</a> true&quot;
        <a href="core/THEN.html">THEN</a>
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    <p />
    This was common usage prior to the Forth-83 Standard which
    redefined <code>NOT</code> as a cell-wide one's-complement
    operation, functionally equivalent to the phrase <code>-1</code>
    <a href="core/XOR.html">XOR</a>. At the same time, the data type manipulated by
    this word was changed from a flag to a cell-wide collection of
    bits and the standard value for true was changed from &quot;1&quot;
    (rightmost bit only set) to &quot;-1&quot; (all bits set). As these
    definitions of <a href="core/TRUE.html">TRUE</a> and <code>NOT</code> were incompatible
    with their previous definitions, many Forth users continue to
    rely on the old definitions. Hence both versions are in common
    use.
    <p />
    Therefore, usage of <code>NOT</code> cannot be standardized at
    this time. The two traditional meanings of <code>NOT</code> &mdash;
    that of negating the sense of a flag and that of doing a one's
    complement operation &mdash; are made available by <a href="core/ZeroEqual.html">0=</a> and
    <strong>INVERT</strong>, respectively.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:J">
  <div class="wordNumber">A.6.1.1730</div>
  <div class="wordName">J</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>J</strong> may only be used with a nested
    <a href="core/DO.html">DO</a> ... <a href="core/LOOP.html">LOOP</a>,
    <a href="core/DO.html">DO</a> ... <a href="core/PlusLOOP.html">+LOOP</a>,
    <a href="core/qDO.html">?DO</a> ... <a href="core/LOOP.html">LOOP</a>, or
    <a href="core/qDO.html">?DO</a> ... <a href="core/PlusLOOP.html">+LOOP</a>,
    for example, in the form:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code>
    ... <a href="core/DO.html">DO</a>
    ... <a href="core/DO.html">DO</a>
    ... <strong>J</strong> ...
    <a href="core/LOOP.html">LOOP</a>
    ... <a href="core/PlusLOOP.html">+LOOP</a>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:KEY">
  <div class="wordNumber">A.6.1.1750</div>
  <div class="wordName">KEY</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Use of <strong>KEY</strong> indicates that the application is processing
    primitive characters.  Some input devices, e.g., keyboards,
    may provide more information than can be represented as a
    primitive character and such an event may be received as an
    implementation-specific sequence of primitive characters.
    <p />
    See <a href="rationale.html#rat:facility:EKEY">A.10.6.2.1305 EKEY</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:LEAVE">
  <div class="wordNumber">A.6.1.1760</div>
  <div class="wordName">LEAVE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Note that <strong>LEAVE</strong> immediately exits the loop. No words
    following <strong>LEAVE</strong> within the loop will be executed.
    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ... <a href="core/DO.html">DO</a>
    ... <a href="core/IF.html">IF</a>
    ... <strong>LEAVE</strong>
    <a href="core/THEN.html">THEN</a> ... <a href="core/LOOP.html">LOOP</a> ...
    <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:LITERAL">
  <div class="wordNumber">A.6.1.1780</div>
  <div class="wordName">LITERAL</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <a href="core/Bracket.html">[</a> <code>x</code> <a href="right-bracket.html">]</a> <strong>LITERAL</strong>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:LOOP">
  <div class="wordNumber">A.6.1.1800</div>
  <div class="wordName">LOOP</div>
</div>
<div class="wordBody">
  <div class="rationale">

    
    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>limit</em> <em>first</em> <a href="core/DO.html">DO</a>
    ...
    <strong>LOOP</strong>
    ... <a href="core/Semi.html">;</a>
    <p />
    or
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>limit</em> <em>first</em> <a href="core/qDO.html">?DO</a>
    ...
    <strong>LOOP</strong>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:M*">
  <div class="wordNumber">A.6.1.1810</div>
  <div class="wordName">M*</div>
</div>
<div class="wordBody">
  <div class="rationale">

    This word is a useful early step in calculation, going to
    extra precision conveniently. It has been in use since the
    Forth systems of the early 1970's.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:MOVE">
  <div class="wordNumber">A.6.1.1900</div>
  <div class="wordName">MOVE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <a href="string/CMOVE.html">CMOVE</a> and <a href="string/CMOVEtop.html">CMOVE&gt;</a> are the primary
    move operators in Forth 83. They specify a behavior for moving
    that implies propagation if the move is suitably invoked. In
    some hardware, this specific behavior cannot be achieved using
    the best move instruction. Further, <a href="string/CMOVE.html">CMOVE</a> and
    <a href="string/CMOVEtop.html">CMOVE&gt;</a> move characters; Forth needs a move
    instruction capable of dealing with address units. Thus
    <strong>MOVE</strong> has been defined and added to the Core word set,
    and <a href="string/CMOVE.html">CMOVE</a> and <a href="string/CMOVEtop.html">CMOVE&gt;</a> have been
    moved to the String word set.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:POSTPONE">
  <div class="wordNumber">A.6.1.2033</div>
  <div class="wordName">POSTPONE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>ENDIF</code>
    <strong>POSTPONE</strong> <a href="core/THEN.html">THEN</a>
    <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <a href="core/IF.html">IF</a> ... <code>ENDIF</code>
    ... <a href="core/Semi.html">;</a>
    <p />
    <strong>POSTPONE</strong> replaces most of the functionality of
    <code>COMPILE</code> and  <a href="core/BracketCOMPILE.html">[COMPILE]</a>. <code>COMPILE</code> and
    
    <a href="core/BracketCOMPILE.html">[COMPILE]</a> are used for the same purpose: postpone the
    compilation behavior of the next word in the parse area.
    <code>COMPILE</code> was designed to be applied to non-immediate
    words and <a href="core/BracketCOMPILE.html">[COMPILE]</a> to immediate words. This burdens
    the programmer with needing to know which words in a system
    are immediate. Consequently, Forth standards have had to
    specify the immediacy or non-immediacy of all words covered by
    the standard. This unnecessarily constrains implementors.
    <p />
    A second problem with <code>COMPILE</code> is that some
    programmers have come to expect and exploit a particular
    implementation, namely:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>COMPILE</code> <a href="core/Rfrom.html">R&gt;</a>
    <a href="core/DUP.html">DUP</a> <a href="core/Fetch.html">@</a> <a href="core/Comma.html">,</a> <a href="core/CELLPlus.html">CELL+</a> <a href="core/toR.html">&gt;R</a>
    <a href="core/Semi.html">;</a>
    <p />
    This implementation will not work on native code Forth systems.
    In a native code Forth using inline code expansion and peephole
    optimization, the size of the object code produced varies; this
    information is difficult to communicate to a &quot;dumb&quot;
    <code>COMPILE</code>. A &quot;smart&quot; (i.e., immediate) <code>COMPILE</code>
    would not have this problem, but this was forbidden in previous
    standards.
    <p />
    For these reasons, <code>COMPILE</code> has not been included in
    the standard and <a href="core/BracketCOMPILE.html">[COMPILE]</a> has been moved in favor of
    <strong>POSTPONE</strong>. Additional discussion can be found in Hayes,
    J.R., &quot;Postpone&quot;, <em>Proceedings of the 1989 Rochester
    Forth Conference</em>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:RECURSE">
  <div class="wordNumber">A.6.1.2120</div>
  <div class="wordName">RECURSE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ... <strong>RECURSE</strong> ... <a href="core/Semi.html">;</a>
    <p />
    This is Forth's recursion operator; in some implementations it
    is called <code>MYSELF</code>. The usual example is the coding of
    the factorial function.
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> FACTORIAL <a href="core/p.html">(</a> +n1 -- +n2) <br />
        &nbsp;&nbsp; <a href="core/DUP.html">DUP</a> 2 <a href="core/less.html">&lt;</a> <a href="core/IF.html">IF</a> 
        <a href="core/DROP.html">DROP</a> 1 <a href="core/EXIT.html">EXIT</a> 
        <a href="core/THEN.html">THEN</a> <br />
        &nbsp;&nbsp; <a href="core/DUP.html">DUP</a> 1-  <strong>RECURSE</strong>  <a href="core/Times.html">*</a> <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    <p />
    <em>n<sub>2</sub> = n<sub>1</sub>(n<sub>1</sub>-1)(n<sub>1</sub>-2)...(2)(1)</em>, the product of <em>n<sub>1</sub></em>
    with all positive integers less than itself (as a special case,
    zero factorial equals one). While beloved of computer scientists,
    recursion makes unusually heavy use of both stacks and should
    therefore be used with caution. See alternate definition in
    <a href="rationale.html#rat:core:REPEAT">A.6.1.2140 REPEAT</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:REPEAT">
  <div class="wordNumber">A.6.1.2140</div>
  <div class="wordName">REPEAT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> FACTORIAL <a href="core/p.html">(</a> +n1 -- +n2 ) <br />
        &nbsp;&nbsp; <a href="core/DUP.html">DUP</a> 2 <a href="core/less.html">&lt;</a> <a href="core/IF.html">IF</a> 
        <a href="core/DROP.html">DROP</a> 1 <a href="core/EXIT.html">EXIT</a>  <a href="core/THEN.html">THEN</a> <br />
        &nbsp;&nbsp; <a href="core/DUP.html">DUP</a> <br />
        &nbsp;&nbsp; <a href="core/BEGIN.html">BEGIN</a>  <a href="core/DUP.html">DUP</a> 2 <a href="core/more.html">&gt;</a> <a href="core/WHILE.html">WHILE</a> <br />
        &nbsp;&nbsp;   1-  <a href="core/SWAP.html">SWAP</a> <a href="core/OVER.html">OVER</a> <a href="core/Times.html">*</a>  <a href="core/SWAP.html">SWAP</a> <br />
        &nbsp;&nbsp; <strong>REPEAT</strong> <a href="core/DROP.html">DROP</a> <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:Sq">
  <div class="wordNumber">A.6.1.2165</div>
  <div class="wordName">S&quot;</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <strong>S&quot;</strong> <em>ccc</em><code>&quot;</code>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:SM/REM">
  <div class="wordNumber">A.6.1.2214</div>
  <div class="wordName">SM/REM</div>
</div>
<div class="wordBody">
  <div class="rationale">

    See the previous discussion of division under <a href="core/FMDivMOD.html">FM/MOD</a>.
    <strong>SM/REM</strong> is the symmetric-division primitive, which allows
    programs to define the following symmetric-division operators:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> /-REM <a href="core/p.html">(</a> n1 n2 -- n3 n4 )
        <a href="core/toR.html">&gt;R</a> <a href="core/StoD.html">S&gt;D</a> <a href="core/Rfrom.html">R&gt;</a> <strong>SM/REM</strong>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> /- <a href="core/p.html">(</a> n1 n2 -- n3 )
        /-REM <a href="core/SWAP.html">SWAP</a> <a href="core/DROP.html">DROP</a>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> -REM <a href="core/p.html">(</a> n1 n2 -- n3 )
        /-REM <a href="core/DROP.html">DROP</a>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> */-REM <a href="core/p.html">(</a> n1 n2 n3 -- n4 n5 )
        <a href="core/toR.html">&gt;R</a> <a href="core/MTimes.html">M*</a> <a href="core/Rfrom.html">R&gt;</a> <strong>SM/REM</strong>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> */- <a href="core/p.html">(</a> n1 n2 n3 -- n4 )
        */-REM <a href="core/SWAP.html">SWAP</a> <a href="core/DROP.html">DROP</a>
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:SOURCE">
  <div class="wordNumber">A.6.1.2216</div>
  <div class="wordName">SOURCE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>SOURCE</strong> simplifies the process of directly accessing the
    input buffer by hiding the differences between its location
    for different input sources. This also gives implementors more
    flexibility in their implementation of buffering mechanisms
    for different input sources. The committee moved away from an
    input buffer specification consisting of a collection of
    individual variables.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:STATE">
  <div class="wordNumber">A.6.1.2250</div>
  <div class="wordName">STATE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Although
    <a href="core/EVALUATE.html">EVALUATE</a>,
    <a href="block/LOAD.html">LOAD</a>,
    <a href="file/INCLUDE-FILE.html">INCLUDE-FILE</a> and
    <a href="file/INCLUDED.html">INCLUDED</a>
    are not listed as words which alter <strong>STATE</strong>, the text
    interpreted by any one of these words could include one or
    more words which explicitly alter <strong>STATE</strong>.
    <a href="core/EVALUATE.html">EVALUATE</a>,
    <a href="block/LOAD.html">LOAD</a>,
    <a href="file/INCLUDE-FILE.html">INCLUDE-FILE</a> and
    <a href="file/INCLUDED.html">INCLUDED</a>
    do not in themselves alter <strong>STATE</strong>.
    <p />
    <strong>STATE</strong> does not nest with text interpreter nesting. For
    example, the code sequence:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>FOO</code> 
    <a href="core/Sq.html">S&quot;</a> <code>]&quot;</code> <a href="core/EVALUATE.html">EVALUATE</a>
    <a href="core/Semi.html">;</a>
    &nbsp;&nbsp;&nbsp;&nbsp;
    <code>FOO</code>
    <p />
    will leave the system in compilation state. Similarly, after
    <a href="block/LOAD.html">LOAD</a>ing a block containing <a href="right-bracket.html">]</a>, the system
    will be in compilation state.
    <p />
    Note that <a href="right-bracket.html">]</a> does not affect the parse area and that the
    only effect that <a href="core/Colon.html">:</a> has on the parse area is to parse a
    word. This entitles a program to use these words to set the
    state with known side-effects on the parse area. For example:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>NOP</code> 
    <a href="core/Colon.html">:</a> <a href="core/POSTPONE.html">POSTPONE</a> <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>
    <a href="core/Semi.html">;</a>
    <p />
    &nbsp;&nbsp; <code>NOP</code> <a href="core/ALIGN.html">ALIGN</a> <br />
    &nbsp;&nbsp; <code>NOP</code> <a href="core/ALIGNED.html">ALIGNED</a>
    <p />
    Some non-compliant systems have <a href="right-bracket.html">]</a> invoke a
    compiler loop in addition to setting <strong>STATE</strong>. Such a
    system would inappropriately attempt to compile the second
    use of <code>NOP</code>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:THEN">
  <div class="wordNumber">A.6.1.2270</div>
  <div class="wordName">THEN</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>test</em> <a href="core/IF.html">IF</a> ... <strong>THEN</strong>
    ... <a href="core/Semi.html">;</a>
    <p />
    or
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <em>test</em> <a href="core/IF.html">IF</a> ... <a href="core/ELSE.html">ELSE</a> ... <strong>THEN</strong>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:UNLOOP">
  <div class="wordNumber">A.6.1.2380</div>
  <div class="wordName">UNLOOP</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">

      <a href="core/Colon.html">:</a> <code>X</code> ... <br />
      &nbsp;&nbsp; <em>limit</em> <em>first</em> <a href="core/DO.html">DO</a> <br />
      &nbsp;&nbsp;   ... <em>test</em> <a href="core/IF.html">IF</a>
      ... <strong>UNLOOP</strong> <a href="core/EXIT.html">EXIT</a> <a href="core/THEN.html">THEN</a> ... <br />
      &nbsp;&nbsp; <a href="core/LOOP.html">LOOP</a> ... <br />
      <a href="core/Semi.html">;</a>
      
      </div>
    <p />
    <strong>UNLOOP</strong> allows the use of <a href="core/EXIT.html">EXIT</a> within the context
    of <a href="core/DO.html">DO</a> ... <a href="core/LOOP.html">LOOP</a> and related do-loop constructs.
    <strong>UNLOOP</strong> as a function has been called <code>UNDO</code>.
    <strong>UNLOOP</strong> is more indicative of the action: nothing gets
    undone &mdash; we simply stop doing it.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:UNTIL">
  <div class="wordNumber">A.6.1.2390</div>
  <div class="wordName">UNTIL</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <a href="core/BEGIN.html">BEGIN</a> ... <em>test</em> <strong>UNTIL</strong>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:VARIABLE">
  <div class="wordNumber">A.6.1.2410</div>
  <div class="wordName">VARIABLE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <strong>VARIABLE</strong> <code>XYZ</code>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:WHILE">
  <div class="wordNumber">A.6.1.2430</div>
  <div class="wordName">WHILE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <a href="core/BEGIN.html">BEGIN</a> ...
    <em>test</em> <strong>WHILE</strong>
    ... <a href="core/REPEAT.html">REPEAT</a>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:WORD">
  <div class="wordNumber">A.6.1.2450</div>
  <div class="wordName">WORD</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use: <em>char</em> <strong>WORD</strong> <em>ccc</em>&lt;<em>char</em>&gt;
    
    </div>
  </div>

<div class="wordHead" id="rat:core:[">
  <div class="wordNumber">A.6.1.2500</div>
  <div class="wordName">[</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <strong>[</strong> <code>4321</code> <a href="right-bracket.html">]</a> <a href="core/LITERAL.html">LITERAL</a>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:[']">
  <div class="wordNumber">A.6.1.2510</div>
  <div class="wordName">[']</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <strong>[']</strong> <em>name</em>
    ... <a href="core/Semi.html">;</a>
    <p />
    See:
    <a href="rationale.html#rat:core:FIND">A.6.1.1550 FIND</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:[CHAR]">
  <div class="wordNumber">A.6.1.2520</div>
  <div class="wordName">[CHAR]</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <strong>[CHAR]</strong> <em>c</em>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:]">
  <div class="wordNumber">A.6.1.2540</div>
  <div class="wordName">]</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <a href="core/Bracket.html">[</a> <code>4321</code> <strong>]</strong> <a href="core/LITERAL.html">LITERAL</a>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>
<p />

<h3 id="subsection.A.7.2">A.7.2 Core extension words</h3> <!-- A.6.2 ================= -->
<a name="rat:core-ext"></a>
<p />
The words in this collection fall into several categories:
<p />
<ul>
<li> Words that are in common use but are deemed less essential than
Core words (e.g., <a href="core/Zerone.html">0&lt;&gt;</a>);
<p />
</li>
<li> Words that are in common use but can be trivially defined from
Core words (e.g., <a href="core/FALSE.html">FALSE</a>);
<p />
</li>
<li> Words that are primarily useful in narrowly defined types of
applications or are in less frequent use (e.g., <a href="core/PARSE.html">PARSE</a>);
<p />
</li>
<li> Words that are being deprecated in favor of new words introduced
to solve specific problems.
</li>
</ul>
<p />
Because of the varied justifications for inclusion of these words,
the committee does not encourage implementors to offer the complete
collection, but to select those words deemed most valuable to their
clientele.
<p />

<div class="wordHead" id="rat:core:.p">
  <div class="wordNumber">A.6.2.0200</div>
  <div class="wordName">.(</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <strong>.(</strong> <em>ccc</em><code>)</code>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:.R">
  <div class="wordNumber">A.6.2.0210</div>
  <div class="wordName">.R</div>
</div>
<div class="wordBody">
  <div class="rationale">

    In <strong>.R</strong>, &quot;R&quot; is short for RIGHT.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:2toR">
  <div class="wordNumber">A.6.2.0340</div>
  <div class="wordName">2&gt;R</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The primary advantage of <strong>2&gt;R</strong> is that it puts the top
    stack entry on the top of the return stack. For instance, a
    double-cell number may be transferred to the return stack and
    still have the most significant cell accessible on the top of
    the return stack.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:2Rfrom">
  <div class="wordNumber">A.6.2.0410</div>
  <div class="wordName">2R&gt;</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Note that <strong>2R&gt;</strong> is not equivalent to <a href="core/Rfrom.html">R&gt;</a> <a href="core/Rfrom.html">R&gt;</a>.
    Instead, it mirrors the action of <a href="core/TwotoR.html">2&gt;R</a>
    (see <a href="rationale.html#rat:core:2toR">A.6.2.0340</a>).
    
    </div>
  </div>

<div class="wordHead" id="rat:core::NONAME">
  <div class="wordNumber">A.6.2.0455</div>
  <div class="wordName">:NONAME</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/DEFER.html">DEFER</a> <code>print</code> <br />
    
    &nbsp;&nbsp; <strong>:NONAME</strong> <a href="core/p.html">(</a> n -- ) <a href="core/d.html">.</a> <a href="core/Semi.html">;</a> <a href="core/IS.html">IS</a> <code>print</code>
    <p />
    
    </div>
  </div>
<div class="secdef">

  <div class="secname">Note:</div>
  <div class="sec">

 <a href="core/RECURSE.html">RECURSE</a> and <a href="core/DOES.html">DOES&gt;</a> are allowed within a <strong>:NONAME</strong> definition.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:qDO">
  <div class="wordNumber">A.6.2.0620</div>
  <div class="wordName">?DO</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ... <strong>?DO</strong> ... <a href="core/LOOP.html">LOOP</a> ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:AGAIN">
  <div class="wordNumber">A.6.2.0700</div>
  <div class="wordName">AGAIN</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code>
    ... <a href="core/BEGIN.html">BEGIN</a> ... <strong>AGAIN</strong>
    ... <a href="core/Semi.html">;</a>
    <p />
    Unless word-sequence has a way to terminate, this is an
    endless loop.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:BUFFER:">
  <div class="wordNumber">A.6.2.0825</div>
  <div class="wordName">BUFFER:</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>BUFFER:</strong> provides a means of defining an uninitialized buffer.
    In systems that use a single memory space, this can effectively
    be defined as:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> <strong>BUFFER:</strong> <a href="core/p.html">(</a> u &quot;&lt;name&gt;&quot; -- ; -- addr ) <br />
        &nbsp;&nbsp;&nbsp;<a href="core/CREATE.html">CREATE</a> <a href="core/ALLOT.html">ALLOT</a> <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    <p />
    However, many systems profit from a separation of uninitialized and
    initialized data areas.  Such systems can implement <strong>BUFFER:</strong> so
    that it allocates memory from a separate uninitialized memory area.
    Embedded systems can take advantage of the lack of initialization of the
    memory area while hosted systems are permitted to <a href="memory/ALLOCATE.html">ALLOCATE</a>
    a buffer.
    A system may select a region of memory for performance reasons.
    A detailed knowledge of the memory allocation within the system
    is required to provide a version of <strong>BUFFER:</strong> that can take
    advantage of the system.
    <p />
    It should be noted that the memory buffer provided by <strong>BUFFER:</strong>
    is not initialized by the system and that if the application requires
    it to be initialized, it is the responsibility of the application to
    initialize it.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:Cq">
  <div class="wordNumber">A.6.2.0855</div>
  <div class="wordName">C&quot;</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <strong>C&quot;</strong> <em>ccc</em><code>&quot;</code>
    ... <a href="core/Semi.html">;</a>
    <p />
    See: <strong><a href="rationale.html#rat:cstring">A.3.1.3.4 Counted strings</a></strong>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:CASE">
  <div class="wordNumber">A.6.2.0873</div>
  <div class="wordName">CASE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">

      <a href="core/Colon.html">:</a> <code>X</code> ... <br />
      &nbsp;&nbsp; <strong>CASE</strong> <br />
      &nbsp;&nbsp;   <em>test1</em> <a href="core/OF.html">OF</a> ... <a href="core/ENDOF.html">ENDOF</a> <br />
      &nbsp;&nbsp;   <em>testn</em> <a href="core/OF.html">OF</a> ... <a href="core/ENDOF.html">ENDOF</a> <br />
      &nbsp;&nbsp;   ... <a href="core/p.html">(</a> default ) <br />
      &nbsp;&nbsp; <a href="core/ENDCASE.html">ENDCASE</a> ... <br />
      <a href="core/Semi.html">;</a>
      
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:COMPILE,">
  <div class="wordNumber">A.6.2.0945</div>
  <div class="wordName">COMPILE,</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>COMPILE,</strong> is the compilation equivalent of <a href="core/EXECUTE.html">EXECUTE</a>.
    <p />
    In traditional threaded-code implementations, compilation is
    performed by <a href="core/Comma.html">,</a> (comma). This usage is not portable; it
    doesn't work for subroutine-threaded, native code, or
    relocatable implementations. Use of <strong>COMPILE,</strong> is portable.
    <p />
    In most systems it is possible to implement <strong>COMPILE,</strong> so
    it will generate code that is optimized to the same extent as
    code that is generated by the normal compilation process.
    However, in some implementations there are two different
    &quot;tokens&quot; corresponding to a particular definition name:
    the normal &quot;execution token&quot; that is used while interpreting
    or with <a href="core/EXECUTE.html">EXECUTE</a>, and another &quot;compilation token&quot; that
    is used while compiling. It is not always possible to obtain
    the compilation token from the execution token. In these
    implementations, <strong>COMPILE,</strong> might not generate code that
    is as efficient as normally compiled code.
    <p />
    The intention is that <strong>COMPILE,</strong> can be used as follows to write
    the classic interpreter/compiler loop:
    <p />
        <div class="quote">
      <div class="tt">
... 										&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="core/p.html">(</a> c-addr ) <br />
        <a href="core/FIND.html">FIND</a> <a href="core/qDUP.html">?DUP</a> <a href="core/IF.html">IF</a>			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<a href="core/p.html">(</a> xt +-1 ) <br />
        &nbsp;&nbsp; <a href="core/STATE.html">STATE</a> <a href="core/Fetch.html">@</a> <a href="core/IF.html">IF</a>		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<a href="core/p.html">(</a> xt +-1 ) <br />
        &nbsp;&nbsp;&nbsp;&nbsp; <a href="core/Zeromore.html">0&gt;</a> <a href="core/IF.html">IF</a> 				<a href="core/EXECUTE.html">EXECUTE</a> 			<a href="core/ELSE.html">ELSE</a> 				<strong>COMPILE,</strong> 			<a href="core/THEN.html">THEN</a>								&nbsp;	<a href="core/p.html">(</a> ??? ) <br />
        &nbsp;&nbsp; <a href="core/ELSE.html">ELSE</a>							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<a href="core/p.html">(</a> xt +-1 ) <br />
        &nbsp;&nbsp;&nbsp;&nbsp; <a href="core/DROP.html">DROP</a> <a href="core/EXECUTE.html">EXECUTE</a> 		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<a href="core/p.html">(</a> ??? ) <br />
        &nbsp;&nbsp; <a href="core/THEN.html">THEN</a> <br />
        <a href="core/ELSE.html">ELSE</a> 							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	<a href="core/p.html">(</a> c-addr ) <br />
        &nbsp;&nbsp; <a href="core/p.html">(</a> <span class="rm">whatever you do for an undefined word</span> ) <br />
        <a href="core/THEN.html">THEN</a> <br />
        ...
        
        </div>
      </div>
    <p />
    Thus the interpretation semantics are left undefined, as <strong>COMPILE,</strong>
    will not be executed during interpretation.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:ENDCASE">
  <div class="wordNumber">A.6.2.1342</div>
  <div class="wordName">ENDCASE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">

      <a href="core/Colon.html">:</a> <code>X</code> ... <br />
      &nbsp;&nbsp; <a href="core/CASE.html">CASE</a> <br />
      &nbsp;&nbsp;   <em>test1</em> <a href="core/OF.html">OF</a> ... <a href="core/ENDOF.html">ENDOF</a> <br />
      &nbsp;&nbsp;   <em>testn</em> <a href="core/OF.html">OF</a> ... <a href="core/ENDOF.html">ENDOF</a> <br />
      &nbsp;&nbsp;   ... <a href="core/p.html">(</a> default ) <br />
      &nbsp;&nbsp; <strong>ENDCASE</strong> ... <br />
      <a href="core/Semi.html">;</a>
      
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:ENDOF">
  <div class="wordNumber">A.6.2.1343</div>
  <div class="wordName">ENDOF</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">

      <a href="core/Colon.html">:</a> <code>X</code> ... <br />
      &nbsp;&nbsp; <a href="core/CASE.html">CASE</a> <br />
      &nbsp;&nbsp;   <em>test1</em> <a href="core/OF.html">OF</a> ... <strong>ENDOF</strong> <br />
      &nbsp;&nbsp;   <em>testn</em> <a href="core/OF.html">OF</a> ... <strong>ENDOF</strong> <br />
      &nbsp;&nbsp;   ... <a href="core/p.html">(</a> default ) <br />
      &nbsp;&nbsp; <a href="core/ENDCASE.html">ENDCASE</a> ... <br />
      <a href="core/Semi.html">;</a>
      
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:MARKER">
  <div class="wordNumber">A.6.2.1850</div>
  <div class="wordName">MARKER</div>
</div>
<div class="wordBody">
  <div class="rationale">

    As dictionary implementations have become more elaborate
    and in some cases have used multiple address spaces,
    <a href="tools/FORGET.html">FORGET</a> has become prohibitively difficult or
    impossible to implement on many Forth systems. <strong>MARKER</strong>
    greatly eases the problem by making it possible for the
    system to remember &quot;landmark information&quot; in advance that
    specifically marks the spots where the dictionary may at some
    future time have to be rearranged.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:OF">
  <div class="wordNumber">A.6.2.1950</div>
  <div class="wordName">OF</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">

      <a href="core/Colon.html">:</a> <code>X</code> ... <br />
      &nbsp;&nbsp; <a href="core/CASE.html">CASE</a> <br />
      &nbsp;&nbsp;   <em>test1</em> <strong>OF</strong> ... <a href="core/ENDOF.html">ENDOF</a> <br />
      &nbsp;&nbsp;   <em>testn</em> <strong>OF</strong> ... <a href="core/ENDOF.html">ENDOF</a> <br />
      &nbsp;&nbsp;   ... <a href="core/p.html">(</a> default ) <br />
      &nbsp;&nbsp; <a href="core/ENDCASE.html">ENDCASE</a> ... <br />
      <a href="core/Semi.html">;</a>
      
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:PAD">
  <div class="wordNumber">A.6.2.2000</div>
  <div class="wordName">PAD</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>PAD</strong> has been available as scratch storage for strings
    since the earliest Forth implementations. It was brought to
    our attention that many programmers are reluctant to use
    <strong>PAD</strong>, fearing incompatibilities with system uses.
    <strong>PAD</strong> is specifically intended as a programmer convenience,
    however, which is why we documented the fact that no standard
    words use it.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:PARSE">
  <div class="wordNumber">A.6.2.2008</div>
  <div class="wordName">PARSE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use: <em>char</em> <strong>PARSE</strong> <em>ccc</em>&lt;<em>char</em>&gt;
    <p />
    The traditional Forth word for parsing is <a href="core/WORD.html">WORD</a>.
    <strong>PARSE</strong> solves the following problems with <a href="core/WORD.html">WORD</a>:
    <p />
    <ol style="list-style-type: decimal">
    <li> <a href="core/WORD.html">WORD</a> always skips leading delimiters. This
    behavior is appropriate for use by the text interpreter,
    which looks for sequences of non-blank characters, but is
    inappropriate for use by words like <a href="core/p.html">(</a> , <a href="core/Dotp.html">.(</a>,
    and <a href="core/Dotq.html">.&quot;</a>. Consider the following (flawed) definition
    of <a href="core/Dotp.html">.(</a>:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <a href="core/Dotp.html">.(</a>  
    <a href="core/BracketCHAR.html">[CHAR]</a> <code>)</code>  
    <a href="core/WORD.html">WORD</a> <a href="core/COUNT.html">COUNT</a> <a href="core/TYPE.html">TYPE</a>
    <a href="core/Semi.html">;</a>   <a href="core/IMMEDIATE.html">IMMEDIATE</a>
    <p />
    This works fine when used in a line like:
    <p />
    &nbsp;&nbsp; <a href="core/Dotp.html">.(</a> <code>HELLO)</code> &nbsp;&nbsp; <code>5</code> <a href="core/d.html">.</a>
    <p />
    but consider what happens if the user enters an empty
    string:
    <p />
    &nbsp;&nbsp; <a href="core/Dotp.html">.(</a> <code>)</code> &nbsp;&nbsp; <code>5</code> <a href="core/d.html">.</a>
    <p />
    The definition of <a href="core/Dotp.html">.(</a> shown above would treat the
    <code>)</code> as a leading delimiter, skip it, and continue
    consuming characters until it located another <code>)</code>
    that followed a non-<code>)</code> character, or until the
    parse area was empty. In the example shown, the
    <code>5</code> <a href="core/d.html">.</a>
    would be treated as part of the string to be printed.
    <p />
    With <strong>PARSE</strong>, we could write a correct definition of
    <a href="core/Dotp.html">.(</a>:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <a href="core/Dotp.html">.(</a>  
    <a href="core/BracketCHAR.html">[CHAR]</a> <code>)</code>  
    <strong>PARSE</strong> <a href="core/TYPE.html">TYPE</a>
    <a href="core/Semi.html">;</a>   <a href="core/IMMEDIATE.html">IMMEDIATE</a>
    <p />
    This definition avoids the &quot;empty string&quot; anomaly.
    <p />
    </li>
    <li> <a href="core/WORD.html">WORD</a> returns its result as a counted string.
    This has four bad effects:
    <p />
    <ol style="list-style-type: lower-alpha">
    <li> The characters accepted by <a href="core/WORD.html">WORD</a> must be
    copied from the input buffer into a transient buffer,
    in order to make room for the count character that
    must be at the beginning of the counted string. The
    copy step is inefficient, compared to <strong>PARSE</strong>,
    which leaves the string in the input buffer and doesn't
    need to copy it anywhere.
    <p />
    </li>
    <li> <a href="core/WORD.html">WORD</a> must be careful not to store too many
    characters into the transient buffer, thus overwriting
    something beyond the end of the buffer. This adds to
    the overhead of the copy step. (<a href="core/WORD.html">WORD</a> may have
    to scan a lot of characters before finding the trailing
    delimiter.)
    <p />
    </li>
    <li> The count character limits the length of the string
    returned by <a href="core/WORD.html">WORD</a> to 255 characters (longer
    strings can easily be stored in blocks!). This
    limitation does not exist for <strong>PARSE</strong>.
    <p />
    </li>
    <li> The transient buffer is typically overwritten by the
    next use of <a href="core/WORD.html">WORD</a>.
    </li>
</ol>
    <p />
    The need for <a href="core/WORD.html">WORD</a> has largely been eliminated by
    <strong>PARSE</strong> and <a href="core/PARSE-NAME.html">PARSE-NAME</a>. <a href="core/WORD.html">WORD</a> is
    retained for backward compatibility.
    </li>
</ol>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:PICK">
  <div class="wordNumber">A.6.2.2030</div>
  <div class="wordName">PICK</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <code>0</code> <strong>PICK</strong> is equivalent to <a href="core/DUP.html">DUP</a> and
    <code>1</code> <strong>PICK</strong> is equivalent to <a href="core/OVER.html">OVER</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:REFILL">
  <div class="wordNumber">A.6.2.2125</div>
  <div class="wordName">REFILL</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>REFILL</strong> is designed to behave reasonably for all possible
    input sources. If the input source is coming from the user,
    <strong>REFILL</strong> could still return a false value if, for instance,
    a communication channel closes so that the system knows that no
    more input will be available.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:ROLL">
  <div class="wordNumber">A.6.2.2150</div>
  <div class="wordName">ROLL</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <code>2</code> <strong>ROLL</strong> is equivalent to <a href="core/ROT.html">ROT</a>,
    <code>1</code> <strong>ROLL</strong> is equivalent to <a href="core/SWAP.html">SWAP</a> and
    <code>0</code> <strong>ROLL</strong> is a null operation.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:SAVE-INPUT">
  <div class="wordNumber">A.6.2.2182</div>
  <div class="wordName">SAVE-INPUT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>SAVE-INPUT</strong> and <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> allow the same
    degree of input source repositioning within a text file as is
    available with <a href="block/BLOCK.html">BLOCK</a> input. <strong>SAVE-INPUT</strong>
    and <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> &quot;hide the details&quot; of the operations
    necessary to accomplish this repositioning, and are used the
    same way with all input sources. This makes it easier for
    programs to reposition the input source, because they do not
    have to inspect several variables and take different action
    depending on the values of those variables.
    <p />
    <strong>SAVE-INPUT</strong> and <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> are intended for
    repositioning within a single input source; for example, the
    following scenario is NOT allowed for a Standard Program:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> XX <br />
        &nbsp;&nbsp; <strong>SAVE-INPUT</strong>   <a href="core/CREATE.html">CREATE</a> <br />
        &nbsp;&nbsp; <a href="core/Sq.html">S&quot;</a> RESTORE-INPUT&quot; <a href="core/EVALUATE.html">EVALUATE</a> <br />
        &nbsp;&nbsp; <a href="core/ABORTq.html">ABORT&quot;</a> couldn't restore input&quot; <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    <p />
    This is incorrect because, at the time <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> is
    executed, the input source is the string via <a href="core/EVALUATE.html">EVALUATE</a>,
    which is not the same input source that was in effect when
    <strong>SAVE-INPUT</strong> was executed.
    <p />
    The following code is allowed:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> XX <br />
        &nbsp;&nbsp; <strong>SAVE-INPUT</strong>   <a href="core/CREATE.html">CREATE</a> <br />
        &nbsp;&nbsp; <a href="core/Sq.html">S&quot;</a> <a href="core/Dotp.html">.(</a> Hello)&quot; <a href="core/EVALUATE.html">EVALUATE</a> <br />
        &nbsp;&nbsp; <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> <a href="core/ABORTq.html">ABORT&quot;</a> couldn't restore input&quot; <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    <p />
    After <a href="core/EVALUATE.html">EVALUATE</a> returns, the input source specification
    is restored to its previous state, thus
    <a href="core:SAVE-INPUT"><strong><code>SAVE-</code></strong></a>
    <a href="core:SAVE-INPUT"><strong><code>INPUT</code></strong></a>
    and <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> are called with the same input source
    in effect.
    <p />
    In the above examples, the <a href="core/EVALUATE.html">EVALUATE</a> phrase could have
    been replaced by a phrase involving <a href="file/INCLUDE-FILE.html">INCLUDE-FILE</a>
    and the same rules would apply.
    <p />
    The standard does not specify what happens if a program
    violates the above rules. A Standard System might check for
    the violation and return an exception indication from
    <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a>, or it might fail in an unpredictable
    way.
    <p />
    The return value from <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> is primarily
    intended to report the case where the program attempts to
    restore the position of an input source whose position cannot
    be restored. The keyboard might be such an input source.
    <p />
    Nesting of <strong>SAVE-INPUT</strong> and <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> is
    allowed. For example, the following situation works as
    expected:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> XX <br />
        &nbsp;&nbsp; <strong>SAVE-INPUT</strong> <br />
        &nbsp;&nbsp;   <a href="core/Sq.html">S&quot;</a> f1&quot; <a href="file/INCLUDED.html">INCLUDED</a> <br />
        &nbsp;&nbsp;   <a href="core/bs.html">\</a> The file &quot;f1&quot; includes: <br />
        &nbsp;&nbsp;   <a href="core/bs.html">\</a>    ... SAVE-INPUT ... RESTORE-INPUT ... <br />
        &nbsp;&nbsp;   <a href="core/bs.html">\</a> End of file &quot;f1&quot; <br />
        &nbsp;&nbsp; <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a>   <a href="core/ABORTq.html">ABORT&quot;</a> couldn't restore input&quot; <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    <p />
    In principle, <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> could be implemented to
    &quot;always fail&quot;, e.g.:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> <a href="core/p.html">(</a> x1 ... xn n -- flag ) <br />
        &nbsp;&nbsp; 0 <a href="core/qDO.html">?DO</a> <a href="core/DROP.html">DROP</a> <a href="core/LOOP.html">LOOP</a> <a href="core/TRUE.html">TRUE</a> <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    <p />
    Such an implementation would not be useful in most cases. It
    would be preferable for a system to leave <strong>SAVE-INPUT</strong>
    and <a href="core/RESTORE-INPUT.html">RESTORE-INPUT</a> undefined, rather than to create a
    useless implementation. In the absence of the words, the
    application programmer could choose whether or not to create
    &quot;dummy&quot; implementations or to work-around the problem in
    some other way.
    <p />
    Examples of how an implementation might use the return values
    from <strong>SAVE-INPUT</strong> to accomplish the save/restore function:
    <p />
    <div class="center">

      <table class="center">
      <tr valign="top"><td colspan="5"><hr /></td></tr>
      <tr valign="top"><td>Input Source </td><td colspan="4">possible stack values </td></tr>
      <tr valign="top"><td colspan="5"><hr /></td></tr>
      <tr valign="top"><td>block			</td><td><a href="core/toIN.html">&gt;IN</a> <a href="core/Fetch.html">@</a> </td><td><a href="block/BLK.html">BLK</a> <a href="core/Fetch.html">@</a> </td><td><code>2</code> </td></tr>
      <tr valign="top"><td><a href="core/EVALUATE.html">EVALUATE</a>	</td><td><a href="core/toIN.html">&gt;IN</a> <a href="core/Fetch.html">@</a> </td><td><code>1</code> </td></tr>
      <tr valign="top"><td>keyboard		</td><td><a href="core/toIN.html">&gt;IN</a> <a href="core/Fetch.html">@</a> </td><td><code>1</code> </td></tr>
      <tr valign="top"><td>text file		</td><td><a href="core/toIN.html">&gt;IN</a> <a href="core/Fetch.html">@</a> </td><td><code>lo-pos</code> </td><td><code>hi-pos</code> </td><td><code>3</code> </td></tr>
      <tr valign="top"><td colspan="5"><hr /></td></tr>
      <tr valign="top"><td></td></tr>
      </table>
      
      </div>
    <p />
    These are examples only; a Standard Program may not assume any
    particular meaning for the individual stack items returned by
    <strong>SAVE-INPUT</strong>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:TO">
  <div class="wordNumber">A.6.2.2295</div>
  <div class="wordName">TO</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use: <code>x</code> <strong>TO</strong> <em>name</em>
    <p />
    Some implementations of <strong>TO</strong> do not parse; instead they set
    a mode flag that is tested by the subsequent execution of
    <em>name</em>.  Standard programs must use <strong>TO</strong> as if it
    parses.  Therefore <strong>TO</strong> and <em>name</em> must be
    contiguous and on the same line in the source text.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:TRUE">
  <div class="wordNumber">A.6.2.2298</div>
  <div class="wordName">TRUE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>TRUE</strong> is equivalent to the phrase
    <code>0</code> <a href="core/ZeroEqual.html">0=</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:VALUE">
  <div class="wordNumber">A.6.2.2405</div>
  <div class="wordName">VALUE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">
      <div class="tt">
0 <strong>VALUE</strong> data
        <p />
        <a href="core/Colon.html">:</a> EXCHANGE <a href="core/p.html">(</a> n1 -- n2 )
        data <a href="core/SWAP.html">SWAP</a> <a href="core/TO.html">TO</a> data
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    <code>EXCHANGE</code> leaves <em>n<sub>1</sub></em> in <code>data</code> and
    returns the prior value <em>n<sub>2</sub></em>.
    
    </div>
  </div>

<div class="wordHead" id="rat:core:WITHIN">
  <div class="wordNumber">A.6.2.2440</div>
  <div class="wordName">WITHIN</div>
</div>
<div class="wordBody">
  <div class="rationale">

    We describe <strong>WITHIN</strong> without mentioning circular number
    spaces (an undefined term) or providing the code. Here is a
    number line with the overflow point (<em>o</em>) at the far right and
    the underflow point (<em>u</em>) at the far left:
    <div class="center">

      <em>u</em>---------------<em>o</em>
      
      </div>
    There are two cases to consider: either the
    <em>n<sub>2</sub> | u<sub>2</sub>... n<sub>3</sub> | u<sub>3</sub></em> range straddles the overflow/underflow
    points or it does not. Lets examine the non-straddle case
    first:
    <div class="center">

      <em>u</em>-----[.....)-----<em>o</em>
      
      </div>
    The [ denotes <em>n<sub>2</sub> | u<sub>2</sub></em>, the ) denotes <em>n<sub>3</sub> | u<sub>3</sub></em>,
    and the dots and [ are numbers <strong>WITHIN</strong> the range.
    <em>n<sub>3</sub> | u<sub>3</sub></em> is greater than <em>n<sub>2</sub> | u<sub>2</sub></em>, so the
    following tests will determine if <em>n<sub>1</sub> | u<sub>1</sub></em> is
    <strong>WITHIN</strong> <em>n<sub>2</sub> | u<sub>2</sub></em> and <em>n<sub>3</sub> | u<sub>3</sub></em>:
    <div class="center">

      <em>n<sub>2</sub> | u<sub>2</sub></em> <em>&lt;=</em> <em>n<sub>1</sub> | u<sub>1</sub></em> and <em>n<sub>1</sub> | u<sub>1</sub></em> &lt; <em>n<sub>3</sub> | u<sub>3</sub></em>.
      
      </div>
    In the case where the comparison range straddles the
    overflow/underflow points:
    <div class="center">

      <em>u</em>.....)-----[.....<em>o</em>
      
      </div>
    <em>n<sub>3</sub> | u<sub>3</sub></em> is less than <em>n<sub>2</sub> | u<sub>2</sub></em> and the following
    tests will determine if <em>n<sub>1</sub> | u<sub>1</sub></em> is <strong>WITHIN</strong>
    <em>n<sub>2</sub> | u<sub>2</sub></em> and <em>n<sub>3</sub> | u<sub>3</sub></em>:
    <div class="center">

      <em>n<sub>2</sub> | u<sub>2</sub></em> <em>&lt;=</em> <em>n<sub>1</sub> | u<sub>1</sub></em> or <em>n<sub>1</sub> | u<sub>1</sub></em> &lt; <em>n<sub>3</sub> | u<sub>3</sub></em>.
      
      </div>
    <strong>WITHIN</strong> must work for both signed and unsigned arguments.
    One obvious implementation does not work:
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> <strong>WITHIN</strong> <a href="core/p.html">(</a> test low high -- flag ) <br />
        &nbsp;&nbsp; <a href="core/toR.html">&gt;R</a> <a href="core/OVER.html">OVER</a> <a href="core/less.html">&lt;</a> <a href="core/ZeroEqual.html">0=</a> <a href="core/p.html">(</a> test flag1 )
        <a href="core/SWAP.html">SWAP</a> <a href="core/Rfrom.html">R&gt;</a> <a href="core/less.html">&lt;</a> <a href="core/p.html">(</a> flag1 flag2 )
        <a href="core/AND.html">AND</a> <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    Assume two's-complement arithmetic on a 16-bit machine, and
    consider the following test:
    <p />
    &nbsp;&nbsp; <code>33000   32000   34000   WITHIN</code>
    <p />
    The above implementation returns <em>false</em> for that test,
    even though the unsigned number 33000 is clearly within the
    range {{32000 ... 34000}}.
    <p />
    The problem is that, in the incorrect implementation, the
    signed comparison <a href="core/less.html">&lt;</a> gives the wrong answer when 32000
    is compared to 33000, because when those numbers are treated
    as signed numbers, 33000 is treated as negative 32536, while
    32000 remains positive.
    <p />
    Replacing <a href="core/less.html">&lt;</a> with <a href="core/Uless.html">U&lt;</a> in the above implementation
    makes it work with unsigned numbers, but causes problems with
    certain signed number ranges; in particular, the test:
        <div class="quote">
      <div class="tt">
1   -5   5   WITHIN
        
        </div>
      </div>
    would give an incorrect answer.
    <p />
    For two's-complement machines that ignore arithmetic overflow
    (most machines), the following implementation works in all
    cases:
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> <strong>WITHIN</strong> <a href="core/p.html">(</a> test low high -- flag )	 
        <a href="core/OVER.html">OVER</a> <a href="core/Minus.html">-</a> <a href="core/toR.html">&gt;R</a> <a href="core/Minus.html">-</a> <a href="core/Rfrom.html">R&gt;</a> <a href="core/Uless.html">U&lt;</a>  
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:[COMPILE]">
  <div class="wordNumber">A.6.2.2530</div>
  <div class="wordName">[COMPILE]</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>name2</code> ...
    <strong>[COMPILE]</strong> <code>name1</code>
    ... <a href="core/Semi.html">;</a>   <a href="core/IMMEDIATE.html">IMMEDIATE</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:core:bs">
  <div class="wordNumber">A.6.2.2535</div>
  <div class="wordName">\</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">
      <div class="tt">
5 <a href="core/CONSTANT.html">CONSTANT</a> THAT
          <strong>\</strong>   <span class="rm">This is a comment about THAT</span>
        
        </div>
      </div>
    
    </div>
  </div>
<p />
<h2 id="section.A.9">A.9 The optional Block word set</h2> <!-- A.7 ========================= -->

<a name="rat:block"></a>
<p />
Early Forth systems ran without a host OS; these are known as native
systems.  Such systems provide mass storage in blocks of 1024 bytes.
The Block Word set includes the most common words for accessing
program source and data on disk.
<p />

<h3 id="subsection.A.9.2">A.9.2 Additional terms</h3> <!-- A.7.2 =============================== -->
<a name="rat:block:terms"></a>
<p />
<dl class="desc">
<dt>block</dt><dd>  
Forth systems may use blocks to contain program source.
Conventionally such blocks are formatted for editing as
16 lines of 64 characters. Source blocks are often referred
to as &quot;screens&quot;.
</dd></dl>
<br class="clear" />

<p />
<h3 id="subsection.A.9.3">A.9.3 Additional usage requirements</h3>

<h4 id="subsubsection.A.9.3.2">A.9.3.2 Block buffer regions</h4>
<a name="rat:block:buffers"></a>
<p />
While the standard does not address multitasking per se, the
items listed in <strong><a href="block.html#block:buffers">7.3.2 Block buffer regions</a></strong> that may render block-buffer
addresses invalid are due to multitasking considerations.
The standard restricts programs such that items that could fail on
multitasking systems are not standard usage.  It also permits
multitasking systems to be declared standard systems.
<p />

<h3 id="subsection.A.9.6">A.9.6 Glossary</h3> <!-- A.7.6 ============================= -->

<div class="wordHead" id="rat:block:SCR">
  <div class="wordNumber">A.7.6.2.2190</div>
  <div class="wordName">SCR</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>SCR</strong> is short for screen.
    
    </div>
  </div>
<p />
<h2 id="section.A.11">A.11 The optional Double-Number word set</h2> <!-- A.8 ================= -->

<a name="rat:double"></a>
<p />
Forth systems on 8-bit and 16-bit processors often find it necessary
to deal with double-length numbers. But many Forths on small embedded
systems do not, and many users of Forth on systems with a cell size of
32-bits or more find that the necessity for double-length numbers is
much diminished. Therefore, we have factored the words that manipulate
double-length entities into this optional word set.
<p />
Please note that the naming convention used in this word set conveys
some important information:
<p />
<ol style="list-style-type: lower-alpha">
<li>
Words whose names are of the form <code>2</code><em>xxx</em> deal
with cell pairs, where the relationship between the cells is
unspecified. They may be two-vectors, double-length numbers, or
any pair of cells that it is convenient to manipulate together.
<p />
</li>
<li>
Words with names of the form <code>D</code><em>xxx</em> deal
specifically with double-length integers.
<p />
</li>
<li>
Words with names of the form <code>M</code><em>xxx</em> deal with
some combination of single and double integers. The order in
which these appear on the stack is determined by long-standing
common practice.
</li>
</ol>
<p />
Refer to <a href="rationale.html#rat:types">A.3.1</a> for a discussion of data types in Forth.
<p />

<h3 id="subsection.A.11.6">A.11.6 Glossary</h3> <!-- A.8.6 ============================= -->

<div class="wordHead" id="rat:double:2CONSTANT">
  <div class="wordNumber">A.8.6.1.0360</div>
  <div class="wordName">2CONSTANT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <code>x1</code> <code>x2</code> <strong>2CONSTANT</strong> <em>name</em>
    
    </div>
  </div>

<div class="wordHead" id="rat:double:2LITERAL">
  <div class="wordNumber">A.8.6.1.0390</div>
  <div class="wordName">2LITERAL</div>
</div>
<div class="wordBody">
  <div class="rationale">

    
    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <a href="core/Bracket.html">[</a> <code>x1</code> <code>x2</code> <a href="right-bracket.html">]</a> <a href="double/TwoLITERAL.html">2LITERAL</a>
    ... <a href="core/Semi.html">;</a>
    
    
    </div>
  </div>

<div class="wordHead" id="rat:double:2VARIABLE">
  <div class="wordNumber">A.8.6.1.0440</div>
  <div class="wordName">2VARIABLE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <strong>2VARIABLE</strong> <em>name</em>
    
    </div>
  </div>

<div class="wordHead" id="rat:double:D.R">
  <div class="wordNumber">A.8.6.1.1070</div>
  <div class="wordName">D.R</div>
</div>
<div class="wordBody">
  <div class="rationale">

    In <strong>D.R</strong>, the &quot;R&quot; is short for RIGHT.
    
    </div>
  </div>

<div class="wordHead" id="rat:double:DtoS">
  <div class="wordNumber">A.8.6.1.1140</div>
  <div class="wordName">D&gt;S</div>
</div>
<div class="wordBody">
  <div class="rationale">

    There exist number representations, e.g., the sign-magnitude
    representation, where reduction from double- to single-precision
    cannot simply be done with <a href="core/DROP.html">DROP</a>. This word,
    equivalent to <a href="core/DROP.html">DROP</a> on two's complement systems,
    desensitizes application code to number representation and
    facilitates portability.
    
    </div>
  </div>

<div class="wordHead" id="rat:double:M*/">
  <div class="wordNumber">A.8.6.1.1820</div>
  <div class="wordName">M*/</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>M*/</strong> was once described by Chuck Moore as the most
    useful arithmetic operator in Forth. It is the main workhorse
    in most computations involving double-cell numbers. Note that
    some systems allow signed divisors. This can cost a lot in
    performance on some CPUs. The requirement for a positive
    divisor has not proven to be a problem.
    
    </div>
  </div>

<div class="wordHead" id="rat:double:M+">
  <div class="wordNumber">A.8.6.1.1830</div>
  <div class="wordName">M+</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>M+</strong> is the classical method for integrating.
    
    </div>
  </div>

<div class="wordHead" id="rat:double:2VALUE">
  <div class="wordNumber">A.8.6.2.0435</div>
  <div class="wordName">2VALUE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> fn1 <a href="core/Sq.html">S&quot;</a> filename&quot; <a href="core/Semi.html">;</a> <br />
        fn1 <strong>2VALUE</strong> myfile <br />
        myfile <a href="file/INCLUDED.html">INCLUDED</a> <br />
        
        <a href="core/Colon.html">:</a> fn2 <a href="core/Sq.html">S&quot;</a> filename2&quot; <a href="core/Semi.html">;</a> <br />
        fn2 <a href="core/TO.html">TO</a> myfile <br />
        myfile <a href="file/INCLUDED.html">INCLUDED</a>
        
        </div>
      </div>
    
    </div>
  </div>
<p />
<h2 id="section.A.13">A.13 The optional Exception word set</h2> <!-- A.9 ===================== -->

<a name="rat:exception"></a>
<p />
<a href="exception/CATCH.html">CATCH</a> and <a href="exception/THROW.html">THROW</a> provide a reliable mechanism for
handling exceptions, without having to propagate exception flags
through multiple levels of word nesting. It is similar in spirit
to the &quot;non-local return&quot; mechanisms of many other languages,
such as C's <code>setjmp()</code> and <code>longjmp()</code>, and LISP's
<code>CATCH</code> and <code>THROW</code>. In the Forth context, <a href="exception/THROW.html">THROW</a>
may be described as a &quot;multi-level <a href="core/EXIT.html">EXIT</a>&quot;, with
<a href="exception/CATCH.html">CATCH</a> marking a location to which a <a href="exception/THROW.html">THROW</a> may return.
<p />
Several similar Forth &quot;multi-level <a href="core/EXIT.html">EXIT</a>&quot;
exception-handling schemes have been described and used in past years.
It is not possible to implement such a scheme using only standard words
(other than <a href="exception/CATCH.html">CATCH</a> and <a href="exception/THROW.html">THROW</a>), because there is no portable
way to &quot;unwind&quot; the return stack to a predetermined place.
<p />
<a href="exception/THROW.html">THROW</a> also provides a convenient implementation technique for
the standard words <a href="exception/ABORT.html">ABORT</a> and <a href="exception/ABORTq.html">ABORT&quot;</a>, allowing an
application to define, through the use of <a href="exception/CATCH.html">CATCH</a>, the behavior
in the event of a system <a href="exception/ABORT.html">ABORT</a>.
<p />
<a href="exception/CATCH.html">CATCH</a> and <a href="exception/THROW.html">THROW</a> provide a convenient way for an
implementation to &quot;clean up&quot; the state of open files if an
exception occurs during the text interpretation of a file with
<a href="file/INCLUDE-FILE.html">INCLUDE-FILE</a>. The implementation of
<a href="file/INCLUDE-FILE.html">INCLUDE-FILE</a> may guard (with <a href="exception/CATCH.html">CATCH</a>) the word
that performs the text interpretation, and if <a href="exception/CATCH.html">CATCH</a> returns
an exception code, the file may be closed and the exception
re<a href="exception/THROW.html">THROW</a>n so that the files being included at an outer nesting
level may be closed also. Note that the standard allows, but does not
require, <a href="file/INCLUDE-FILE.html">INCLUDE-FILE</a> to close its open files if an
exception occurs. However, it does require <a href="file/INCLUDE-FILE.html">INCLUDE-FILE</a>
to unnest the input source specification if an exception is
<a href="exception/THROW.html">THROW</a>n.
<p />

<h3 id="subsection.A.13.3">A.13.3 Additional usage requirements</h3> <!-- A.9.3 ======== -->
One important use of an exception handler is to maintain program
control under many conditions which <a href="exception/ABORT.html">ABORT</a>.  This is practicable
only if a range of codes is reserved.  Note that an application may
overload many standard words in such a way as to <a href="exception/THROW.html">THROW</a>
ambiguous conditions not normally <a href="exception/THROW.html">THROW</a>n by a particular
system.
<p />

<h4 id="subsubsection.A.13.3.6">A.13.3.6 Exception handling</h4> <!-- A.9.3.6 ============== -->
The method of accomplishing this coupling is implementation dependent.
For example, <a href="block/LOAD.html">LOAD</a> could &quot;know&quot; about <a href="exception/CATCH.html">CATCH</a> and
<a href="exception/THROW.html">THROW</a> (by using <a href="exception/CATCH.html">CATCH</a> itself, for example), or
<a href="exception/CATCH.html">CATCH</a> and <a href="exception/THROW.html">THROW</a> could &quot;know&quot; about <a href="block/LOAD.html">LOAD</a>
(by maintaining input source nesting information in a data structure
known to <a href="exception/THROW.html">THROW</a>, for example). Under these circumstances it is
not possible for a Standard Program to define words such as
<a href="block/LOAD.html">LOAD</a> in a completely portable way.
<p />

<h3 id="subsection.A.13.6">A.13.6 Glossary</h3> <!-- A.9.6 ============================= -->

<div class="wordHead" id="rat:exception:THROW">
  <div class="wordNumber">A.9.6.1.2275</div>
  <div class="wordName">THROW</div>
</div>
<div class="wordBody">
  <div class="rationale">

    If <strong>THROW</strong> is executed with a non zero argument, the effect
    is as if the corresponding <a href="exception/CATCH.html">CATCH</a> had returned it. In that
    case, the stack depth is the same as it was just before <a href="exception/CATCH.html">CATCH</a>
    began execution. The values of the <em>i * x</em> stack arguments could
    have been modified arbitrarily during the execution of <em>xt</em>.
    In general, nothing useful may be done with those stack items, but
    since their number is known (because the stack depth is deterministic),
    the application may <a href="core/DROP.html">DROP</a> them to return to a predictable
    stack state.
    <p />
    Typical use:
    
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> could-fail <a href="core/p.html">(</a> -- char ) <br />
        &nbsp;&nbsp; <a href="core/KEY.html">KEY</a> <a href="core/DUP.html">DUP</a> <a href="core/BracketCHAR.html">[CHAR]</a> Q <a href="core/Equal.html">=</a> 
        <a href="core/IF.html">IF</a>  1 <a href="exception/THROW.html">THROW</a>
        <a href="core/THEN.html">THEN</a>
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> do-it <a href="core/p.html">(</a> a b -- c)  
        <a href="core/TwoDROP.html">2DROP</a> could-fail <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Colon.html">:</a> try-it <a href="core/p.html">(</a> --) <br />
        &nbsp;&nbsp; 1 2 <a href="core/BracketTick.html">[']</a> do-it  <a href="exception/CATCH.html">CATCH</a>  <a href="core/IF.html">IF</a> <br />
        &nbsp;&nbsp;   <a href="core/p.html">(</a> x1 x2 ) <a href="core/TwoDROP.html">2DROP</a>
        <a href="core/Dotq.html">.&quot;</a>  There was an exception&quot; <a href="core/CR.html">CR</a> <br />
        &nbsp;&nbsp; <a href="core/ELSE.html">ELSE</a>
        <a href="core/Dotq.html">.&quot;</a> The character was &quot; <a href="core/EMIT.html">EMIT</a> <a href="core/CR.html">CR</a> <br />
        &nbsp;&nbsp; <a href="core/THEN.html">THEN</a> <br />
        <a href="core/Semi.html">;</a>
        <p />
        <a href="core/Semi.html">;</a> retry-it <a href="core/p.html">(</a> -- ) <br />
        &nbsp;&nbsp; <a href="core/BEGIN.html">BEGIN</a>  1 2 <a href="core/BracketTick.html">[']</a> do-it <a href="exception/CATCH.html">CATCH</a> 
        <a href="core/WHILE.html">WHILE</a> <br />
        &nbsp;&nbsp;   <a href="core/p.html">(</a> x1 x2) <a href="core/TwoDROP.html">2DROP</a>
        <a href="core/Dotq.html">.&quot;</a> Exception, keep trying&quot; <a href="core/CR.html">CR</a> <br />
        &nbsp;&nbsp; <a href="core/REPEAT.html">REPEAT</a> <a href="core/p.html">(</a> char ) <br />
        &nbsp;&nbsp; <a href="core/Dotq.html">.&quot;</a> The character was &quot; <a href="core/EMIT.html">EMIT</a> <a href="core/CR.html">CR</a> <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    
    
    </div>
  </div>
<p />
<h2 id="section.A.15">A.15 The optional Facility word set</h2> <!-- A.10 ===================== -->

<a name="rat:facility"></a>
<p />

<h3 id="subsection.A.15.6">A.15.6 Glossary</h3> <!-- A.10.6 ============================ -->

<div class="wordHead" id="rat:facility:KEYq">
  <div class="wordNumber">A.10.6.1.1755</div>
  <div class="wordName">KEY?</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The committee has gone around several times on the
    stack effects. Whatever is decided will violate somebody's
    practice and penalize some machine. This way doesn't interfere
    with type-ahead on some systems, while requiring the
    implementation of a single-character buffer on machines where
    polling the keyboard inevitably results in the destruction of
    the character.
    <p />
    Use of <a href="core/KEY.html">KEY</a> or <strong>KEY?</strong> indicates that the
    application does not wish to process non-character events,
    so they are discarded, in anticipation of eventually receiving
    a valid character. Applications wishing to handle non-character
    events must use <a href="facility/EKEY.html">EKEY</a> and <a href="facility/EKEYq.html">EKEY?</a>. It is possible
    to mix uses of <strong>KEY?</strong>/<a href="core/KEY.html">KEY</a> and
    <a href="facility/EKEYq.html">EKEY?</a>/<a href="facility/EKEY.html">EKEY</a> within a single application, but
    the application must use <strong>KEY?</strong> and <a href="core/KEY.html">KEY</a> only
    when it wishes to discard non-character events until a valid
    character is received.
    
    </div>
  </div>

<div class="wordHead" id="rat:facility:+FIELD">
  <div class="wordNumber">A.10.6.2.0135</div>
  <div class="wordName">+FIELD</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>+FIELD</strong> is not required to align items.  This is
    deliberate and allows the construction of unaligned data
    structures for communication with external elements such
    as a hardware register map or protocol packet.
    Field alignment has been left to the appropriate
    <em>x</em><code>FIELD:</code> definition.
    
    </div>
  </div>

<div class="wordHead" id="rat:facility:BEGIN-STRUCTURE">
  <div class="wordNumber">A.10.6.2.0763</div>
  <div class="wordName">BEGIN-STRUCTURE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    There are two schools of thought regarding named data
    structures: name first and name last.  The name last
    school can define a named data structure as follows:
    <p />
        <div class="quote">
      <div class="tt">
0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> initial total byte count <br />
        &nbsp;&nbsp; 1 <a href="core/CELLS.html">CELLS</a> <a href="facility/PlusFIELD.html">+FIELD</a> p.x	&nbsp;&nbsp; <a href="core/bs.html">\</a> A single cell filed named p.x <br />
        &nbsp;&nbsp; 1 <a href="core/CELLS.html">CELLS</a> <a href="facility/PlusFIELD.html">+FIELD</a> p.y   &nbsp;&nbsp; <a href="core/bs.html">\</a> A single cell field named p.y <br />
        <a href="core/CONSTANT.html">CONSTANT</a> point &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> save structure size
        
        </div>
      </div>
    <p />
    While the name first school would define the same data
    structure as:
    <p />
        <div class="quote">
      <div class="tt">
<strong>BEGIN-STRUCTURE</strong> point  <a href="core/bs.html">\</a> create the named structure <br />
        &nbsp;&nbsp; 1 <a href="core/CELLS.html">CELLS</a> <a href="facility/PlusFIELD.html">+FIELD</a> p.x	&nbsp;&nbsp; <a href="core/bs.html">\</a> A single cell filed named p.x <br />
        &nbsp;&nbsp; 1 <a href="core/CELLS.html">CELLS</a> <a href="facility/PlusFIELD.html">+FIELD</a> p.y   &nbsp;&nbsp; <a href="core/bs.html">\</a> A single cell field named p.y <br />
        <a href="facility/END-STRUCTURE.html">END-STRUCTURE</a>
        
        </div>
      </div>
    <p />
    Although many systems provide a name first structure there
    is no common practice to the words used.  The words
    <strong>BEGIN-STRUCTURE</strong> and <a href="facility/END-STRUCTURE.html">END-STRUCTURE</a> have been
    defied as a means of providing a portable notation that does
    not conflict with existing systems.
    <p />
    The field defining words (<em>x</em><code>FIELD:</code> and
    <a href="facility/PlusFIELD.html">+FIELD</a>) are defined so they can be used by both
    schools.  Compatibility between the two schools comes from
    defining a new stack item <em>struct-sys</em>, which is
    implementation dependent and can be 0 or more cells.
    The name first school would provide an address (<em>addr</em>)
    as the <em>struct-sys</em> parameter, while the name last
    school would defined <em>struct-sys</em> as being empty.
    <p />
    Executing the name of the data structure, returns the size of
    the data structure.  This allows the data stricture to be used
    within another data structure:
    <p />
        <div class="quote">
      <div class="tt">
<strong>BEGIN-STRUCTURE</strong> point  <a href="core/bs.html">\</a> -- a-addr 0 ; -- lenp <br />
        &nbsp;&nbsp; <a href="facility/FIELDColon.html">FIELD:</a> p.x		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> -- a-addr cell <br />
        &nbsp;&nbsp; <a href="facility/FIELDColon.html">FIELD:</a> p.y      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/bs.html">\</a> -- a-addr cell*2 <br />
        <a href="facility/END-STRUCTURE.html">END-STRUCTURE</a> <br />
        <strong>BEGIN-STRUCTURE</strong> rect  &nbsp;&nbsp;&nbsp;<a href="core/bs.html">\</a> -- a-addr 0 ; -- lenr <br />
        &nbsp;&nbsp; point <a href="facility/PlusFIELD.html">+FIELD</a> r.tlhc   &nbsp;&nbsp; <a href="core/bs.html">\</a> -- a-addr cell*2 <br />
        &nbsp;&nbsp; point <a href="facility/PlusFIELD.html">+FIELD</a> r.brhc   &nbsp;&nbsp; <a href="core/bs.html">\</a> -- a-addr cell*4 <br />
        <a href="facility/END-STRUCTURE.html">END-STRUCTURE</a>
        
        </div>
      </div>
    <p />
    
    </div>
  </div>
<div class="secdef">

  <div class="secname">Alignment:</div>
  <div class="sec">

  In practice, structures are used for two different purposes
    with incompatible requirements:
    <ol style="list-style-type: decimal">
    <li> For collecting related internal-use data into a
    convenient &quot;package&quot; that can be referred to by a
    single &quot;handle&quot;. For this use, alignment is important,
    so that efficient native fetch and store instructions
    can be used.
    <p />
    </li>
    <li> For mapping external data structures like hardware
    register maps and protocol packets. For this use,
    automatic alignment is inappropriate, because the
    alignment of the external data structure often doesn't
    match the rules for a given processor.
    </li>
</ol>
    <p />
    Many languages cater for the first use, but ignore the
    second.  This leads to various customized solutions, usage
    requirements, portability problems, bugs, etc.
    <a href="facility/PlusFIELD.html">+FIELD</a> is defined to be non-aligning, while the
    named field defining words (<em>x</em><code>FIELD:</code>) are
    aligning.  This is intentional and allows for both uses.
    <p />
    The standard currently defines an aligned field defining
    word for each of the standard data types:
    <p />
    <div class="center">

      <table class="center">
      <tr valign="top"><td class="r"><a href="facility/CFIELDColon.html">CFIELD:</a>					</td><td>a character </td></tr>
      <tr valign="top"><td class="r"><a href="facility/FIELDColon.html">FIELD:</a>					</td><td>a native integer (single cell) </td></tr>
      <tr valign="top"><td class="r"><a href="floating/FFIELDColon.html">FFIELD:</a>	</td><td>a native float </td></tr>
      <tr valign="top"><td class="r"><a href="floating/SFFIELDColon.html">SFFIELD:</a>	</td><td>a 32 bit float </td></tr>
      <tr valign="top"><td class="r"><a href="floating/DFFIELDColon.html">DFFIELD:</a>	</td><td>a 64 bit float
      </table>
      
      </div>
    <p />
    Although this is a sufficient set, most systems provide
    facilities to define field defining words for standard
    data types.
    
    </div>
  </div>
<div class="secdef">

  <div class="secname">Future:</div>
  <div class="sec">

  The following cannot be defined until the required addressing
    has been defined. The names should be considered reserved
    until then.
    <p />
    <div class="center">

      <table class="center">
      <tr valign="top"><td class="r"><code>BFIELD:</code> </td><td>1 byte (8 bit) field </td></tr>
      <tr valign="top"><td class="r"><code>WFIELD:</code> </td><td>16 bit field </td></tr>
      <tr valign="top"><td class="r"><code>LFIELD:</code> </td><td>32 bit field </td></tr>
      <tr valign="top"><td class="r"><code>XFIELD:</code> </td><td>64 bit field </td></tr>
      <tr valign="top"><td class="r"></td></tr>
      </table>
      
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:facility:EKEY">
  <div class="wordNumber">A.10.6.2.1305</div>
  <div class="wordName">EKEY</div>
</div>
<div class="wordBody">
  <div class="rationale">

    For some input devices, such as keyboards, more information is
    available than can be returned by a single execution of
    <a href="core/KEY.html">KEY</a>.  <strong>EKEY</strong> provides a standard word to access a
    system-dependent set of events.
    <p />
    <strong>EKEY</strong> and <a href="facility/EKEYq.html">EKEY?</a> are implementation specific; no
    assumption can be made regarding the interaction between the
    pairs <strong>EKEY</strong>/<a href="facility/EKEYq.html">EKEY?</a> and <a href="core/KEY.html">KEY</a>/<a href="facility/KEYq.html">KEY?</a>.
    This standard does not define a timing relationship between
    <a href="facility/KEYq.html">KEY?</a> and <a href="facility/EKEYq.html">EKEY?</a>.  Undefined results may be
    avoided by using only one pairing of <a href="core/KEY.html">KEY</a>/ <a href="facility/KEYq.html">KEY?</a>
    or <strong>EKEY</strong>/<a href="facility/EKEYq.html">EKEY?</a> in a program for each input
    stream.
    <p />
    <strong>EKEY</strong> assumes no particular numerical correspondence
    between particular event code values and the values
    representing standard characters.  On some systems, this may
    allow two separate keys that correspond to the same standard
    character to be distinguished from one another.  A standard
    program may only interpret the results of <strong>EKEY</strong> via the
    translation words provided for that purpose
    (<a href="facility/EKEYtoCHAR.html">EKEY&gt;CHAR</a> and <a href="facility/EKEYtoFKEY.html">EKEY&gt;FKEY</a>).
    <p />
    See: <a href="rationale.html#rat:core:KEY">A.6.1.1750 KEY</a>, <a href="facility/EKEYtoCHAR.html">10.6.2.1306 EKEY&gt;CHAR</a> and
    <a href="facility/EKEYtoFKEY.html">10.6.2.1306.40 EKEY&gt;FKEY</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:facility:EKEYtoCHAR">
  <div class="wordNumber">A.10.6.2.1306</div>
  <div class="wordName">EKEY&gt;CHAR</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>EKEY&gt;CHAR</strong> translates a keyboard event into the
    corresponding member of the character set, if such a
    correspondence exists for that event.
    <p />
    It is possible that several different keyboard events may
    correspond to the same character, and other keyboard events
    may correspond to no character.
    
    </div>
  </div>

<div class="wordHead" id="rat:facility:EKEYtoFKEY">
  <div class="wordNumber">A.10.6.2.1306.40</div>
  <div class="wordName">EKEY&gt;FKEY</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <a href="facility/EKEY.html">EKEY</a> produces an abstract cell type for a keyboard
    event (e.g., a keyboard scan code).  <strong>EKEY&gt;FKEY</strong> checks
    if such an event corresponds to a special (non-graphic) key
    press, and if so, returns a code for the special key press.
    The encoding of special keys (returned by <strong>EKEY&gt;FKEY</strong>)
    may be different from the encoding of these keys as keyboard
    events (input to <strong>EKEY&gt;FKEY</strong>).
    <p />
    Typical Use:
    <p />
        <div class="quote">

      ... <a href="facility/EKEY.html">EKEY</a> <strong>EKEY&gt;FKEY</strong> <a href="core/IF.html">IF</a> <br />
      &nbsp;&nbsp; <a href="core/CASE.html">CASE</a> <br />
      &nbsp;&nbsp;&nbsp;&nbsp; <a href="facility/K-UP.html">K-UP</a> <a href="core/OF.html">OF</a> ... <a href="core/ENDOF.html">ENDOF</a> <br />
      &nbsp;&nbsp;&nbsp;&nbsp; <a href="facility/K-FOne.html">K-F1</a> <a href="core/OF.html">OF</a> ... <a href="core/ENDOF.html">ENDOF</a> <br />
      &nbsp;&nbsp;&nbsp;&nbsp; <a href="facility/K-LEFT.html">K-LEFT</a> <a href="facility/K-SHIFT-MASK.html">K-SHIFT-MASK</a> <a href="core/OR.html">OR</a>
      <a href="facility/K-CTRL-MASK.html">K-CTRL-MASK</a> <a href="core/OR.html">OR</a>
      <a href="core/OF.html">OF</a> ... <a href="core/ENDOF.html">ENDOF</a> <br />
      &nbsp;&nbsp;&nbsp;&nbsp; ... <br />
      &nbsp;&nbsp; <a href="core/ENDCASE.html">ENDCASE</a> <br />
      <a href="core/ELSE.html">ELSE</a> <br />
      &nbsp;&nbsp; ... <br />
      <a href="core/THEN.html">THEN</a>
      
      </div>
    <p />
    The codes for the special keys are system-dependent, but this
    standard provides words for getting the key codes for a number
    of keys:
    <p />
    <div class="center">

      <table class="center">
      <tr valign="top"><td colspan="5"><hr /></td></tr>
      <tr valign="top"><td>Word </td><td>Key </td><td class="c">&nbsp;&nbsp;&nbsp;&nbsp; </td><td>Word </td><td>Key </td></tr>
      <tr valign="top"><td colspan="5"><hr /></td></tr>
      <tr valign="top"><td><a href="facility/K-FOne.html">K-F1</a>		</td><td>F1	</td><td class="c"></td><td><a href="facility/K-LEFT.html">K-LEFT</a>	</td><td>cursor left	</td></tr>
      <tr valign="top"><td><a href="facility/K-FTwo.html">K-F2</a>		</td><td>F2	</td><td class="c"></td><td><a href="facility/K-RIGHT.html">K-RIGHT</a>	</td><td>cursor right	</td></tr>
      <tr valign="top"><td><a href="facility/K-F3.html">K-F3</a>		</td><td>F3	</td><td class="c"></td><td><a href="facility/K-UP.html">K-UP</a>		</td><td>cursor up		</td></tr>
      <tr valign="top"><td><a href="facility/K-F4.html">K-F4</a>		</td><td>F4	</td><td class="c"></td><td><a href="facility/K-DOWN.html">K-DOWN</a>	</td><td>cursor down	</td></tr>
      <tr valign="top"><td><a href="facility/K-F5.html">K-F5</a>		</td><td>F5	</td><td class="c"></td><td><a href="facility/K-HOME.html">K-HOME</a>	</td><td>home or Pos1	</td></tr>
      <tr valign="top"><td><a href="facility/K-F6.html">K-F6</a>		</td><td>F6	</td><td class="c"></td><td><a href="facility/K-END.html">K-END</a>	</td><td>End			</td></tr>
      <tr valign="top"><td><a href="facility/K-F7.html">K-F7</a>		</td><td>F7	</td><td class="c"></td><td><a href="facility/K-PRIOR.html">K-PRIOR</a>	</td><td>PgUp or Prior	</td></tr>
      <tr valign="top"><td><a href="facility/K-F8.html">K-F8</a>		</td><td>F8	</td><td class="c"></td><td><a href="facility/K-NEXT.html">K-NEXT</a>	</td><td>PgDn or Next	</td></tr>
      <tr valign="top"><td><a href="facility/K-F9.html">K-F9</a>		</td><td>F9	</td><td class="c"></td><td><a href="facility/K-INSERT.html">K-INSERT</a>	</td><td>Insert		</td></tr>
      <tr valign="top"><td><a href="facility/K-FOneZero.html">K-F10</a>	</td><td>F10	</td><td class="c"></td><td><a href="facility/K-DELETE.html">K-DELETE</a>	</td><td>Delete		</td></tr>
      <tr valign="top"><td><a href="facility/K-FOneOne.html">K-F11</a>	</td><td>F11	</td></tr>
      <tr valign="top"><td><a href="facility/K-FOneTwo.html">K-F12</a>	</td><td>F12	</td></tr>
      <tr valign="top"><td colspan="5"><hr /></td></tr>
      <tr valign="top"><td></td></tr>
      </table>
      
      </div>
    <p />
    In addition, you can get codes for shifted variants of these
    keys by <a href="core/OR.html">OR</a>ing with <a href="facility/K-SHIFT-MASK.html">K-SHIFT-MASK</a>, <a href="facility/K-CTRL-MASK.html">K-CTRL-MASK</a>
    and/or <a href="facility/K-ALT-MASK.html">K-ALT-MASK</a>, e.g. <a href="facility/K-CTRL-MASK.html">K-CTRL-MASK</a>
    <a href="facility/K-ALT-MASK.html">K-ALT-MASK</a> <a href="core/OR.html">OR</a> <a href="facility/K-DELETE.html">K-DELETE</a> <a href="core/OR.html">OR</a>.
    The masks for the shift keys are:
    <p />
    <div class="center">

      <table class="center">
      <tr valign="top"><td colspan="2"><hr /></td></tr>
      <tr valign="top"><td>Word 				</td><td>Key	</td></tr>
      <tr valign="top"><td colspan="2"><hr /></td></tr>
      <tr valign="top"><td><a href="facility/K-SHIFT-MASK.html">K-SHIFT-MASK</a>	</td><td>Shift	</td></tr>
      <tr valign="top"><td><a href="facility/K-CTRL-MASK.html">K-CTRL-MASK</a>	</td><td>Ctrl	</td></tr>
      <tr valign="top"><td><a href="facility/K-ALT-MASK.html">K-ALT-MASK</a>	</td><td>Alt	</td></tr>
      <tr valign="top"><td colspan="2"><hr /></td></tr>
      <tr valign="top"><td></td></tr>
      </table>
      
      </div>
    <p />
    Note that not all of these keys are available on all systems, and not
    all combinations of keys and shift keys are available.  Therefore
    programs should be written such that they continue to work (although
    less conveniently or with less functionality) if these key combinations
    cannot be produced.
    
    </div>
  </div>

<div class="wordHead" id="rat:facility:EMITq">
  <div class="wordNumber">A.10.6.2.1325</div>
  <div class="wordName">EMIT?</div>
</div>
<div class="wordBody">
  <div class="rationale">

    An indefinite delay is a device related condition, such as
    printer off-line, that requires operator intervention before
    the device will accept new data.
    
    </div>
  </div>

<div class="wordHead" id="rat:facility:FIELD:">
  <div class="wordNumber">A.10.6.2.1518</div>
  <div class="wordName">FIELD:</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Create an aligned single-cell field in a data structure.
    <p />
    The various <em>x</em><code>FIELD:</code> words provide for different
    alignment and size allocation.
    <p />
    The <em>x</em><code>FIELD:</code> words could be defined as:
    <p />
    <div class="tabbing">
      &nbsp;&nbsp;&nbsp; <a href="core/Colon.html">:</a> <strong>FIELD:</strong>   &nbsp;&nbsp;&nbsp;( n1 &quot;name&quot; -- n2 ; addr1 -- addr2 )&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/ALIGNED.html">ALIGNED</a>    1 <a href="core/CELLS.html">CELLS</a>    <a href="facility/PlusFIELD.html">+FIELD</a> <a href="core/Semi.html">;</a> <br />
      &nbsp;&nbsp;&nbsp; <a href="core/Colon.html">:</a> <a href="facility/CFIELDColon.html">CFIELD:</a>  &nbsp;&nbsp;( n1 &quot;name&quot; -- n2 ; addr1 -- addr2 )&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                   1 <a href="core/CHARS.html">CHARS</a>   &nbsp; <a href="facility/PlusFIELD.html">+FIELD</a> <a href="core/Semi.html">;</a> <br />
      
      &nbsp;&nbsp; <a href="core/Colon.html">:</a> <a href="floating/FFIELDColon.html">FFIELD:</a>  &nbsp;&nbsp;( n1 &quot;name&quot; -- n2 ; addr1 -- addr2 )&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="floating/FALIGNED.html">FALIGNED</a>   1 <a href="floating/FLOATS.html">FLOATS</a>   <a href="facility/PlusFIELD.html">+FIELD</a> <a href="core/Semi.html">;</a> <br />
      &nbsp;&nbsp;&nbsp; <a href="core/Colon.html">:</a> <a href="floating/SFFIELDColon.html">SFFIELD:</a> &nbsp;( n1 &quot;name&quot; -- n2 ; addr1 -- addr2 )&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="floating/SFALIGNED.html">SFALIGNED</a>  1 <a href="floating/SFLOATS.html">SFLOATS</a>  <a href="facility/PlusFIELD.html">+FIELD</a> <a href="core/Semi.html">;</a> <br />
      &nbsp;&nbsp;&nbsp; <a href="core/Colon.html">:</a> <a href="floating/DFFIELDColon.html">DFFIELD:</a> &nbsp;( n1 &quot;name&quot; -- n2 ; addr1 -- addr2 )&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="floating/DFALIGNED.html">DFALIGNED</a>  1 <a href="floating/DFLOATS.html">DFLOATS</a>  <a href="facility/PlusFIELD.html">+FIELD</a> <a href="core/Semi.html">;</a>
      
      <br />
      
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:facility:MS">
  <div class="wordNumber">A.10.6.2.1905</div>
  <div class="wordName">MS</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Although their frequencies vary, every system has a clock.
    Since many programs need to time intervals, this word is
    offered. Use of milliseconds as an internal unit of time is
    a practical &quot;least common denominator&quot; external unit. It
    is assumed implementors will use &quot;clock ticks&quot; (whatever
    size they are) as an internal unit and convert as appropriate.
    
    </div>
  </div>

<div class="wordHead" id="rat:facility:TIMEandDATE">
  <div class="wordNumber">A.10.6.2.2292</div>
  <div class="wordName">TIME&amp;DATE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Most systems have a real-time clock/calendar.
    This word gives portable access to it.
    
    </div>
  </div>
<p />
<h2 id="section.A.17">A.17 The optional File-Access word set</h2> <!-- A.11 ================== -->

<a name="rat:file"></a>
<p />

<h3 id="subsection.A.17.3">A.17.3 Additional usage requirements</h3> <!-- A.11.3 ======= -->

<h4 id="subsubsection.A.17.3.2">A.17.3.2 Blocks in files</h4> <!-- 11.3.2 ================== -->
Many systems reuse file identifiers; when a file is closed, a
subsequently opened file may be given the same identifier. If the
original file has blocks still in block buffers, these will be
incorrectly associated with the newly opened file with disastrous
results. The block buffer system must be flushed to avoid this.
<p />

<h4 id="subsubsection.A.17.3.4">A.17.3.4 Other transient regions</h4>
<a name="rat:file:buffers"></a>
<p />
Additional transient buffers are provided for use by <a href="file/Sq.html">S&quot;</a> and <a href="file/Seq.html">S\&quot;</a>.
The buffers should be able to store two consecutive strings, thus allowing the
command line:
<p />
<div class="quote">

  <code><a href="file/Sq.html">S&quot;</a> name1&quot; <a href="file/Sq.html">S&quot;</a> name2&quot; <a href="file/RENAME-FILE.html">RENAME-FILE</a></code>
  
  </div>
<p />
The buffers may be implemented in a circular arrangement, where a string
is placed into the next available buffer. When there are no buffers available,
the oldest buffer is overwritten.
<p />
<a href="file/Sq.html">S&quot;</a> and <a href="file/Seq.html">S\&quot;</a> may share the same buffers.
<p />
The list of words using memory in transient regions is extended to include
<a href="file/Sq.html">11.6.1.2165 S&quot;</a> and <a href="file/Seq.html">11.6.2.2266 S\&quot;</a>.
See <strong><a href="usage.html#usage:transient">3.3.3.6 Other transient regions</a></strong>.
<p />

<h3 id="subsection.A.17.6">A.17.6 Glossary</h3> <!-- A.11.6 ============================ -->

<div class="wordHead" id="rat:file:BIN">
  <div class="wordNumber">A.11.6.1.0765</div>
  <div class="wordName">BIN</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Some operating systems require that files be opened in a
    different mode to access their contents as an unstructured
    stream of binary data rather than as a sequence of lines.
    <p />
    The arguments to <a href="file/READ-FILE.html">READ-FILE</a> and <a href="file/WRITE-FILE.html">WRITE-FILE</a> are
    arrays of character storage elements, each element consisting
    of at least 8 bits. The committee intends that, in
    <strong>BIN</strong> mode, the contents of these storage elements can be
    written to a file and later read back without alteration.
    
    </div>
  </div>

<div class="wordHead" id="rat:file:CREATE-FILE">
  <div class="wordNumber">A.11.6.1.1010</div>
  <div class="wordName">CREATE-FILE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <a href="file/Sq.html">S&quot;</a> <code>TEST.FTH&quot;</code> <a href="file/RDivW.html">R/W</a>
    <strong>CREATE-FILE</strong>
    <a href="core/ABORTq.html">ABORT&quot;</a> <code>CREATE-FILE FAILED&quot;</code>
    <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:file:INCLUDE-FILE">
  <div class="wordNumber">A.11.6.1.1717</div>
  <div class="wordName">INCLUDE-FILE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Here are two implementation alternatives for saving the input
    source specification in the presence of text file input:
    <p />
    <ol style="list-style-type: decimal">
    <li> Save the file position (as returned by
    <a href="file/FILE-POSITION.html">FILE-POSITION</a>) of the beginning of the line being
    interpreted. To restore the input source specification,
    seek to that position and re-read the line into the input
    buffer.
    <p />
    </li>
    <li> Allocate a separate line buffer for each active text
    input file, using that buffer as the input buffer. This
    method avoids the &quot;seek and reread&quot; step, and allows the
    use of &quot;pseudo-files&quot; such as pipes and other
    sequential-access-only communication channels.
    </li>
</ol>
    
    </div>
  </div>

<div class="wordHead" id="rat:file:INCLUDED">
  <div class="wordNumber">A.11.6.1.1718</div>
  <div class="wordName">INCLUDED</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    ... <a href="file/Sq.html">S&quot;</a> <code>filename&quot;</code> <strong>INCLUDED</strong> ...
    
    </div>
  </div>

<div class="wordHead" id="rat:file:OPEN-FILE">
  <div class="wordNumber">A.11.6.1.1970</div>
  <div class="wordName">OPEN-FILE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
    &nbsp;&nbsp; <a href="core/Colon.html">:</a> <code>X</code> ...
    <a href="file/Sq.html">S&quot;</a> <code> TEST.FTH&quot;</code> <a href="file/RDivW.html">R/W</a>
    <strong>OPEN-FILE</strong>  <a href="core/ABORTq.html">ABORT&quot;</a> <code>OPEN-FILE FAILED&quot;</code>
    ... <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:file:READ-FILE">
  <div class="wordNumber">A.11.6.1.2080</div>
  <div class="wordName">READ-FILE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    A typical sequential file-processing algorithm might look like:
        <div class="quote">
      <div class="tt">

        <div class="tabbing">
          <a href="core/BEGIN.html">BEGIN</a>					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> ) <br />
          &nbsp;&nbsp;&nbsp; ... <a href="file/READ-FILE.html">READ-FILE</a> <a href="exception/THROW.html">THROW</a>
          &nbsp;&nbsp;&nbsp;&nbsp;	 <a href="core/p.html">(</a> length ) <br />
          <a href="core/qDUP.html">?DUP</a> <a href="core/WHILE.html">WHILE</a>		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> length ) <br />
          &nbsp;&nbsp;&nbsp; ...						&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	 <a href="core/p.html">(</a> ) <br />
          <a href="core/REPEAT.html">REPEAT</a>					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> )
          <br />
          
          </div>
        
        </div>
      </div>In this example, <a href="exception/THROW.html">THROW</a> is used to handle
    exception conditions, which are reported as
    non-zero values of the <em>ior</em> return value from
    <strong>READ-FILE</strong>. End-of-file is reported as a zero value of
    the &quot;length&quot; return value.
    
    </div>
  </div>

<div class="wordHead" id="rat:file:READ-LINE">
  <div class="wordNumber">A.11.6.1.2090</div>
  <div class="wordName">READ-LINE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Implementations are allowed to store the line terminator in
    the memory buffer in order to allow the use of line reading
    functions provided by host operating systems, some of which
    store the terminator. Without this provision, a transient
    buffer might be needed. The two-character limitation is
    sufficient for the vast majority of existing operating
    systems. Implementations on host operating systems whose line
    terminator sequence is longer than two characters may have to
    take special action to prevent the storage of more than two
    terminator characters.
    <p />
    Standard Programs may not depend on the presence of any such
    terminator sequence in the buffer.
    <p />
    A typical line-oriented sequential file-processing algorithm
    might look like:
    <p />
        <div class="quote">
      <div class="tt">

        <div class="tabbing">
          <a href="core/BEGIN.html">BEGIN</a>				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> ) <br />
          &nbsp;&nbsp;&nbsp; ... <a href="file/READ-LINE.html">READ-LINE</a> <a href="exception/THROW.html">THROW</a>
          &nbsp;&nbsp;&nbsp;&nbsp;	 <a href="core/p.html">(</a> length not-eof-flag ) <br />
          <a href="core/WHILE.html">WHILE</a> 			&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> length ) <br />
          &nbsp;&nbsp;&nbsp; ...				&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	 <a href="core/p.html">(</a> ) <br />
          <a href="core/REPEAT.html">REPEAT</a> <a href="core/DROP.html">DROP</a>	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> ) <br />
          
          </div>
        
        </div>
      </div><strong>READ-LINE</strong> needs a separate end-of-file flag because
    empty (zero-length) lines are a routine occurrence, so a
    zero-length line cannot be used to signify end-of-file.
    
    </div>
  </div>

<div class="wordHead" id="rat:file:Sq">
  <div class="wordNumber">A.11.6.1.2165</div>
  <div class="wordName">S&quot;</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    ... <strong>S&quot;</strong> <em>ccc</em><code>&quot;</code> ...
    <p />
    The interpretation semantics for <strong>S&quot;</strong> are intended to
    provide a simple mechanism for entering a string in the
    interpretation state. Since an implementation may choose to
    provide only one buffer for interpreted strings, an
    interpreted string is subject to being overwritten by the
    next execution of <strong>S&quot;</strong> in interpretation state. It is
    intended that no standard words other than <strong>S&quot;</strong> should
    in themselves cause the interpreted string to be overwritten.
    However, since words such as <a href="core/EVALUATE.html">EVALUATE</a>,
    <a href="block/LOAD.html">LOAD</a>, <a href="file/INCLUDE-FILE.html">INCLUDE-FILE</a> and
    <a href="file/INCLUDED.html">INCLUDED</a> can result in the interpretation of arbitrary
    text, possibly including instances of <strong>S&quot;</strong>, the
    interpreted string may be invalidated by some uses of these
    words.
    <p />
    When the possibility of overwriting a string can arise, it is
    prudent to copy the string to a &quot;safe&quot; buffer allocated by
    the application.
    
    </div>
  </div>

<div class="wordHead" id="rat:file:INCLUDE">
  <div class="wordNumber">A.11.6.2.1714</div>
  <div class="wordName">INCLUDE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">

      <strong>INCLUDE</strong> <code>filename</code>
      
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:file:REQUIRE">
  <div class="wordNumber">A.11.6.2.2144.10</div>
  <div class="wordName">REQUIRE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">

      <strong>REQUIRE</strong> <code>filename</code>
      
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:file:REQUIRED">
  <div class="wordNumber">A.11.6.2.2144.50</div>
  <div class="wordName">REQUIRED</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
        <div class="quote">

      <a href="file/Sq.html">S&quot;</a> <code>filename&quot;</code> <strong>REQUIRED</strong>
      
      </div>
    
    </div>
  </div>
<p />
<h2 id="section.A.19">A.19 The optional Floating-Point word set</h2> <!-- A.12 =============== -->

<a name="rat:floating"></a>
<p />
The current base for floating-point input must be <a href="core/DECIMAL.html">DECIMAL</a>.
Floating-point input is not allowed in an arbitrary base. All
floating-point numbers to
be interpreted by a standard system must contain the exponent
indicator &quot;<code>E</code>&quot; (see <strong><a href="float.html#float:conv">12.3.7 Text interpreter input number conversion</a></strong>). Consensus in the committee deemed
this form of floating-point input to be in more common use than
the alternative that would have a floating-point input mode that
would allow numbers with embedded decimal points to be treated
as floating-point numbers.
<p />
Although the format and precision of the significand and the format
and range of the exponent of a floating-point number are
implementation defined in Forth-2012, the Floating-Point
Extensions word set contains the words
<a href="floating/DFFetch.html">DF@</a>, <a href="floating/SFFetch.html">SF@</a>, <a href="floating/DFStore.html">DF!</a>, and <a href="floating/SFStore.html">SF!</a>
for fetching and storing double- and single-precision IEEE
floating-point-format numbers to memory. The IEEE floating-point
format is commonly used by numeric math co-processors and for
exchange of floating-point data between programs and systems.
<p />

<h3 id="subsection.A.19.3">A.19.3 Additional usage requirements</h3> <!-- A.12.3 ======= -->

<h4 id="subsubsection.A.19.3.5">A.19.3.5 Address alignment</h4> <!-- A.12.3.5 ============== -->
In defining custom floating-point data structures, be aware that
<a href="core/CREATE.html">CREATE</a> doesn't necessarily leave the data space pointer
aligned for various floating-point data types. Programs may comply
with the requirement for the various kinds of floating-point alignment
by specifying the appropriate alignment both at compile-time and
execution time. For example:
<p />
<div class="quote">
  <div class="tt">
<a href="core/Colon.html">:</a> <a href="floating/FCONSTANT.html">FCONSTANT</a> <a href="core/p.html">(</a> F: r -- ) <br />
    &nbsp;&nbsp; <a href="core/CREATE.html">CREATE</a> <a href="floating/FALIGN.html">FALIGN</a>  <a href="core/HERE.html">HERE</a> 
    1 <a href="floating/FLOATS.html">FLOATS</a> <a href="core/ALLOT.html">ALLOT</a>  <a href="floating/FStore.html">F!</a> <br />
    &nbsp;&nbsp; <a href="core/DOES.html">DOES&gt;</a> <a href="core/p.html">(</a> F: -- r )
     <a href="floating/FALIGNED.html">FALIGNED</a> <a href="floating/FFetch.html">F@</a> <a href="core/Semi.html">;</a>
    
    </div>
  </div>
<p />

<h4 id="subsubsection.A.19.3.7">A.19.3.7 Text interpreter input number conversion</h4> <!-- A.12.3.7 -->
The committee has more than once received the suggestion that the
text interpreter in standard Forth systems should treat numbers
that have an embedded decimal point, but no exponent, as
floating-point numbers rather than double cell numbers. This
suggestion, although it has merit, has always been voted down because
it would break too much existing code; many existing implementations
put the full digit string on the stack as a double number and use
other means to inform the application of the location of the decimal
point.
<p />

<h3 id="subsection.A.19.6">A.19.6 Glossary</h3> <!-- A.12.6 ============================ -->

<div class="wordHead" id="rat:floating:toFLOAT">
  <div class="wordNumber">A.12.6.1.0558</div>
  <div class="wordName">&gt;FLOAT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>&gt;FLOAT</strong> enables programs to read floating-point data in
    legible ASCII format. It accepts a much broader syntax than
    does the text interpreter since the latter defines rules for
    composing source programs whereas <strong>&gt;FLOAT</strong> defines rules
    for accepting data. <strong>&gt;FLOAT</strong> is defined as broadly as is
    feasible to permit input of data from Forth-2012 systems
    as well as other widely used standard programming environments.
    <p />
    This is a synthesis of common FORTRAN practice. Embedded spaces
    are explicitly forbidden in much scientific usage, as are other
    field separators such as comma or slash.
    <p />
    While <strong>&gt;FLOAT</strong> is not required to treat a string of blanks
    as zero, this behavior is strongly encouraged, since a future
    version of this standard may include such a requirement.
    
    </div>
  </div>

<div class="wordHead" id="rat:floating:FCONSTANT">
  <div class="wordNumber">A.12.6.1.1492</div>
  <div class="wordName">FCONSTANT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use: <code>r</code> <strong>FCONSTANT</strong> <em>name</em>
    
    </div>
  </div>

<div class="wordHead" id="rat:floating:FLITERAL">
  <div class="wordNumber">A.12.6.1.1552</div>
  <div class="wordName">FLITERAL</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>X</code> ...
    <a href="core/Bracket.html">[</a> ... <a href="core/p.html">(</a> r ) <a href="right-bracket.html">]</a>
    <strong>FLITERAL</strong> ...
    <a href="core/Semi.html">;</a>
    
    </div>
  </div>

<div class="wordHead" id="rat:floating:FVARIABLE">
  <div class="wordNumber">A.12.6.1.1630</div>
  <div class="wordName">FVARIABLE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <strong>FVARIABLE</strong> <em>name</em>
    
    </div>
  </div>

<div class="wordHead" id="rat:floating:REPRESENT">
  <div class="wordNumber">A.12.6.1.2143</div>
  <div class="wordName">REPRESENT</div>
</div>
<div class="wordBody">
  <div class="rationale">

    This word provides a primitive for floating-point display.
    Some floating-point formats, including those specified by
    IEEE-754, allow representations of numbers outside of an
    implementation-defined range. These include plus and minus
    infinities, denormalized numbers, and others. In these cases
    we expect that <strong>REPRESENT</strong> will usually be implemented
    to return appropriate character strings, such as &quot;+infinity&quot;
    or &quot;nan&quot;, possibly truncated.
    
    </div>
  </div>

<div class="wordHead" id="rat:floating:Fd">
  <div class="wordNumber">A.12.6.2.1427</div>
  <div class="wordName">F.</div>
</div>
<div class="wordBody">
  <div class="rationale">

    For example, <code>1E3</code> <strong>F.</strong> displays <code>1000.</code>
    
    </div>
  </div>

<div class="wordHead" id="rat:floating:FATAN2">
  <div class="wordNumber">A.12.6.2.1489</div>
  <div class="wordName">FATAN2</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <a href="floating/FSINCOS.html">FSINCOS</a> and <strong>FATAN2</strong> are a complementary pair of
    operators which convert angles to 2-vectors and vice-versa.
    They are essential to most geometric and physical applications
    since they correctly and unambiguously handle this conversion
    in all cases except null vectors, even when the tangent of the
    angle would be infinite.
    <p />
    <a href="floating/FSINCOS.html">FSINCOS</a> returns a Cartesian unit vector in the direction
    of the given angle, measured counter-clockwise from the positive
    X-axis. The order of results on the stack, namely <em>y</em> underneath
    <em>x</em>, permits the 2-vector data type to be additionally viewed
    and used as a ratio approximating the tangent of the angle.
    Thus the phrase <a href="floating/FSINCOS.html">FSINCOS</a> <a href="floating/FDiv.html">F/</a> is functionally
    equivalent to <a href="floating/FTAN.html">FTAN</a>, but is useful over only a limited
    and discontinuous range of angles, whereas <a href="floating/FSINCOS.html">FSINCOS</a> and
    <strong>FATAN2</strong> are useful for all angles.
    <p />
    The argument order for <strong>FATAN2</strong> is the same, converting a
    vector in the conventional representation to a scalar angle.
    Thus, for all angles, <a href="floating/FSINCOS.html">FSINCOS</a> <strong>FATAN2</strong> is an identity
    within the accuracy of the arithmetic and the argument range of
    <a href="floating/FSINCOS.html">FSINCOS</a>. Note that while <a href="floating/FSINCOS.html">FSINCOS</a> always returns a
    valid unit vector, <strong>FATAN2</strong> will accept any non-null vector.
    An ambiguous condition exists if the vector argument to
    <strong>FATAN2</strong> has zero magnitude.
    
    </div>
  </div>

<div class="wordHead" id="rat:floating:FEXPM1">
  <div class="wordNumber">A.12.6.2.1516</div>
  <div class="wordName">FEXPM1</div>
</div>
<div class="wordBody">
  <div class="rationale">

    This function allows accurate computation when its arguments
    are close to zero, and provides a useful base for the standard
    exponential functions. Hyperbolic functions such as
    <span class="sf">sinh(<em>x</em>)</span> can be efficiently and accurately
    implemented by using <strong>FEXPM1</strong>; accuracy is lost in this
    function for small values of <em>x</em> if the word <a href="floating/FEXP.html">FEXP</a> is
    used.
    <p />
    An important application of this word is in finance; say a loan
    is repaid at 15% per year; what is the daily rate? On a computer
    with single-precision (six decimal digit) accuracy:
    <p />
    <ol style="list-style-type: decimal">
    <li> Using <a href="floating/FLN.html">FLN</a> and <a href="floating/FEXP.html">FEXP</a>:
    <a href="floating/FLN.html">FLN</a> of 1.15 = 0.139762, <br />
    divide by 365 = 3.82910E-4, <br />
    form the exponent using <a href="floating/FEXP.html">FEXP</a> = 1.00038, and <br />
    subtract one (1) and convert to percentage = 0.038%.
    </li>
</ol>
    Thus we only have two-digit accuracy.
    <ol style="list-style-type: decimal">
    <li> Using <a href="floating/FLNPOne.html">FLNP1</a> and <strong>FEXPM1</strong>:
    <a href="floating/FLNPOne.html">FLNP1</a> of 0.15 = 0.139762, (this is the same value
    as in the first example, although with the argument closer
    to zero it may not be so) <br />
    divide by 365 = 3.82910E-4, <br />
    form the exponent and subtract one (1) using
    <strong>FEXPM1</strong> = 3.82983E-4, and <br />
    convert to percentage = 0.0382983%.
    </li>
</ol>
    This calculation method allows the hyperbolic functions to be
    computed with six-digit accuracy. For example, <span class="sf">sinh</span>
    can be defined as:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> <a href="floating/FSINH.html">FSINH</a>  <a href="core/p.html">(</a> r1 -- r2 ) <br />
        &nbsp;&nbsp; <strong>FEXPM1</strong>  <a href="floating/FDUP.html">FDUP</a> 
        <a href="floating/FDUP.html">FDUP</a> 1.0E0 <a href="floating/FPlus.html">F+</a>  <a href="floating/FDiv.html">F/</a>  <a href="floating/FPlus.html">F+</a> 
        2.0E0 <a href="floating/FDiv.html">F/</a>
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:floating:FLNP1">
  <div class="wordNumber">A.12.6.2.1554</div>
  <div class="wordName">FLNP1</div>
</div>
<div class="wordBody">
  <div class="rationale">

    This function allows accurate compilation when its arguments
    are close to zero, and provides a useful base for the standard
    logarithmic functions. For example, <a href="floating/FLN.html">FLN</a> can be
    implemented as:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> <a href="floating/FLN.html">FLN</a>  
        1.0E0 <a href="floating/FMinus.html">F-</a>   <strong>FLNP1</strong>
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    
    </div>
  </div>
<div class="secdef">

  <div class="secname">See:</div>
  <div class="sec">

 <a href="rationale.html#rat:floating:FEXPM1">A.12.6.2.1516 FEXPM1</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:floating:Ftilde">
  <div class="wordNumber">A.12.6.2.1640</div>
  <div class="wordName">F~</div>
</div>
<div class="wordBody">
  <div class="rationale">

    This provides the three types of &quot;floating point equality&quot;
    in common use &mdash; &quot;close&quot; in absolute terms, exact equality
    as represented, and &quot;relatively close&quot;.
    
    </div>
  </div>
<p />
<h2 id="section.A.21">A.21 The optional Locals word set</h2> <!-- A.13 ======================= -->

<a name="rat:local"></a>
<p />

<h3 id="subsection.A.21.3">A.21.3 Additional usage requirements</h3> <!-- A.13.3 ======= -->
Rule <a href="locals.html#locals:rules">13.3.3.2</a>d could be relaxed without affecting the
integrity of the rest of this structure. <a href="locals.html#locals:rules">13.3.3.2</a>c could
not be.
<p />
<a href="locals.html#locals:rules">13.3.3.2</a>b forbids the use of the data stack for local
storage because no usage rules have been articulated for programmer
users in such a case. Of course, if the data stack is somehow employed
in such a way that there are no usage rules, then the locals are
invisible to the programmer, are logically not on the stack, and the
implementation conforms.
<p />
Access to previously declared local variables is prohibited by Section
<a href="locals.html#locals:rules">13.3.3.2</a>d until any data placed onto the return stack by the
application has been removed, due to the possible use of the return
stack for storage of locals.
<p />
Authorization for a Standard Program to manipulate the return stack
(e.g., via <a href="core/toR.html">&gt;R</a> <a href="core/Rfrom.html">R&gt;</a>) while local variables
are active overly constrains implementation possibilities. The consensus
of users of locals was that Local facilities represent an effective
functional replacement for return stack manipulation, and restriction
of standard usage to only one method was reasonable.
<p />
Access to Locals within <a href="core/DO.html">DO</a>...<a href="core/LOOP.html">LOOP</a>s is
expressly permitted as an additional requirement of conforming systems
by Section <a href="locals.html#locals:rules">13.3.3.2</a>g. Although words, such as <a href="local/LOCAL.html">(LOCAL)</a>,
written by a System Implementor, may require inside knowledge of the
internal structure of the return stack, such knowledge is not required
of a user of compliant Forth systems.
<p />

<h3 id="subsection.A.21.6">A.21.6 Glossary</h3> <!-- A.13.6 ============================ -->

<div class="wordHead" id="rat:local:b:">
  <div class="wordNumber">A.13.6.2.2550</div>
  <div class="wordName">{:</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The Forth 94 Technical Committee was unable to identify any
    common practice for locals.  It provided a way to define locals
    and a method of parsing them in the hope that a common practice
    would emerge.
    <p />
    Since then, common practice has emerged.  Most implementations that
    provide <a href="local/LOCAL.html">(LOCAL)</a> and  <a href="local/LOCALS.html">LOCALS|</a> also provide some form of the
    { ... } notation; however, the phrase { ... } conflicts with
    other systems.  The <strong>{:</strong> ... <code>:}</code> notation is a compromise
    to avoid name conflicts.
    <p />
    The notation provides for different kinds of local: those that are
    initialized from the data stack at run-time, uninitialized locals, and
    outputs.  Initialized locals are separated from uninitialized locals by
    `<code>|</code>'.  The definition of locals is terminated by
    `<code>--</code>' or `<code>:}</code>'.
    <p />
    All text between `<code>--</code>' and `<code>:}</code>' is ignored.  This eases
    documentation by allowing a complete stack comment in the locals definition.
    <p />
    The `<code>|</code>' (ASCII $7C) character is widely used as the
    separator between local arguments and local values.  Some implementations
    have used `<code>\</code>' (ASCII $5C) or `<code>&brvbar;</code>' ($A6).
    Systems are free to continue to provide these alternative separators.
    However, only the recognition of the `<code>|</code>' separator is
    mandatory. Therefore portable programs must use the `<code>|</code>'
    separator.
    <p />
    A number of systems extend the locals notation in various ways.  Some of
    these extensions may emerge as common practice.  This standard has reserved
    the notation used by these extensions to avoid difficulties when porting
    code to these systems.  In particular local names ending in
    `<code>:</code>' (colon),
    `<code>[</code>' (open bracket), or
    `<code>^</code>' (caret) are reserved.
    
    </div>
  </div>
<p />
<h2 id="section.A.23">A.23 The optional Memory-Allocation word set</h2> <!-- A.14 ============ -->

<a name="rat:memory"></a>
<p />
The Memory-Allocation word set provides a means for acquiring memory
other than the contiguous data space that is allocated by <a href="core/ALLOT.html">ALLOT</a>.
In many operating system environments it is inappropriate for a process
to pre-allocate large amounts of contiguous memory (as would be
necessary for the use of <a href="core/ALLOT.html">ALLOT</a>).  The Memory-Allocation word set
can acquire memory from the system at any time, without knowing in
advance the address of the memory that will be acquired.
<p />
<h2 id="section.A.24">A.24 The optional Programming-Tools word set</h2> <!-- A.15 ============ -->

<a name="rat:tools"></a>
<p />
These words have been in widespread common use since the earliest
Forth systems.
<p />
Although there are environmental dependencies intrinsic to programs
using an assembler, virtually all Forth systems provide such a
capability. Insofar as many Forth programs are intended for real-time
applications and are intrinsically non-portable for this reason, the
committee believes that providing a standard window into
assemblers is a useful contribution to Forth programmers.
<p />
Similarly, the programming aids <a href="tools/DUMP.html">DUMP</a>, etc., are valuable tools
even though their specific formats will differ between CPUs and Forth
implementations. These words are primarily intended for use by the
programmer, and are rarely invoked in programs.
<p />
One of the original aims of Forth was to erase the boundary between
&quot;user&quot; and &quot;programmer&quot; &mdash; to give all possible power to anyone
who had occasion to use a computer. Nothing in the above labeling or
remarks should be construed to mean that this goal has been abandoned.
<p />

<h4 id="subsubsection.A.24.3.1">A.24.3.1 Name tokens</h4>
<a name="rat:tools:nt"></a>
<p />
Name tokens are an abstract data type identifying named words.
You can use words such as <a href="tools/NAMEtoSTRING.html">NAME&gt;STRING</a> to get information
out of name tokens.
<p />

<h3 id="subsection.A.24.6">A.24.6 Glossary</h3> <!-- A.15.6 ============================ -->

<div class="wordHead" id="rat:tools:.S">
  <div class="wordNumber">A.15.6.1.0220</div>
  <div class="wordName">.S</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>.S</strong> is a debugging convenience found on almost
    all Forth systems. It is universally mentioned in Forth texts.
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:SEE">
  <div class="wordNumber">A.15.6.1.2194</div>
  <div class="wordName">SEE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>SEE</strong> acts as an on-line form of documentation of
    words, allowing modification of words by decompiling and
    regenerating with appropriate changes.
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:WORDS">
  <div class="wordNumber">A.15.6.1.2465</div>
  <div class="wordName">WORDS</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>WORDS</strong> is a debugging convenience found on almost
    all Forth systems. It is universally referred to in Forth texts.
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:;CODE">
  <div class="wordNumber">A.15.6.2.0470</div>
  <div class="wordName">;CODE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <a href="core/Colon.html">:</a> <code>namex</code>
    ... &lt;<em>create</em>&gt; ...
    <strong>;CODE</strong> ...
    <p />
    where <code>namex</code> is a defining word, and &lt;<em>create</em>&gt; is
    <a href="core/CREATE.html">CREATE</a> or any user defined word that calls
    <a href="core/CREATE.html">CREATE</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:CODE">
  <div class="wordNumber">A.15.6.2.0930</div>
  <div class="wordName">CODE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Some Forth systems implement the assembly function by adding
    an <a href="tools/ASSEMBLER.html">ASSEMBLER</a> word list to the search order,
    using the text interpreter to parse a postfix assembly
    language with lexical characteristics similar to Forth source
    code. Typically, in such systems, assembly ends when a word
    <code>END-CODE</code> is interpreted.
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:CS-PICK">
  <div class="wordNumber">A.15.6.2.1015</div>
  <div class="wordName">CS-PICK</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The intent is to copy a <em>dest</em> on the control-flow
    stack so that it can be resolved more than once. For example:
    
        <div class="quote">
      <div class="tt">
<a href="core/bs.html">\</a> Conditionally transfer control to beginning of <br />
        <a href="core/bs.html">\</a> loop.  This is similar in spirit to C's &quot;continue&quot; <br />
        <a href="core/bs.html">\</a> statement.
        <p />
        <a href="core/Colon.html">:</a> ?REPEAT   <a href="core/p.html">(</a> dest -- dest ) <a href="core/bs.html">\</a> Compilation <br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="core/p.html">(</a> flag -- ) &nbsp;&nbsp; <a href="core/bs.html">\</a> Execution <br />
        &nbsp;&nbsp; 0 <a href="tools/CS-PICK.html">CS-PICK</a>   <a href="core/POSTPONE.html">POSTPONE</a> <a href="core/UNTIL.html">UNTIL</a> <br />
        <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>
        <p />
        <a href="core/Colon.html">:</a> XX <a href="core/p.html">(</a> -- ) <a href="core/bs.html">\</a> Example use of ?REPEAT <br />
        &nbsp;&nbsp; <a href="core/BEGIN.html">BEGIN</a> <br />
        &nbsp;&nbsp;&nbsp;&nbsp; ... <br />
        &nbsp;&nbsp; flag ?REPEAT <a href="core/p.html">(</a> Go back to BEGIN if flag is false ) <br />
        &nbsp;&nbsp;&nbsp;&nbsp; ... <br />
        &nbsp;&nbsp; flag ?REPEAT <a href="core/p.html">(</a> Go back to BEGIN if flag is false ) <br />
        &nbsp;&nbsp;&nbsp;&nbsp; ... <br />
        &nbsp;&nbsp; flag <a href="core/UNTIL.html">UNTIL</a>   <a href="core/p.html">(</a> Go back to BEGIN if flag is false ) <br />
        <a href="core/Semi.html">;</a>
        
        </div>
      </div>
    
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:CS-ROLL">
  <div class="wordNumber">A.15.6.2.1020</div>
  <div class="wordName">CS-ROLL</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The intent is to modify the order in which the <em>orig</em>s
    and <em>dest</em>s on the control-flow stack are to be resolved
    by subsequent control-flow words. For example, <a href="core/WHILE.html">WHILE</a>
    could be implemented in terms of <a href="core/IF.html">IF</a> and
    <strong>CS-ROLL</strong>, as follows:
    <p />
    
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> <a href="core/WHILE.html">WHILE</a>   <a href="core/p.html">(</a> dest -- orig dest ) <br />
        &nbsp;&nbsp; <a href="core/POSTPONE.html">POSTPONE</a> <a href="core/IF.html">IF</a>   1 <a href="tools/CS-ROLL.html">CS-ROLL</a> <br />
        <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>
        
        </div>
      </div>
    
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:FORGET">
  <div class="wordNumber">A.15.6.2.1580</div>
  <div class="wordName">FORGET</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    ... <strong>FORGET</strong> <em>name</em> ...
    <p />
    <strong>FORGET</strong> <em>name</em> tries to infer the previous dictionary
    state from <em>name</em>; this is not always possible.  As a
    consequence, <strong>FORGET</strong> <em>name</em> removes <em>name</em> and
    all following words in the name space.
    <p />
    See <a href="rationale.html#rat:core:MARKER">A.6.2.1850 MARKER</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:NtoR">
  <div class="wordNumber">A.15.6.2.1908</div>
  <div class="wordName">N&gt;R</div>
</div>
<div class="wordBody">
  <div class="rationale">

    An implementation may store the stack items in any manner.  It may
    store them on the return stack, in any order.  A stack-constrained
    system may prefer to use a buffer to store the items and place a
    reference to the buffer on the return stack.
    <p />
    
    </div>
  </div>
<div class="secdef">

  <div class="secname">See:</div>
  <div class="sec">

 <a href="core/SAVE-INPUT.html">6.2.2182 SAVE-INPUT</a>,
    <a href="core/RESTORE-INPUT.html">6.2.2148 RESTORE-INPUT</a>,
    <a href="search/GET-ORDER.html">16.6.1.1647 GET-ORDER</a>, 
    <a href="search/SET-ORDER.html">16.6.1.2197 SET-ORDER</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:NAMEtoCOMPILE">
  <div class="wordNumber">A.15.6.2.1909.10</div>
  <div class="wordName">NAME&gt;COMPILE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    In a traditional <em>xt</em>+immediate-flag system, the
    <em>x xt</em> returned by <strong>NAME&gt;COMPILE</strong> is
    typically <em>xt1 xt2</em>, where <em>xt1</em> is the
    <em>xt</em> of the word under consideration, and
    <em>xt2</em> is the <em>xt</em> of <a href="core/EXECUTE.html">EXECUTE</a>
    (for immediate words) or <a href="core/COMPILEComma.html">COMPILE,</a> (for words
    with default compilation semantics).
    <p />
    If you want to <a href="core/POSTPONE.html">POSTPONE</a> <em>nt</em>, you can
    do so with
    <p />
        <div class="quote">
      <div class="tt">
<strong>NAME&gt;COMPILE</strong> <a href="core/SWAP.html">SWAP</a> <a href="core/POSTPONE.html">POSTPONE</a>
        <a href="core/LITERAL.html">LITERAL</a> <a href="core/COMPILEComma.html">COMPILE,</a>
        
        </div>
      </div>
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:TRAVERSE-WORDLIST">
  <div class="wordNumber">A.15.6.2.2297</div>
  <div class="wordName">TRAVERSE-WORDLIST</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> WORDS-COUNT <a href="core/p.html">(</a> x nt &ndash; x' f )
        <a href="core/DROP.html">DROP</a> <a href="core/OnePlus.html">1+</a> <a href="core/TRUE.html">TRUE</a>
        <a href="core/Semi.html">;</a>
        <br />
        0 <a href="core/Tick.html">'</a> WORDS-COUNT
        <a href="search/FORTH-WORDLIST.html">FORTH-WORDLIST</a>
        <strong>TRAVERSE-WORDLIST</strong> <a href="core/d.html">.</a>
        
        </div>
      </div>
    <p />
    prints a count of the number of words in the <a href="search/FORTH-WORDLIST.html">FORTH-WORDLIST</a>.
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> ALL-WORDS
        <a href="tools/NAMEtoSTRING.html">NAME&gt;STRING</a> <a href="core/CR.html">CR</a> <a href="core/TYPE.html">TYPE</a> <a href="core/TRUE.html">TRUE</a>
        <a href="core/Semi.html">;</a>
        <br />
        <a href="core/Tick.html">'</a> ALL-WORDS
        <a href="search/GET-CURRENT.html">GET-CURRENT</a>
        <strong>TRAVERSE-WORDLIST</strong>
        
        </div>
      </div>
    <p />
    prints the names of words in the current compilation wordlist.
    <p />
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> CONTAINS-STRING <br />
        &nbsp;&nbsp; 			<a href="tools/NAMEtoSTRING.html">NAME&gt;STRING</a> <a href="core/TwoOVER.html">2OVER</a>
        <a href="string/SEARCH.html">SEARCH</a> <a href="core/IF.html">IF</a>
        <a href="core/CR.html">CR</a> <a href="core/TYPE.html">TYPE</a>
        <a href="core/THEN.html">THEN</a> <a href="core/FALSE.html">FALSE</a> <a href="core/Semi.html">;</a> <br />
        <a href="core/Sq.html">S&quot;</a> COM&quot; <a href="core/Tick.html">'</a> CONTAINS-STRING
        <a href="search/GET-CURRENT.html">GET-CURRENT</a> <strong>TRAVERSE-WORDLIST</strong>
        
        </div>
      </div>
    <p />
    prints the name of a word containing the string
    &quot;COM&quot;, if it exists, and then terminates.
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:[ELSE]">
  <div class="wordNumber">A.15.6.2.2531</div>
  <div class="wordName">[ELSE]</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    ... <em>flag</em>
    <a href="tools/BracketIF.html">[IF]</a> ...
    <strong>[ELSE]</strong> ...
    <a href="tools/BracketTHEN.html">[THEN]</a> ...
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:[IF]">
  <div class="wordNumber">A.15.6.2.2532</div>
  <div class="wordName">[IF]</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    ... <em>flag</em>
    <strong>[IF]</strong> ...
    <a href="tools/BracketELSE.html">[ELSE]</a> ...
    <a href="tools/BracketTHEN.html">[THEN]</a> ...
    
    </div>
  </div>

<div class="wordHead" id="rat:tools:[THEN]">
  <div class="wordNumber">A.15.6.2.2533</div>
  <div class="wordName">[THEN]</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Typical use:
    ... <em>flag</em>
    <a href="tools/BracketIF.html">[IF]</a> ...
    <a href="tools/BracketELSE.html">[ELSE]</a> ...
    <strong>[THEN]</strong> ...
    <p />
    Software that runs in several system environments often
    contains some source code that is environmentally dependent.
    Conditional compilation &mdash; the selective inclusion or
    exclusion of portions of the source code at compile time &mdash;
    is one technique that is often used to assist in the
    maintenance of such source code.
    <p />
    Conditional compilation is sometimes done with &quot;smart
    comments&quot; &mdash; definitions that either skip or do not skip
    the remainder of the line based on some test. For example:
    <p />
    
        <div class="quote">
      <div class="tt">
<a href="core/bs.html">\</a> If 16-Bit? contains TRUE, lines preceded by 16BIT\ <br />
        <a href="core/bs.html">\</a> will be skipped. Otherwise, they will not be skipped.
        <p />
        <a href="core/VARIABLE.html">VARIABLE</a> 16-BIT?
        <p />
        <a href="core/Colon.html">:</a> 16BIT\  <a href="core/p.html">(</a> -- )  
        16-BIT? <a href="core/Fetch.html">@</a>  
        <a href="core/IF.html">IF</a>   <a href="core/POSTPONE.html">POSTPONE</a> <a href="core/bs.html">\</a>   <a href="core/THEN.html">THEN</a> <br />
        <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>
        
        </div>
      </div>
    This technique works on a line by line basis, and is good for
    short, isolated variant code sequences.
    <p />
    More complicated conditional compilation problems suggest a
    nestable method that can encompass more than one source line
    at a time. The words included in the optional Programming tools
    extensions word set are useful for this purpose.
    
    </div>
  </div>
<p />
<h2 id="section.A.26">A.26 The optional Search-Order word set</h2> <!-- A.16 ================= -->

<a name="rat:search"></a>
<p />
The search-order word set is intended to be a portable &quot;construction
set&quot; from which search-order words may be built.  <a href="search/ALSO.html">ALSO</a>/<a href="search/ONLY.html">ONLY</a>
or the various &quot;vocabulary&quot; schemes supported by the major Forth
vendors can be defined in terms of the primitive search-order word set.
<p />
The encoding for word list identifiers <em>wid</em> might be a
small-integer index into an array of word-list definition records, the
data-space address of such a record, a user-area offset, the execution
token of a sealed vocabulary, the link-field address of the first definition
in a word list, or anything else. It is entirely up to the system implementor.
<p />

<h3 id="subsection.A.26.2">A.26.2 Additional terms and notation</h3> <!-- A.16.2 ================= -->
<dl class="desc">
<dt>search order</dt><dd>  
Note that the use of the term &quot;list&quot; does not necessarily
imply implementation as a linked list
</dd></dl>
<br class="clear" />

<p />

<h3 id="subsection.A.26.3">A.26.3 Additional usage requirements</h3> <!-- A 16.3 ============ -->

<h4 id="subsubsection.A.26.3.3">A.26.3.3 Finding definition names</h4> <!-- A.16.3.3 ======= -->
In other words, the following is not guaranteed to work:
<p />
<div class="quote">
  <div class="tt">
<a href="core/Colon.html">:</a> FOO ...
    <a href="core/Bracket.html">[</a> ... <a href="search/SET-CURRENT.html">SET-CURRENT</a> <a href="right-bracket.html">]</a>
    ... <a href="core/RECURSE.html">RECURSE</a> ... <br />
    <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>
    
    </div>
  </div>
<a href="core/RECURSE.html">RECURSE</a>, <a href="core/Semi.html">;</a> (semicolon), and <a href="core/IMMEDIATE.html">IMMEDIATE</a> may
or may not need information stored in the compilation word list.
<p />

<h3 id="subsection.A.26.6">A.26.6 Glossary</h3> <!-- A.16.6 ============================ -->

<div class="wordHead" id="rat:search:SEARCH-WORDLIST">
  <div class="wordNumber">A.16.6.1.2192</div>
  <div class="wordName">SEARCH-WORDLIST</div>
</div>
<div class="wordBody">
  <div class="rationale">

    When <strong>SEARCH-WORDLIST</strong> fails to find the word, it does
    not return the string, unlike <a href="search/FIND.html">FIND</a>. This is in
    accordance with the general principle that Forth words consume
    their arguments.
    
    </div>
  </div>
<p />
<h2 id="section.A.28">A.28 The optional String word set</h2> <!-- A.17 ======================= -->

<a name="rat:string"></a>
<p />

<h3 id="subsection.A.28.6">A.28.6 Glossary</h3> <!-- A.17.6 ============================ -->

<div class="wordHead" id="rat:string:/STRING">
  <div class="wordNumber">A.17.6.1.0245</div>
  <div class="wordName">/STRING</div>
</div>
<div class="wordBody">
  <div class="rationale">

    <strong>/STRING</strong> is used to remove or add characters relative
    to the current position in the character string. Positive values
    of <em>n</em> will exclude characters from the string while
    negative values of <em>n</em> will include characters to the
    left of the string.
    <p />
    <a href="core/Sq.html">S&quot;</a> ABC&quot; 2 <strong>/STRING</strong> <a href="core/TwoDUP.html">2DUP</a> <a href="core/TYPE.html">TYPE</a> <a href="core/bs.html">\</a> outputs &quot;C&quot; <br />
    -1 <strong>/STRING</strong> <a href="core/TYPE.html">TYPE</a> <a href="core/bs.html">\</a> outputs &quot;BC&quot;
    
    </div>
  </div>

<div class="wordHead" id="rat:string:CMOVE">
  <div class="wordNumber">A.17.6.1.0910</div>
  <div class="wordName">CMOVE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    If <em>c-addr<sub>2</sub></em> lies within the source region (i.e., when
    <em>c-addr<sub>2</sub></em> is not less than <em>c-addr<sub>1</sub></em> and
    <em>c-addr<sub>2</sub></em> is less than the quantity <em>c-addr<sub>1</sub> u</em>
    <a href="core/CHARS.html">CHARS</a> <a href="core/Plus.html">+</a>), memory propagation occurs.
    <p />
    Assume a character string at address
    100: &quot;ABCD&quot;. Then after
        <div class="quote">
      <div class="tt">
100 <a href="core/DUP.html">DUP</a>   <a href="core/CHARPlus.html">CHAR+</a>   3 <strong>CMOVE</strong>
        
        </div>
      </div>
    the string at address 100 is &quot;AAAA&quot;.
    <p />
    See <a href="rationale.html#rat:core:MOVE">A.6.1.1900 MOVE</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:string:CMOVEtop">
  <div class="wordNumber">A.17.6.1.0920</div>
  <div class="wordName">CMOVE&gt;</div>
</div>
<div class="wordBody">
  <div class="rationale">

    If <em>c-addr<sub>1</sub></em> lies within the destination region (i.e.,
    when <em>c-addr<sub>1</sub></em> is greater than or equal to
    <em>c-addr<sub>2</sub></em> and <em>c-addr<sub>2</sub></em> is less than the
    quantity <em>c-addr<sub>1</sub> u</em> <a href="core/CHARS.html">CHARS</a>
    <a href="core/Plus.html">+</a>), memory propagation	occurs.
    <p />
    Assume a character string at address
    100: &quot;ABCD&quot;. Then after
        <div class="quote">
      <div class="tt">
100 <a href="core/DUP.html">DUP</a> <a href="core/CHARPlus.html">CHAR+</a> <a href="core/SWAP.html">SWAP</a>
        3 <strong>CMOVE&gt;</strong>
        
        </div>
      </div>
    the string at address 100 is &quot;DDDD&quot;.
    <p />
    See <a href="rationale.html#rat:core:MOVE">A.6.1.1900 MOVE</a>.
    
    </div>
  </div>

<div class="wordHead" id="rat:string:SLITERAL">
  <div class="wordNumber">A.17.6.1.2212</div>
  <div class="wordName">SLITERAL</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The current functionality of <a href="core/Sq.html">6.1.2165 S&quot;</a> may be
    provided by the following definition:
    
        <div class="quote">
      <div class="tt">
<a href="core/Colon.html">:</a> <a href="core/Sq.html">S&quot;</a> <a href="core/p.html">(</a> &quot;ccc&lt;quote&gt;&quot; -- ) <br />
        &nbsp;&nbsp; <a href="core/BracketCHAR.html">[CHAR]</a> &quot; <a href="core/PARSE.html">PARSE</a>  
        <a href="core/POSTPONE.html">POSTPONE</a> <a href="string/SLITERAL.html">SLITERAL</a> <br />
        <a href="core/Semi.html">;</a> <a href="core/IMMEDIATE.html">IMMEDIATE</a>
        
        </div>
      </div>
    
    
    </div>
  </div>

<div class="wordHead" id="rat:string:SUBSTITUTE">
  <div class="wordNumber">A.17.6.2.2255</div>
  <div class="wordName">SUBSTITUTE</div>
</div>
<div class="wordBody">
  <div class="rationale">

    Many applications need to be able to perform text substitution, for
    example:
    <p />
    <div class="center">

      Your balance at &lt;<em>time</em>&gt; on &lt;<em>date</em>&gt; is &lt;<em>currencyvalue</em>&gt;.
      
      </div>
    <p />
    Translation of a sentence or message from one language to another may
    result in changes to the displayed parameter order.  The example, the
    Afrikaans translation of this sentence requires a different order:
    <p />
    <div class="center">

      Jou balans op &lt;<em>date</em>&gt; om &lt;<em>time</em>&gt; is &lt;<em>currencyvalue</em>&gt;.
      
      </div>
    <p />
    The words <strong>SUBSTITUTE</strong> and <a href="string/REPLACES.html">REPLACES</a> provide for this
    requirements by defining a text substitution facility.  For example,
    we can provide an initial string in the form:
    <p />
    <div class="center">

      <code>Your balance at %time% on %date% is %currencyvalue%.</code>
      
      </div>
    <p />
    The <code>%</code> is used as delimiters for the substitution name.  The
    text &quot;<code>currencyvalue</code>&quot;, &quot;<code>date</code>&quot; and &quot;<code>time</code>&quot;
    are text substitutions, where the replacement text is defined by
    <a href="string/REPLACES.html">REPLACES</a>:
    <p />
    
    
        <div class="quote">
      <div class="tt">

        <a href="core/Colon.html">:</a> date <a href="core/Sq.html">S&quot;</a> 10/Nov/2014&quot; <a href="core/Semi.html">;</a> <br />
        <a href="core/Colon.html">:</a> time <a href="core/Sq.html">S&quot;</a> 02:52&quot; <a href="core/Semi.html">;</a> <br />
        date \= <a href="core/Sq.html">S&quot;</a> date&quot; <a href="string/REPLACES.html">REPLACES</a> <br />
        time  <a href="core/Sq.html">S&quot;</a> time&quot; <a href="string/REPLACES.html">REPLACES</a>
        <br />
        
        </div>
      </div>
    </div>
  </div>
The substitution name &quot;date&quot; is defined to be replaced with the string
&quot;10/Nov/2014&quot; and &quot;time&quot; to be replaced with &quot;02:52&quot;.  Thus
<strong>SUBSTITUTE</strong> would produce the string:
<p />
<div class="center">

  <code>Your balance at 02:52 on 10/Nov/2014 is %currencyvalue%.</code>
  
  </div>
<p />
As the substitution name &quot;currencyvalue&quot; has not been defined, it is
left unchanged in the resulting string.
<p />
The return value <em>n</em> is nonnegative on success and indicates the
number of substitutions made.  In the above example, this would be two.
A negative value indicates that an error occurred.
As substitution is not recursive, the return value could be used to
provide a recursive substitution.
<p />
Implementation of <strong>SUBSTITUTE</strong> may be considered as being equivalent
to a wordlist which is searched.  If the substitution name is found, the
word is executed, returning a substitution string.
Such words can be deferred or multiple wordlists can be used.
The implementation techniques required are similar to those used by
<a href="core/ENVIRONMENTq.html">ENVIRONMENT?</a>.
There is no provision for changing the delimiter character, although a
system may provide system-specific extensions.
<h2 id="section.A.30">A.30 The optional Extended-Character word set</h2> <!-- A.18 ======================= -->

<a name="rat:xchar"></a>
<p />
Forth defines graphic and control characters from the ASCII character
set.  ASCII was originally designed for the English language.
However, most western languages fit somewhat into the Forth framework,
since a single byte is sufficient to encode all characters in each
language, although different languages may use different encodings;
Latin-1 and Latin-15 are widely used.  For other languages, different
character sets have to be used, several of which are variable-width.
Currently, the most popular representative of the variable-width
character sets is UTF-8.
<p />
Many Forth systems today are case insensitive, to accept lower case
standard words.  It is sufficient to be case insensitive for the ASCII
subset to make this work &mdash; this saves a large code mapping table for
comparison of other symbols.  Case is mostly an issue of European
languages (Latin, Greek, and Cyrillic), but similar issues exist
between traditional and simplified Chinese (finally being dealt with
by Unihan), and between different Latin code pages in the Universal
Character Set (UCS), e.g., full width vs. normal half width Latin
letters.
<p />
Furthermore, UCS allows composition of glyphs and has direct encoding for
composed glyphs, which look the same, but have different encodings.  This
is not a problem for a Forth system to solve.
<p />
Some encodings (not UTF-8) might give surprises when you use a case
insensitive ASCII-compare that's 8-bit safe, but not aware of the
current encoding.
<p />
The xchar word set does not address problems that come from using
multiple different encodings and switching or converting between them.
It is good practice for a system implementing xchar to support UTF&ndash;8.
<p />

<h3 id="subsection.A.30.6">A.30.6 Glossary</h3> <!-- A.18.6 ============================ -->

<div class="wordHead" id="rat:xchar:CHAR">
  <div class="wordNumber">A.18.6.2.0895</div>
  <div class="wordName">CHAR</div>
</div>
<div class="wordBody">
  <div class="rationale">

    The behavior of the extended version of <strong>CHAR</strong> is fully backward
    compatible with <a href="core/CHAR.html">6.1.0895 CHAR</a>.
    
    </div>
  </div>
<p />

</div>
<div id="menu-bar" role="menubar">
  <ul>
    <li role="menu" aria-haspopup="true" class="first">
      <span id="menu-label-doc" class="with-menu">Forth 2012</span>
      <div class="menu">
        <ul id="menu-doc" style="width: 100px;">
        <li role="menuitem"><a href="index.html" class="current">Forth 2012</a></li>
        </ul>
      </div>
    </li>
    <li role="menu" aria-haspopup="true">
      <span id="menu-label-chap" class="with-menu">Rationale</span>
      <div class="menu">
        <ul id="menu-chap" class="scroll-bar" style="width: 265px;">
        <li role="menuitem"><a href="foreword.html">Foreword</a></li>
        <li role="menuitem"><a href="process.html">Proposals Process</a></li>
        <li role="menuitem"><a href="members-2x.html">200<em>x</em> Membership</a></li>
        <li role="menuitem"><a href="intro.html">Introduction</a></li>
        <li role="menuitem"><a href="notation.html">Terms, notation, and references</a></li>
        <li role="menuitem"><a href="usage.html">Usage requirements</a></li>
        <li role="menuitem"><a href="doc.html">Documentation requirements</a></li>
        <li role="menuitem"><a href="label.html">Compliance and labeling</a></li>
        <li role="menuitem"><a href="core.html">Glossary</a></li>
        <li role="menuitem"><a href="block.html">Block word set</a></li>
        <li role="menuitem"><a href="double.html">Double-Number word set</a></li>
        <li role="menuitem"><a href="exception.html">Exception word set</a></li>
        <li role="menuitem"><a href="facility.html">Facility word set</a></li>
        <li role="menuitem"><a href="file.html">File-Access word set</a></li>
        <li role="menuitem"><a href="float.html">Floating-Point word set</a></li>
        <li role="menuitem"><a href="locals.html">Locals word set</a></li>
        <li role="menuitem"><a href="memory.html">Memory-Allocation word set</a></li>
        <li role="menuitem"><a href="tools.html">Programming-Tools word set</a></li>
        <li role="menuitem"><a href="search.html">Search-Order word set</a></li>
        <li role="menuitem"><a href="string.html">String word set</a></li>
        <li role="menuitem"><a href="xchar.html">Extended-Character word set</a></li>
        <li role="menuitem"><a href="rationale.html" class="current">Rationale</a></li>
        <li role="menuitem"><a href="bib.html">Bibliography</a></li>
        <li role="menuitem"><a href="diff.html">Compatibility analysis</a></li>
        <li role="menuitem"><a href="port.html">Portability guide</a></li>
        <li role="menuitem"><a href="implement.html">Reference Implementations</a></li>
        <li role="menuitem"><a href="testsuite.html">Test Suite</a></li>
        <li role="menuitem"><a href="alpha.html">Alphabetic list of words</a></li>
        </ul>
      </div>
    </li>
    <li role="menu" aria-haspopup="true">
      <span id="menu-label-sec" class="with-menu">Introduction</span>
      <div class="menu">
        <ul id="menu-sec" class="scroll-bar" style="width: 255px;">
        <li role="menuitem"><a href="#section.A.1">Introduction</a></li>
        <li role="menuitem"><a href="#section.A.2">Terms and notation</a></li>
        <li role="menuitem"><a href="#section.A.3">Usage requirements</a></li>
        <li role="menuitem"><a href="#section.A.4">Documentation requirements</a></li>
        <li role="menuitem"><a href="#section.A.5">Compliance and labeling</a></li>
        <li role="menuitem"><a href="#section.A.6">Glossary</a></li>
        <li role="menuitem"><a href="#section.A.7">Block word set</a></li>
        <li role="menuitem"><a href="#section.A.8">Double-Number word set</a></li>
        <li role="menuitem"><a href="#section.A.9">Block word set</a></li>
        <li role="menuitem"><a href="#section.A.10">Facility word set</a></li>
        <li role="menuitem"><a href="#section.A.11">Double-Number word set</a></li>
        <li role="menuitem"><a href="#section.A.12">Floating-Point word set</a></li>
        <li role="menuitem"><a href="#section.A.13">Exception word set</a></li>
        <li role="menuitem"><a href="#section.A.14">Memory-Allocation word set</a></li>
        <li role="menuitem"><a href="#section.A.15">Facility word set</a></li>
        <li role="menuitem"><a href="#section.A.16">Search-Order word set</a></li>
        <li role="menuitem"><a href="#section.A.17">File-Access word set</a></li>
        <li role="menuitem"><a href="#section.A.18">Extended-Character word set</a></li>
        <li role="menuitem"><a href="#section.A.19">Floating-Point word set</a></li>
        <li role="menuitem"><a href="#section.A.21">Locals word set</a></li>
        <li role="menuitem"><a href="#section.A.23">Memory-Allocation word set</a></li>
        <li role="menuitem"><a href="#section.A.24">Programming-Tools word set</a></li>
        <li role="menuitem"><a href="#section.A.26">Search-Order word set</a></li>
        <li role="menuitem"><a href="#section.A.28">String word set</a></li>
        <li role="menuitem"><a href="#section.A.30">Extended-Character word set</a></li>
        </ul>
      </div>
    </li>

  </ul>
</div>
</body>
</html>

